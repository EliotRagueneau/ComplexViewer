!function(t,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?exports.complexviewer=n():t.complexviewer=n()}(window,(function(){return function(t){var n={};function e(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,e),i.l=!0,i.exports}return e.m=t,e.c=n,e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:r})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,n){if(1&n&&(t=e(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(e.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var i in t)e.d(r,i,function(n){return t[n]}.bind(null,i));return r},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},e.p="",e(e.s=10)}([function(t,n,e){var r,i;!function(){var o={version:"3.5.17"},a=[].slice,s=function(t){return a.call(t)},u=this.document;function c(t){return t&&(t.ownerDocument||t.document||t).documentElement}function l(t){return t&&(t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView)}if(u)try{s(u.documentElement.childNodes)[0].nodeType}catch(t){s=function(t){for(var n=t.length,e=new Array(n);n--;)e[n]=t[n];return e}}if(Date.now||(Date.now=function(){return+new Date}),u)try{u.createElement("DIV").style.setProperty("opacity",0,"")}catch(t){var f=this.Element.prototype,h=f.setAttribute,p=f.setAttributeNS,y=this.CSSStyleDeclaration.prototype,d=y.setProperty;f.setAttribute=function(t,n){h.call(this,t,n+"")},f.setAttributeNS=function(t,n,e){p.call(this,t,n,e+"")},y.setProperty=function(t,n,e){d.call(this,t,n+"",e)}}function v(t,n){return t<n?-1:t>n?1:t>=n?0:NaN}function g(t){return null===t?NaN:+t}function x(t){return!isNaN(t)}function m(t){return{left:function(n,e,r,i){for(arguments.length<3&&(r=0),arguments.length<4&&(i=n.length);r<i;){var o=r+i>>>1;t(n[o],e)<0?r=o+1:i=o}return r},right:function(n,e,r,i){for(arguments.length<3&&(r=0),arguments.length<4&&(i=n.length);r<i;){var o=r+i>>>1;t(n[o],e)>0?i=o:r=o+1}return r}}}o.ascending=v,o.descending=function(t,n){return n<t?-1:n>t?1:n>=t?0:NaN},o.min=function(t,n){var e,r,i=-1,o=t.length;if(1===arguments.length){for(;++i<o;)if(null!=(r=t[i])&&r>=r){e=r;break}for(;++i<o;)null!=(r=t[i])&&e>r&&(e=r)}else{for(;++i<o;)if(null!=(r=n.call(t,t[i],i))&&r>=r){e=r;break}for(;++i<o;)null!=(r=n.call(t,t[i],i))&&e>r&&(e=r)}return e},o.max=function(t,n){var e,r,i=-1,o=t.length;if(1===arguments.length){for(;++i<o;)if(null!=(r=t[i])&&r>=r){e=r;break}for(;++i<o;)null!=(r=t[i])&&r>e&&(e=r)}else{for(;++i<o;)if(null!=(r=n.call(t,t[i],i))&&r>=r){e=r;break}for(;++i<o;)null!=(r=n.call(t,t[i],i))&&r>e&&(e=r)}return e},o.extent=function(t,n){var e,r,i,o=-1,a=t.length;if(1===arguments.length){for(;++o<a;)if(null!=(r=t[o])&&r>=r){e=i=r;break}for(;++o<a;)null!=(r=t[o])&&(e>r&&(e=r),i<r&&(i=r))}else{for(;++o<a;)if(null!=(r=n.call(t,t[o],o))&&r>=r){e=i=r;break}for(;++o<a;)null!=(r=n.call(t,t[o],o))&&(e>r&&(e=r),i<r&&(i=r))}return[e,i]},o.sum=function(t,n){var e,r=0,i=t.length,o=-1;if(1===arguments.length)for(;++o<i;)x(e=+t[o])&&(r+=e);else for(;++o<i;)x(e=+n.call(t,t[o],o))&&(r+=e);return r},o.mean=function(t,n){var e,r=0,i=t.length,o=-1,a=i;if(1===arguments.length)for(;++o<i;)x(e=g(t[o]))?r+=e:--a;else for(;++o<i;)x(e=g(n.call(t,t[o],o)))?r+=e:--a;if(a)return r/a},o.quantile=function(t,n){var e=(t.length-1)*n+1,r=Math.floor(e),i=+t[r-1],o=e-r;return o?i+o*(t[r]-i):i},o.median=function(t,n){var e,r=[],i=t.length,a=-1;if(1===arguments.length)for(;++a<i;)x(e=g(t[a]))&&r.push(e);else for(;++a<i;)x(e=g(n.call(t,t[a],a)))&&r.push(e);if(r.length)return o.quantile(r.sort(v),.5)},o.variance=function(t,n){var e,r,i=t.length,o=0,a=0,s=-1,u=0;if(1===arguments.length)for(;++s<i;)x(e=g(t[s]))&&(a+=(r=e-o)*(e-(o+=r/++u)));else for(;++s<i;)x(e=g(n.call(t,t[s],s)))&&(a+=(r=e-o)*(e-(o+=r/++u)));if(u>1)return a/(u-1)},o.deviation=function(){var t=o.variance.apply(this,arguments);return t?Math.sqrt(t):t};var b=m(v);function w(t){return t.length}o.bisectLeft=b.left,o.bisect=o.bisectRight=b.right,o.bisector=function(t){return m(1===t.length?function(n,e){return v(t(n),e)}:t)},o.shuffle=function(t,n,e){(o=arguments.length)<3&&(e=t.length,o<2&&(n=0));for(var r,i,o=e-n;o;)i=Math.random()*o--|0,r=t[o+n],t[o+n]=t[i+n],t[i+n]=r;return t},o.permute=function(t,n){for(var e=n.length,r=new Array(e);e--;)r[e]=t[n[e]];return r},o.pairs=function(t){for(var n=0,e=t.length-1,r=t[0],i=new Array(e<0?0:e);n<e;)i[n]=[r,r=t[++n]];return i},o.transpose=function(t){if(!(i=t.length))return[];for(var n=-1,e=o.min(t,w),r=new Array(e);++n<e;)for(var i,a=-1,s=r[n]=new Array(i);++a<i;)s[a]=t[a][n];return r},o.zip=function(){return o.transpose(arguments)},o.keys=function(t){var n=[];for(var e in t)n.push(e);return n},o.values=function(t){var n=[];for(var e in t)n.push(t[e]);return n},o.entries=function(t){var n=[];for(var e in t)n.push({key:e,value:t[e]});return n},o.merge=function(t){for(var n,e,r,i=t.length,o=-1,a=0;++o<i;)a+=t[o].length;for(e=new Array(a);--i>=0;)for(n=(r=t[i]).length;--n>=0;)e[--a]=r[n];return e};var k=Math.abs;function _(t){for(var n=1;t*n%1;)n*=10;return n}function S(t,n){for(var e in n)Object.defineProperty(t.prototype,e,{value:n[e],enumerable:!1})}function M(){this._=Object.create(null)}o.range=function(t,n,e){if(arguments.length<3&&(e=1,arguments.length<2&&(n=t,t=0)),(n-t)/e==1/0)throw new Error("infinite range");var r,i=[],o=_(k(e)),a=-1;if(t*=o,n*=o,(e*=o)<0)for(;(r=t+e*++a)>n;)i.push(r/o);else for(;(r=t+e*++a)<n;)i.push(r/o);return i},o.map=function(t,n){var e=new M;if(t instanceof M)t.forEach((function(t,n){e.set(t,n)}));else if(Array.isArray(t)){var r,i=-1,o=t.length;if(1===arguments.length)for(;++i<o;)e.set(i,t[i]);else for(;++i<o;)e.set(n.call(t,r=t[i],i),r)}else for(var a in t)e.set(a,t[a]);return e};function E(t){return"__proto__"==(t+="")||"\0"===t[0]?"\0"+t:t}function A(t){return"\0"===(t+="")[0]?t.slice(1):t}function L(t){return E(t)in this._}function P(t){return(t=E(t))in this._&&delete this._[t]}function N(){var t=[];for(var n in this._)t.push(A(n));return t}function C(){var t=0;for(var n in this._)++t;return t}function O(){for(var t in this._)return!1;return!0}function T(){this._=Object.create(null)}function I(t){return t}function D(t,n,e){return function(){var r=e.apply(n,arguments);return r===n?t:r}}function z(t,n){if(n in t)return n;n=n.charAt(0).toUpperCase()+n.slice(1);for(var e=0,r=R.length;e<r;++e){var i=R[e]+n;if(i in t)return i}}S(M,{has:L,get:function(t){return this._[E(t)]},set:function(t,n){return this._[E(t)]=n},remove:P,keys:N,values:function(){var t=[];for(var n in this._)t.push(this._[n]);return t},entries:function(){var t=[];for(var n in this._)t.push({key:A(n),value:this._[n]});return t},size:C,empty:O,forEach:function(t){for(var n in this._)t.call(this,A(n),this._[n])}}),o.nest=function(){var t,n,e={},r=[],i=[];function a(i,o,s){if(s>=r.length)return n?n.call(e,o):t?o.sort(t):o;for(var u,c,l,f,h=-1,p=o.length,y=r[s++],d=new M;++h<p;)(f=d.get(u=y(c=o[h])))?f.push(c):d.set(u,[c]);return i?(c=i(),l=function(t,n){c.set(t,a(i,n,s))}):(c={},l=function(t,n){c[t]=a(i,n,s)}),d.forEach(l),c}return e.map=function(t,n){return a(n,t,0)},e.entries=function(t){return function t(n,e){if(e>=r.length)return n;var o=[],a=i[e++];return n.forEach((function(n,r){o.push({key:n,values:t(r,e)})})),a?o.sort((function(t,n){return a(t.key,n.key)})):o}(a(o.map,t,0),0)},e.key=function(t){return r.push(t),e},e.sortKeys=function(t){return i[r.length-1]=t,e},e.sortValues=function(n){return t=n,e},e.rollup=function(t){return n=t,e},e},o.set=function(t){var n=new T;if(t)for(var e=0,r=t.length;e<r;++e)n.add(t[e]);return n},S(T,{has:L,add:function(t){return this._[E(t+="")]=!0,t},remove:P,values:N,size:C,empty:O,forEach:function(t){for(var n in this._)t.call(this,A(n))}}),o.behavior={},o.rebind=function(t,n){for(var e,r=1,i=arguments.length;++r<i;)t[e=arguments[r]]=D(t,n,n[e]);return t};var R=["webkit","ms","moz","Moz","o","O"];function j(){}function q(){}function G(t){var n=[],e=new M;function r(){for(var e,r=n,i=-1,o=r.length;++i<o;)(e=r[i].on)&&e.apply(this,arguments);return t}return r.on=function(r,i){var o,a=e.get(r);return arguments.length<2?a&&a.on:(a&&(a.on=null,n=n.slice(0,o=n.indexOf(a)).concat(n.slice(o+1)),e.remove(r)),i&&n.push(e.set(r,{on:i})),t)},r}function B(){o.event.preventDefault()}function V(){for(var t,n=o.event;t=n.sourceEvent;)n=t;return n}function F(t){for(var n=new q,e=0,r=arguments.length;++e<r;)n[arguments[e]]=G(n);return n.of=function(e,r){return function(i){try{var a=i.sourceEvent=o.event;i.target=t,o.event=i,n[i.type].apply(e,r)}finally{o.event=a}}},n}o.dispatch=function(){for(var t=new q,n=-1,e=arguments.length;++n<e;)t[arguments[n]]=G(t);return t},q.prototype.on=function(t,n){var e=t.indexOf("."),r="";if(e>=0&&(r=t.slice(e+1),t=t.slice(0,e)),t)return arguments.length<2?this[t].on(r):this[t].on(r,n);if(2===arguments.length){if(null==n)for(t in this)this.hasOwnProperty(t)&&this[t].on(r,null);return this}},o.event=null,o.requote=function(t){return t.replace(U,"\\$&")};var U=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g,H={}.__proto__?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)t[e]=n[e]};function X(t){return H(t,K),t}var Y=function(t,n){return n.querySelector(t)},Z=function(t,n){return n.querySelectorAll(t)},W=function(t,n){var e=t.matches||t[z(t,"matchesSelector")];return(W=function(t,n){return e.call(t,n)})(t,n)};"function"==typeof Sizzle&&(Y=function(t,n){return Sizzle(t,n)[0]||null},Z=Sizzle,W=Sizzle.matchesSelector),o.selection=function(){return o.select(u.documentElement)};var K=o.selection.prototype=[];function $(t){return"function"==typeof t?t:function(){return Y(t,this)}}function J(t){return"function"==typeof t?t:function(){return Z(t,this)}}K.select=function(t){var n,e,r,i,o=[];t=$(t);for(var a=-1,s=this.length;++a<s;){o.push(n=[]),n.parentNode=(r=this[a]).parentNode;for(var u=-1,c=r.length;++u<c;)(i=r[u])?(n.push(e=t.call(i,i.__data__,u,a)),e&&"__data__"in i&&(e.__data__=i.__data__)):n.push(null)}return X(o)},K.selectAll=function(t){var n,e,r=[];t=J(t);for(var i=-1,o=this.length;++i<o;)for(var a=this[i],u=-1,c=a.length;++u<c;)(e=a[u])&&(r.push(n=s(t.call(e,e.__data__,u,i))),n.parentNode=e);return X(r)};var Q="http://www.w3.org/1999/xhtml",tt={svg:"http://www.w3.org/2000/svg",xhtml:Q,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function nt(t,n){return t=o.ns.qualify(t),null==n?t.local?function(){this.removeAttributeNS(t.space,t.local)}:function(){this.removeAttribute(t)}:"function"==typeof n?t.local?function(){var e=n.apply(this,arguments);null==e?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,e)}:function(){var e=n.apply(this,arguments);null==e?this.removeAttribute(t):this.setAttribute(t,e)}:t.local?function(){this.setAttributeNS(t.space,t.local,n)}:function(){this.setAttribute(t,n)}}function et(t){return t.trim().replace(/\s+/g," ")}function rt(t){return new RegExp("(?:^|\\s+)"+o.requote(t)+"(?:\\s+|$)","g")}function it(t){return(t+"").trim().split(/^|\s+/)}function ot(t,n){var e=(t=it(t).map(at)).length;return"function"==typeof n?function(){for(var r=-1,i=n.apply(this,arguments);++r<e;)t[r](this,i)}:function(){for(var r=-1;++r<e;)t[r](this,n)}}function at(t){var n=rt(t);return function(e,r){if(i=e.classList)return r?i.add(t):i.remove(t);var i=e.getAttribute("class")||"";r?(n.lastIndex=0,n.test(i)||e.setAttribute("class",et(i+" "+t))):e.setAttribute("class",et(i.replace(n," ")))}}function st(t,n,e){return null==n?function(){this.style.removeProperty(t)}:"function"==typeof n?function(){var r=n.apply(this,arguments);null==r?this.style.removeProperty(t):this.style.setProperty(t,r,e)}:function(){this.style.setProperty(t,n,e)}}function ut(t,n){return null==n?function(){delete this[t]}:"function"==typeof n?function(){var e=n.apply(this,arguments);null==e?delete this[t]:this[t]=e}:function(){this[t]=n}}function ct(t){return"function"==typeof t?t:(t=o.ns.qualify(t)).local?function(){return this.ownerDocument.createElementNS(t.space,t.local)}:function(){var n=this.ownerDocument,e=this.namespaceURI;return e===Q&&n.documentElement.namespaceURI===Q?n.createElement(t):n.createElementNS(e,t)}}function lt(){var t=this.parentNode;t&&t.removeChild(this)}function ft(t){return{__data__:t}}function ht(t){return function(){return W(this,t)}}function pt(t){return arguments.length||(t=v),function(n,e){return n&&e?t(n.__data__,e.__data__):!n-!e}}function yt(t,n){for(var e=0,r=t.length;e<r;e++)for(var i,o=t[e],a=0,s=o.length;a<s;a++)(i=o[a])&&n(i,a,e);return t}function dt(t){return H(t,vt),t}o.ns={prefix:tt,qualify:function(t){var n=t.indexOf(":"),e=t;return n>=0&&"xmlns"!==(e=t.slice(0,n))&&(t=t.slice(n+1)),tt.hasOwnProperty(e)?{space:tt[e],local:t}:t}},K.attr=function(t,n){if(arguments.length<2){if("string"==typeof t){var e=this.node();return(t=o.ns.qualify(t)).local?e.getAttributeNS(t.space,t.local):e.getAttribute(t)}for(n in t)this.each(nt(n,t[n]));return this}return this.each(nt(t,n))},K.classed=function(t,n){if(arguments.length<2){if("string"==typeof t){var e=this.node(),r=(t=it(t)).length,i=-1;if(n=e.classList){for(;++i<r;)if(!n.contains(t[i]))return!1}else for(n=e.getAttribute("class");++i<r;)if(!rt(t[i]).test(n))return!1;return!0}for(n in t)this.each(ot(n,t[n]));return this}return this.each(ot(t,n))},K.style=function(t,n,e){var r=arguments.length;if(r<3){if("string"!=typeof t){for(e in r<2&&(n=""),t)this.each(st(e,t[e],n));return this}if(r<2){var i=this.node();return l(i).getComputedStyle(i,null).getPropertyValue(t)}e=""}return this.each(st(t,n,e))},K.property=function(t,n){if(arguments.length<2){if("string"==typeof t)return this.node()[t];for(n in t)this.each(ut(n,t[n]));return this}return this.each(ut(t,n))},K.text=function(t){return arguments.length?this.each("function"==typeof t?function(){var n=t.apply(this,arguments);this.textContent=null==n?"":n}:null==t?function(){this.textContent=""}:function(){this.textContent=t}):this.node().textContent},K.html=function(t){return arguments.length?this.each("function"==typeof t?function(){var n=t.apply(this,arguments);this.innerHTML=null==n?"":n}:null==t?function(){this.innerHTML=""}:function(){this.innerHTML=t}):this.node().innerHTML},K.append=function(t){return t=ct(t),this.select((function(){return this.appendChild(t.apply(this,arguments))}))},K.insert=function(t,n){return t=ct(t),n=$(n),this.select((function(){return this.insertBefore(t.apply(this,arguments),n.apply(this,arguments)||null)}))},K.remove=function(){return this.each(lt)},K.data=function(t,n){var e,r,i=-1,o=this.length;if(!arguments.length){for(t=new Array(o=(e=this[0]).length);++i<o;)(r=e[i])&&(t[i]=r.__data__);return t}function a(t,e){var r,i,o,a=t.length,l=e.length,f=Math.min(a,l),h=new Array(l),p=new Array(l),y=new Array(a);if(n){var d,v=new M,g=new Array(a);for(r=-1;++r<a;)(i=t[r])&&(v.has(d=n.call(i,i.__data__,r))?y[r]=i:v.set(d,i),g[r]=d);for(r=-1;++r<l;)(i=v.get(d=n.call(e,o=e[r],r)))?!0!==i&&(h[r]=i,i.__data__=o):p[r]=ft(o),v.set(d,!0);for(r=-1;++r<a;)r in g&&!0!==v.get(g[r])&&(y[r]=t[r])}else{for(r=-1;++r<f;)i=t[r],o=e[r],i?(i.__data__=o,h[r]=i):p[r]=ft(o);for(;r<l;++r)p[r]=ft(e[r]);for(;r<a;++r)y[r]=t[r]}p.update=h,p.parentNode=h.parentNode=y.parentNode=t.parentNode,s.push(p),u.push(h),c.push(y)}var s=dt([]),u=X([]),c=X([]);if("function"==typeof t)for(;++i<o;)a(e=this[i],t.call(e,e.parentNode.__data__,i));else for(;++i<o;)a(e=this[i],t);return u.enter=function(){return s},u.exit=function(){return c},u},K.datum=function(t){return arguments.length?this.property("__data__",t):this.property("__data__")},K.filter=function(t){var n,e,r,i=[];"function"!=typeof t&&(t=ht(t));for(var o=0,a=this.length;o<a;o++){i.push(n=[]),n.parentNode=(e=this[o]).parentNode;for(var s=0,u=e.length;s<u;s++)(r=e[s])&&t.call(r,r.__data__,s,o)&&n.push(r)}return X(i)},K.order=function(){for(var t=-1,n=this.length;++t<n;)for(var e,r=this[t],i=r.length-1,o=r[i];--i>=0;)(e=r[i])&&(o&&o!==e.nextSibling&&o.parentNode.insertBefore(e,o),o=e);return this},K.sort=function(t){t=pt.apply(this,arguments);for(var n=-1,e=this.length;++n<e;)this[n].sort(t);return this.order()},K.each=function(t){return yt(this,(function(n,e,r){t.call(n,n.__data__,e,r)}))},K.call=function(t){var n=s(arguments);return t.apply(n[0]=this,n),this},K.empty=function(){return!this.node()},K.node=function(){for(var t=0,n=this.length;t<n;t++)for(var e=this[t],r=0,i=e.length;r<i;r++){var o=e[r];if(o)return o}return null},K.size=function(){var t=0;return yt(this,(function(){++t})),t};var vt=[];function gt(t){var n,e;return function(r,i,o){var a,s=t[o].update,u=s.length;for(o!=e&&(e=o,n=0),i>=n&&(n=i+1);!(a=s[n])&&++n<u;);return a}}function xt(t,n,e){var r="__on"+t,i=t.indexOf("."),a=bt;i>0&&(t=t.slice(0,i));var u=mt.get(t);function c(){var n=this[r];n&&(this.removeEventListener(t,n,n.$),delete this[r])}return u&&(t=u,a=wt),i?n?function(){var i=a(n,s(arguments));c.call(this),this.addEventListener(t,this[r]=i,i.$=e),i._=n}:c:n?j:function(){var n,e=new RegExp("^__on([^.]+)"+o.requote(t)+"$");for(var r in this)if(n=r.match(e)){var i=this[r];this.removeEventListener(n[1],i,i.$),delete this[r]}}}o.selection.enter=dt,o.selection.enter.prototype=vt,vt.append=K.append,vt.empty=K.empty,vt.node=K.node,vt.call=K.call,vt.size=K.size,vt.select=function(t){for(var n,e,r,i,o,a=[],s=-1,u=this.length;++s<u;){r=(i=this[s]).update,a.push(n=[]),n.parentNode=i.parentNode;for(var c=-1,l=i.length;++c<l;)(o=i[c])?(n.push(r[c]=e=t.call(i.parentNode,o.__data__,c,s)),e.__data__=o.__data__):n.push(null)}return X(a)},vt.insert=function(t,n){return arguments.length<2&&(n=gt(this)),K.insert.call(this,t,n)},o.select=function(t){var n;return"string"==typeof t?(n=[Y(t,u)]).parentNode=u.documentElement:(n=[t]).parentNode=c(t),X([n])},o.selectAll=function(t){var n;return"string"==typeof t?(n=s(Z(t,u))).parentNode=u.documentElement:(n=s(t)).parentNode=null,X([n])},K.on=function(t,n,e){var r=arguments.length;if(r<3){if("string"!=typeof t){for(e in r<2&&(n=!1),t)this.each(xt(e,t[e],n));return this}if(r<2)return(r=this.node()["__on"+t])&&r._;e=!1}return this.each(xt(t,n,e))};var mt=o.map({mouseenter:"mouseover",mouseleave:"mouseout"});function bt(t,n){return function(e){var r=o.event;o.event=e,n[0]=this.__data__;try{t.apply(this,n)}finally{o.event=r}}}function wt(t,n){var e=bt(t,n);return function(t){var n=t.relatedTarget;n&&(n===this||8&n.compareDocumentPosition(this))||e.call(this,t)}}u&&mt.forEach((function(t){"on"+t in u&&mt.remove(t)}));var kt,_t=0;function St(t){var n=".dragsuppress-"+ ++_t,e="click"+n,r=o.select(l(t)).on("touchmove"+n,B).on("dragstart"+n,B).on("selectstart"+n,B);if(null==kt&&(kt=!("onselectstart"in t)&&z(t.style,"userSelect")),kt){var i=c(t).style,a=i[kt];i[kt]="none"}return function(t){if(r.on(n,null),kt&&(i[kt]=a),t){var o=function(){r.on(e,null)};r.on(e,(function(){B(),o()}),!0),setTimeout(o,0)}}}o.mouse=function(t){return Et(t,V())};var Mt=this.navigator&&/WebKit/.test(this.navigator.userAgent)?-1:0;function Et(t,n){n.changedTouches&&(n=n.changedTouches[0]);var e=t.ownerSVGElement||t;if(e.createSVGPoint){var r=e.createSVGPoint();if(Mt<0){var i=l(t);if(i.scrollX||i.scrollY){var a=(e=o.select("body").append("svg").style({position:"absolute",top:0,left:0,margin:0,padding:0,border:"none"},"important"))[0][0].getScreenCTM();Mt=!(a.f||a.e),e.remove()}}return Mt?(r.x=n.pageX,r.y=n.pageY):(r.x=n.clientX,r.y=n.clientY),[(r=r.matrixTransform(t.getScreenCTM().inverse())).x,r.y]}var s=t.getBoundingClientRect();return[n.clientX-s.left-t.clientLeft,n.clientY-s.top-t.clientTop]}function At(){return o.event.changedTouches[0].identifier}o.touch=function(t,n,e){if(arguments.length<3&&(e=n,n=V().changedTouches),n)for(var r,i=0,o=n.length;i<o;++i)if((r=n[i]).identifier===e)return Et(t,r)},o.behavior.drag=function(){var t=F(i,"drag","dragstart","dragend"),n=null,e=a(j,o.mouse,l,"mousemove","mouseup"),r=a(At,o.touch,I,"touchmove","touchend");function i(){this.on("mousedown.drag",e).on("touchstart.drag",r)}function a(e,r,i,a,s){return function(){var u,c=this,l=o.event.target.correspondingElement||o.event.target,f=c.parentNode,h=t.of(c,arguments),p=0,y=e(),d=".drag"+(null==y?"":"-"+y),v=o.select(i(l)).on(a+d,m).on(s+d,b),g=St(l),x=r(f,y);function m(){var t,n,e=r(f,y);e&&(t=e[0]-x[0],n=e[1]-x[1],p|=t|n,x=e,h({type:"drag",x:e[0]+u[0],y:e[1]+u[1],dx:t,dy:n}))}function b(){r(f,y)&&(v.on(a+d,null).on(s+d,null),g(p),h({type:"dragend"}))}u=n?[(u=n.apply(c,arguments)).x-x[0],u.y-x[1]]:[0,0],h({type:"dragstart"})}}return i.origin=function(t){return arguments.length?(n=t,i):n},o.rebind(i,t,"on")},o.touches=function(t,n){return arguments.length<2&&(n=V().touches),n?s(n).map((function(n){var e=Et(t,n);return e.identifier=n.identifier,e})):[]};var Lt=1e-6,Pt=1e-12,Nt=Math.PI,Ct=2*Nt,Ot=Ct-Lt,Tt=Nt/2,It=Nt/180,Dt=180/Nt;function zt(t){return t>0?1:t<0?-1:0}function Rt(t,n,e){return(n[0]-t[0])*(e[1]-t[1])-(n[1]-t[1])*(e[0]-t[0])}function jt(t){return t>1?0:t<-1?Nt:Math.acos(t)}function qt(t){return t>1?Tt:t<-1?-Tt:Math.asin(t)}function Gt(t){return((t=Math.exp(t))+1/t)/2}function Bt(t){return(t=Math.sin(t/2))*t}var Vt=Math.SQRT2;o.interpolateZoom=function(t,n){var e,r,i=t[0],o=t[1],a=t[2],s=n[0],u=n[1],c=n[2],l=s-i,f=u-o,h=l*l+f*f;if(h<Pt)r=Math.log(c/a)/Vt,e=function(t){return[i+t*l,o+t*f,a*Math.exp(Vt*t*r)]};else{var p=Math.sqrt(h),y=(c*c-a*a+4*h)/(2*a*2*p),d=(c*c-a*a-4*h)/(2*c*2*p),v=Math.log(Math.sqrt(y*y+1)-y),g=Math.log(Math.sqrt(d*d+1)-d);r=(g-v)/Vt,e=function(t){var n,e=t*r,s=Gt(v),u=a/(2*p)*(s*(n=Vt*e+v,((n=Math.exp(2*n))-1)/(n+1))-function(t){return((t=Math.exp(t))-1/t)/2}(v));return[i+u*l,o+u*f,a*s/Gt(Vt*e+v)]}}return e.duration=1e3*r,e},o.behavior.zoom=function(){var t,n,e,r,i,a,s,c,f,h={x:0,y:0,k:1},p=[960,500],y=Ht,d=250,v=0,g="mousedown.zoom",x="mousemove.zoom",m="mouseup.zoom",b="touchstart.zoom",w=F(k,"zoomstart","zoom","zoomend");function k(t){t.on(g,C).on(Ut+".zoom",T).on("dblclick.zoom",I).on(b,O)}function _(t){return[(t[0]-h.x)/h.k,(t[1]-h.y)/h.k]}function S(t){h.k=Math.max(y[0],Math.min(y[1],t))}function M(t,n){n=function(t){return[t[0]*h.k+h.x,t[1]*h.k+h.y]}(n),h.x+=t[0]-n[0],h.y+=t[1]-n[1]}function E(t,e,r,i){t.__chart__={x:h.x,y:h.y,k:h.k},S(Math.pow(2,i)),M(n=e,r),t=o.select(t),d>0&&(t=t.transition().duration(d)),t.call(k.event)}function A(){s&&s.domain(a.range().map((function(t){return(t-h.x)/h.k})).map(a.invert)),f&&f.domain(c.range().map((function(t){return(t-h.y)/h.k})).map(c.invert))}function L(t){v++||t({type:"zoomstart"})}function P(t){A(),t({type:"zoom",scale:h.k,translate:[h.x,h.y]})}function N(t){--v||(t({type:"zoomend"}),n=null)}function C(){var t=this,n=w.of(t,arguments),e=0,r=o.select(l(t)).on(x,s).on(m,u),i=_(o.mouse(t)),a=St(t);function s(){e=1,M(o.mouse(t),i),P(n)}function u(){r.on(x,null).on(m,null),a(e),N(n)}ws.call(t),L(n)}function O(){var t,n=this,e=w.of(n,arguments),r={},a=0,s=".zoom-"+o.event.changedTouches[0].identifier,u="touchmove"+s,c="touchend"+s,l=[],f=o.select(n),p=St(n);function y(){var e=o.touches(n);return t=h.k,e.forEach((function(t){t.identifier in r&&(r[t.identifier]=_(t))})),e}function d(){var t=o.event.target;o.select(t).on(u,v).on(c,x),l.push(t);for(var e=o.event.changedTouches,s=0,f=e.length;s<f;++s)r[e[s].identifier]=null;var p=y(),d=Date.now();if(1===p.length){if(d-i<500){var g=p[0];E(n,g,r[g.identifier],Math.floor(Math.log(h.k)/Math.LN2)+1),B()}i=d}else if(p.length>1){g=p[0];var m=p[1],b=g[0]-m[0],w=g[1]-m[1];a=b*b+w*w}}function v(){var s,u,c,l,f=o.touches(n);ws.call(n);for(var h=0,p=f.length;h<p;++h,l=null)if(c=f[h],l=r[c.identifier]){if(u)break;s=c,u=l}if(l){var y=(y=c[0]-s[0])*y+(y=c[1]-s[1])*y,d=a&&Math.sqrt(y/a);s=[(s[0]+c[0])/2,(s[1]+c[1])/2],u=[(u[0]+l[0])/2,(u[1]+l[1])/2],S(d*t)}i=null,M(s,u),P(e)}function x(){if(o.event.touches.length){for(var t=o.event.changedTouches,n=0,i=t.length;n<i;++n)delete r[t[n].identifier];for(var a in r)return void y()}o.selectAll(l).on(s,null),f.on(g,C).on(b,O),p(),N(e)}d(),L(e),f.on(g,null).on(b,d)}function T(){var i=w.of(this,arguments);r?clearTimeout(r):(ws.call(this),t=_(n=e||o.mouse(this)),L(i)),r=setTimeout((function(){r=null,N(i)}),50),B(),S(Math.pow(2,.002*Ft())*h.k),M(n,t),P(i)}function I(){var t=o.mouse(this),n=Math.log(h.k)/Math.LN2;E(this,t,_(t),o.event.shiftKey?Math.ceil(n)-1:Math.floor(n)+1)}return Ut||(Ut="onwheel"in u?(Ft=function(){return-o.event.deltaY*(o.event.deltaMode?120:1)},"wheel"):"onmousewheel"in u?(Ft=function(){return o.event.wheelDelta},"mousewheel"):(Ft=function(){return-o.event.detail},"MozMousePixelScroll")),k.event=function(t){t.each((function(){var t=w.of(this,arguments),e=h;Ss?o.select(this).transition().each("start.zoom",(function(){h=this.__chart__||{x:0,y:0,k:1},L(t)})).tween("zoom:zoom",(function(){var r=p[0],i=p[1],a=n?n[0]:r/2,s=n?n[1]:i/2,u=o.interpolateZoom([(a-h.x)/h.k,(s-h.y)/h.k,r/h.k],[(a-e.x)/e.k,(s-e.y)/e.k,r/e.k]);return function(n){var e=u(n),i=r/e[2];this.__chart__=h={x:a-e[0]*i,y:s-e[1]*i,k:i},P(t)}})).each("interrupt.zoom",(function(){N(t)})).each("end.zoom",(function(){N(t)})):(this.__chart__=h,L(t),P(t),N(t))}))},k.translate=function(t){return arguments.length?(h={x:+t[0],y:+t[1],k:h.k},A(),k):[h.x,h.y]},k.scale=function(t){return arguments.length?(h={x:h.x,y:h.y,k:null},S(+t),A(),k):h.k},k.scaleExtent=function(t){return arguments.length?(y=null==t?Ht:[+t[0],+t[1]],k):y},k.center=function(t){return arguments.length?(e=t&&[+t[0],+t[1]],k):e},k.size=function(t){return arguments.length?(p=t&&[+t[0],+t[1]],k):p},k.duration=function(t){return arguments.length?(d=+t,k):d},k.x=function(t){return arguments.length?(s=t,a=t.copy(),h={x:0,y:0,k:1},k):s},k.y=function(t){return arguments.length?(f=t,c=t.copy(),h={x:0,y:0,k:1},k):f},o.rebind(k,w,"on")};var Ft,Ut,Ht=[0,1/0];function Xt(){}function Yt(t,n,e){return this instanceof Yt?(this.h=+t,this.s=+n,void(this.l=+e)):arguments.length<2?t instanceof Yt?new Yt(t.h,t.s,t.l):pn(""+t,yn,Yt):new Yt(t,n,e)}o.color=Xt,Xt.prototype.toString=function(){return this.rgb()+""},o.hsl=Yt;var Zt=Yt.prototype=new Xt;function Wt(t,n,e){var r,i;function o(t){return Math.round(255*function(t){return t>360?t-=360:t<0&&(t+=360),t<60?r+(i-r)*t/60:t<180?i:t<240?r+(i-r)*(240-t)/60:r}(t))}return t=isNaN(t)?0:(t%=360)<0?t+360:t,n=isNaN(n)||n<0?0:n>1?1:n,r=2*(e=e<0?0:e>1?1:e)-(i=e<=.5?e*(1+n):e+n-e*n),new un(o(t+120),o(t),o(t-120))}function Kt(t,n,e){return this instanceof Kt?(this.h=+t,this.c=+n,void(this.l=+e)):arguments.length<2?t instanceof Kt?new Kt(t.h,t.c,t.l):rn(t instanceof Qt?t.l:(t=dn((t=o.rgb(t)).r,t.g,t.b)).l,t.a,t.b):new Kt(t,n,e)}Zt.brighter=function(t){return t=Math.pow(.7,arguments.length?t:1),new Yt(this.h,this.s,this.l/t)},Zt.darker=function(t){return t=Math.pow(.7,arguments.length?t:1),new Yt(this.h,this.s,t*this.l)},Zt.rgb=function(){return Wt(this.h,this.s,this.l)},o.hcl=Kt;var $t=Kt.prototype=new Xt;function Jt(t,n,e){return isNaN(t)&&(t=0),isNaN(n)&&(n=0),new Qt(e,Math.cos(t*=It)*n,Math.sin(t)*n)}function Qt(t,n,e){return this instanceof Qt?(this.l=+t,this.a=+n,void(this.b=+e)):arguments.length<2?t instanceof Qt?new Qt(t.l,t.a,t.b):t instanceof Kt?Jt(t.h,t.c,t.l):dn((t=un(t)).r,t.g,t.b):new Qt(t,n,e)}$t.brighter=function(t){return new Kt(this.h,this.c,Math.min(100,this.l+tn*(arguments.length?t:1)))},$t.darker=function(t){return new Kt(this.h,this.c,Math.max(0,this.l-tn*(arguments.length?t:1)))},$t.rgb=function(){return Jt(this.h,this.c,this.l).rgb()},o.lab=Qt;var tn=18,nn=Qt.prototype=new Xt;function en(t,n,e){var r=(t+16)/116,i=r+n/500,o=r-e/200;return new un(sn(3.2404542*(i=.95047*on(i))-1.5371385*(r=1*on(r))-.4985314*(o=1.08883*on(o))),sn(-.969266*i+1.8760108*r+.041556*o),sn(.0556434*i-.2040259*r+1.0572252*o))}function rn(t,n,e){return t>0?new Kt(Math.atan2(e,n)*Dt,Math.sqrt(n*n+e*e),t):new Kt(NaN,NaN,t)}function on(t){return t>.206893034?t*t*t:(t-4/29)/7.787037}function an(t){return t>.008856?Math.pow(t,1/3):7.787037*t+4/29}function sn(t){return Math.round(255*(t<=.00304?12.92*t:1.055*Math.pow(t,1/2.4)-.055))}function un(t,n,e){return this instanceof un?(this.r=~~t,this.g=~~n,void(this.b=~~e)):arguments.length<2?t instanceof un?new un(t.r,t.g,t.b):pn(""+t,un,Wt):new un(t,n,e)}function cn(t){return new un(t>>16,t>>8&255,255&t)}function ln(t){return cn(t)+""}nn.brighter=function(t){return new Qt(Math.min(100,this.l+tn*(arguments.length?t:1)),this.a,this.b)},nn.darker=function(t){return new Qt(Math.max(0,this.l-tn*(arguments.length?t:1)),this.a,this.b)},nn.rgb=function(){return en(this.l,this.a,this.b)},o.rgb=un;var fn=un.prototype=new Xt;function hn(t){return t<16?"0"+Math.max(0,t).toString(16):Math.min(255,t).toString(16)}function pn(t,n,e){var r,i,o,a=0,s=0,u=0;if(r=/([a-z]+)\((.*)\)/.exec(t=t.toLowerCase()))switch(i=r[2].split(","),r[1]){case"hsl":return e(parseFloat(i[0]),parseFloat(i[1])/100,parseFloat(i[2])/100);case"rgb":return n(gn(i[0]),gn(i[1]),gn(i[2]))}return(o=xn.get(t))?n(o.r,o.g,o.b):(null==t||"#"!==t.charAt(0)||isNaN(o=parseInt(t.slice(1),16))||(4===t.length?(a=(3840&o)>>4,a|=a>>4,s=240&o,s|=s>>4,u=15&o,u|=u<<4):7===t.length&&(a=(16711680&o)>>16,s=(65280&o)>>8,u=255&o)),n(a,s,u))}function yn(t,n,e){var r,i,o=Math.min(t/=255,n/=255,e/=255),a=Math.max(t,n,e),s=a-o,u=(a+o)/2;return s?(i=u<.5?s/(a+o):s/(2-a-o),r=t==a?(n-e)/s+(n<e?6:0):n==a?(e-t)/s+2:(t-n)/s+4,r*=60):(r=NaN,i=u>0&&u<1?0:r),new Yt(r,i,u)}function dn(t,n,e){var r=an((.4124564*(t=vn(t))+.3575761*(n=vn(n))+.1804375*(e=vn(e)))/.95047),i=an((.2126729*t+.7151522*n+.072175*e)/1);return Qt(116*i-16,500*(r-i),200*(i-an((.0193339*t+.119192*n+.9503041*e)/1.08883)))}function vn(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function gn(t){var n=parseFloat(t);return"%"===t.charAt(t.length-1)?Math.round(2.55*n):n}fn.brighter=function(t){t=Math.pow(.7,arguments.length?t:1);var n=this.r,e=this.g,r=this.b,i=30;return n||e||r?(n&&n<i&&(n=i),e&&e<i&&(e=i),r&&r<i&&(r=i),new un(Math.min(255,n/t),Math.min(255,e/t),Math.min(255,r/t))):new un(i,i,i)},fn.darker=function(t){return new un((t=Math.pow(.7,arguments.length?t:1))*this.r,t*this.g,t*this.b)},fn.hsl=function(){return yn(this.r,this.g,this.b)},fn.toString=function(){return"#"+hn(this.r)+hn(this.g)+hn(this.b)};var xn=o.map({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074});function mn(t){return"function"==typeof t?t:function(){return t}}function bn(t){return function(n,e,r){return 2===arguments.length&&"function"==typeof e&&(r=e,e=null),wn(n,e,t,r)}}function wn(t,n,e,r){var i={},a=o.dispatch("beforesend","progress","load","error"),u={},c=new XMLHttpRequest,l=null;function f(){var t,n=c.status;if(!n&&function(t){var n=t.responseType;return n&&"text"!==n?t.response:t.responseText}(c)||n>=200&&n<300||304===n){try{t=e.call(i,c)}catch(t){return void a.error.call(i,t)}a.load.call(i,t)}else a.error.call(i,c)}return this.XDomainRequest&&!("withCredentials"in c)&&/^(http(s)?:)?\/\//.test(t)&&(c=new XDomainRequest),"onload"in c?c.onload=c.onerror=f:c.onreadystatechange=function(){c.readyState>3&&f()},c.onprogress=function(t){var n=o.event;o.event=t;try{a.progress.call(i,c)}finally{o.event=n}},i.header=function(t,n){return t=(t+"").toLowerCase(),arguments.length<2?u[t]:(null==n?delete u[t]:u[t]=n+"",i)},i.mimeType=function(t){return arguments.length?(n=null==t?null:t+"",i):n},i.responseType=function(t){return arguments.length?(l=t,i):l},i.response=function(t){return e=t,i},["get","post"].forEach((function(t){i[t]=function(){return i.send.apply(i,[t].concat(s(arguments)))}})),i.send=function(e,r,o){if(2===arguments.length&&"function"==typeof r&&(o=r,r=null),c.open(e,t,!0),null==n||"accept"in u||(u.accept=n+",*/*"),c.setRequestHeader)for(var s in u)c.setRequestHeader(s,u[s]);return null!=n&&c.overrideMimeType&&c.overrideMimeType(n),null!=l&&(c.responseType=l),null!=o&&i.on("error",o).on("load",(function(t){o(null,t)})),a.beforesend.call(i,c),c.send(null==r?null:r),i},i.abort=function(){return c.abort(),i},o.rebind(i,a,"on"),null==r?i:i.get(function(t){return 1===t.length?function(n,e){t(null==n?e:null)}:t}(r))}xn.forEach((function(t,n){xn.set(t,cn(n))})),o.functor=mn,o.xhr=bn(I),o.dsv=function(t,n){var e=new RegExp('["'+t+"\n]"),r=t.charCodeAt(0);function i(t,e,r){arguments.length<3&&(r=e,e=null);var i=wn(t,n,null==e?o:a(e),r);return i.row=function(t){return arguments.length?i.response(null==(e=t)?o:a(t)):e},i}function o(t){return i.parse(t.responseText)}function a(t){return function(n){return i.parse(n.responseText,t)}}function s(n){return n.map(u).join(t)}function u(t){return e.test(t)?'"'+t.replace(/\"/g,'""')+'"':t}return i.parse=function(t,n){var e;return i.parseRows(t,(function(t,r){if(e)return e(t,r-1);var i=new Function("d","return {"+t.map((function(t,n){return JSON.stringify(t)+": d["+n+"]"})).join(",")+"}");e=n?function(t,e){return n(i(t),e)}:i}))},i.parseRows=function(t,n){var e,i,o={},a={},s=[],u=t.length,c=0,l=0;function f(){if(c>=u)return a;if(i)return i=!1,o;var n=c;if(34===t.charCodeAt(n)){for(var e=n;e++<u;)if(34===t.charCodeAt(e)){if(34!==t.charCodeAt(e+1))break;++e}return c=e+2,13===(s=t.charCodeAt(e+1))?(i=!0,10===t.charCodeAt(e+2)&&++c):10===s&&(i=!0),t.slice(n+1,e).replace(/""/g,'"')}for(;c<u;){var s,l=1;if(10===(s=t.charCodeAt(c++)))i=!0;else if(13===s)i=!0,10===t.charCodeAt(c)&&(++c,++l);else if(s!==r)continue;return t.slice(n,c-l)}return t.slice(n)}for(;(e=f())!==a;){for(var h=[];e!==o&&e!==a;)h.push(e),e=f();n&&null==(h=n(h,l++))||s.push(h)}return s},i.format=function(n){if(Array.isArray(n[0]))return i.formatRows(n);var e=new T,r=[];return n.forEach((function(t){for(var n in t)e.has(n)||r.push(e.add(n))})),[r.map(u).join(t)].concat(n.map((function(n){return r.map((function(t){return u(n[t])})).join(t)}))).join("\n")},i.formatRows=function(t){return t.map(s).join("\n")},i},o.csv=o.dsv(",","text/csv"),o.tsv=o.dsv("\t","text/tab-separated-values");var kn,_n,Sn,Mn,En=this[z(this,"requestAnimationFrame")]||function(t){setTimeout(t,17)};function An(t,n,e){var r=arguments.length;r<2&&(n=0),r<3&&(e=Date.now());var i=e+n,o={c:t,t:i,n:null};return _n?_n.n=o:kn=o,_n=o,Sn||(Mn=clearTimeout(Mn),Sn=1,En(Ln)),o}function Ln(){var t=Pn(),n=Nn()-t;n>24?(isFinite(n)&&(clearTimeout(Mn),Mn=setTimeout(Ln,n)),Sn=0):(Sn=1,En(Ln))}function Pn(){for(var t=Date.now(),n=kn;n;)t>=n.t&&n.c(t-n.t)&&(n.c=null),n=n.n;return t}function Nn(){for(var t,n=kn,e=1/0;n;)n.c?(n.t<e&&(e=n.t),n=(t=n).n):n=t?t.n=n.n:kn=n.n;return _n=t,e}function Cn(t,n){return n-(t?Math.ceil(Math.log(t)/Math.LN10):1)}o.timer=function(){An.apply(this,arguments)},o.timer.flush=function(){Pn(),Nn()},o.round=function(t,n){return n?Math.round(t*(n=Math.pow(10,n)))/n:Math.round(t)};var On=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"].map((function(t,n){var e=Math.pow(10,3*k(8-n));return{scale:n>8?function(t){return t/e}:function(t){return t*e},symbol:t}}));function Tn(t){var n=t.decimal,e=t.thousands,r=t.grouping,i=t.currency,a=r&&e?function(t,n){for(var i=t.length,o=[],a=0,s=r[0],u=0;i>0&&s>0&&(u+s+1>n&&(s=Math.max(1,n-u)),o.push(t.substring(i-=s,i+s)),!((u+=s+1)>n));)s=r[a=(a+1)%r.length];return o.reverse().join(e)}:I;return function(t){var e=In.exec(t),r=e[1]||" ",s=e[2]||">",u=e[3]||"-",c=e[4]||"",l=e[5],f=+e[6],h=e[7],p=e[8],y=e[9],d=1,v="",g="",x=!1,m=!0;switch(p&&(p=+p.substring(1)),(l||"0"===r&&"="===s)&&(l=r="0",s="="),y){case"n":h=!0,y="g";break;case"%":d=100,g="%",y="f";break;case"p":d=100,g="%",y="r";break;case"b":case"o":case"x":case"X":"#"===c&&(v="0"+y.toLowerCase());case"c":m=!1;case"d":x=!0,p=0;break;case"s":d=-1,y="r"}"$"===c&&(v=i[0],g=i[1]),"r"!=y||p||(y="g"),null!=p&&("g"==y?p=Math.max(1,Math.min(21,p)):"e"!=y&&"f"!=y||(p=Math.max(0,Math.min(20,p)))),y=Dn.get(y)||zn;var b=l&&h;return function(t){var e=g;if(x&&t%1)return"";var i=t<0||0===t&&1/t<0?(t=-t,"-"):"-"===u?"":u;if(d<0){var c=o.formatPrefix(t,p);t=c.scale(t),e=c.symbol+g}else t*=d;var w,k,_=(t=y(t,p)).lastIndexOf(".");if(_<0){var S=m?t.lastIndexOf("e"):-1;S<0?(w=t,k=""):(w=t.substring(0,S),k=t.substring(S))}else w=t.substring(0,_),k=n+t.substring(_+1);!l&&h&&(w=a(w,1/0));var M=v.length+w.length+k.length+(b?0:i.length),E=M<f?new Array(M=f-M+1).join(r):"";return b&&(w=a(E+w,E.length?f-k.length:1/0)),i+=v,t=w+k,("<"===s?i+t+E:">"===s?E+i+t:"^"===s?E.substring(0,M>>=1)+i+t+E.substring(M):i+(b?t:E+t))+e}}}o.formatPrefix=function(t,n){var e=0;return(t=+t)&&(t<0&&(t*=-1),n&&(t=o.round(t,Cn(t,n))),e=1+Math.floor(1e-12+Math.log(t)/Math.LN10),e=Math.max(-24,Math.min(24,3*Math.floor((e-1)/3)))),On[8+e/3]};var In=/(?:([^{])?([<>=^]))?([+\- ])?([$#])?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i,Dn=o.map({b:function(t){return t.toString(2)},c:function(t){return String.fromCharCode(t)},o:function(t){return t.toString(8)},x:function(t){return t.toString(16)},X:function(t){return t.toString(16).toUpperCase()},g:function(t,n){return t.toPrecision(n)},e:function(t,n){return t.toExponential(n)},f:function(t,n){return t.toFixed(n)},r:function(t,n){return(t=o.round(t,Cn(t,n))).toFixed(Math.max(0,Math.min(20,Cn(t*(1+1e-15),n))))}});function zn(t){return t+""}var Rn=o.time={},jn=Date;function qn(){this._=new Date(arguments.length>1?Date.UTC.apply(this,arguments):arguments[0])}qn.prototype={getDate:function(){return this._.getUTCDate()},getDay:function(){return this._.getUTCDay()},getFullYear:function(){return this._.getUTCFullYear()},getHours:function(){return this._.getUTCHours()},getMilliseconds:function(){return this._.getUTCMilliseconds()},getMinutes:function(){return this._.getUTCMinutes()},getMonth:function(){return this._.getUTCMonth()},getSeconds:function(){return this._.getUTCSeconds()},getTime:function(){return this._.getTime()},getTimezoneOffset:function(){return 0},valueOf:function(){return this._.valueOf()},setDate:function(){Gn.setUTCDate.apply(this._,arguments)},setDay:function(){Gn.setUTCDay.apply(this._,arguments)},setFullYear:function(){Gn.setUTCFullYear.apply(this._,arguments)},setHours:function(){Gn.setUTCHours.apply(this._,arguments)},setMilliseconds:function(){Gn.setUTCMilliseconds.apply(this._,arguments)},setMinutes:function(){Gn.setUTCMinutes.apply(this._,arguments)},setMonth:function(){Gn.setUTCMonth.apply(this._,arguments)},setSeconds:function(){Gn.setUTCSeconds.apply(this._,arguments)},setTime:function(){Gn.setTime.apply(this._,arguments)}};var Gn=Date.prototype;function Bn(t,n,e){function r(n){var e=t(n),r=o(e,1);return n-e<r-n?e:r}function i(e){return n(e=t(new jn(e-1)),1),e}function o(t,e){return n(t=new jn(+t),e),t}function a(t,r,o){var a=i(t),s=[];if(o>1)for(;a<r;)e(a)%o||s.push(new Date(+a)),n(a,1);else for(;a<r;)s.push(new Date(+a)),n(a,1);return s}t.floor=t,t.round=r,t.ceil=i,t.offset=o,t.range=a;var s=t.utc=Vn(t);return s.floor=s,s.round=Vn(r),s.ceil=Vn(i),s.offset=Vn(o),s.range=function(t,n,e){try{jn=qn;var r=new qn;return r._=t,a(r,n,e)}finally{jn=Date}},t}function Vn(t){return function(n,e){try{jn=qn;var r=new qn;return r._=n,t(r,e)._}finally{jn=Date}}}function Fn(t){var n=t.dateTime,e=t.date,r=t.time,i=t.periods,a=t.days,s=t.shortDays,u=t.months,c=t.shortMonths;function l(t){var n=t.length;function e(e){for(var r,i,o,a=[],s=-1,u=0;++s<n;)37===t.charCodeAt(s)&&(a.push(t.slice(u,s)),null!=(i=Un[r=t.charAt(++s)])&&(r=t.charAt(++s)),(o=w[r])&&(r=o(e,null==i?"e"===r?" ":"0":i)),a.push(r),u=s+1);return a.push(t.slice(u,s)),a.join("")}return e.parse=function(n){var e={y:1900,m:0,d:1,H:0,M:0,S:0,L:0,Z:null};if(f(e,t,n,0)!=n.length)return null;"p"in e&&(e.H=e.H%12+12*e.p);var r=null!=e.Z&&jn!==qn,i=new(r?qn:jn);return"j"in e?i.setFullYear(e.y,0,e.j):"W"in e||"U"in e?("w"in e||(e.w="W"in e?1:0),i.setFullYear(e.y,0,1),i.setFullYear(e.y,0,"W"in e?(e.w+6)%7+7*e.W-(i.getDay()+5)%7:e.w+7*e.U-(i.getDay()+6)%7)):i.setFullYear(e.y,e.m,e.d),i.setHours(e.H+(e.Z/100|0),e.M+e.Z%100,e.S,e.L),r?i._:i},e.toString=function(){return t},e}function f(t,n,e,r){for(var i,o,a,s=0,u=n.length,c=e.length;s<u;){if(r>=c)return-1;if(37===(i=n.charCodeAt(s++))){if(a=n.charAt(s++),!(o=k[a in Un?n.charAt(s++):a])||(r=o(t,e,r))<0)return-1}else if(i!=e.charCodeAt(r++))return-1}return r}l.utc=function(t){var n=l(t);function e(t){try{var e=new(jn=qn);return e._=t,n(e)}finally{jn=Date}}return e.parse=function(t){try{jn=qn;var e=n.parse(t);return e&&e._}finally{jn=Date}},e.toString=n.toString,e},l.multi=l.utc.multi=fe;var h=o.map(),p=Zn(a),y=Wn(a),d=Zn(s),v=Wn(s),g=Zn(u),x=Wn(u),m=Zn(c),b=Wn(c);i.forEach((function(t,n){h.set(t.toLowerCase(),n)}));var w={a:function(t){return s[t.getDay()]},A:function(t){return a[t.getDay()]},b:function(t){return c[t.getMonth()]},B:function(t){return u[t.getMonth()]},c:l(n),d:function(t,n){return Yn(t.getDate(),n,2)},e:function(t,n){return Yn(t.getDate(),n,2)},H:function(t,n){return Yn(t.getHours(),n,2)},I:function(t,n){return Yn(t.getHours()%12||12,n,2)},j:function(t,n){return Yn(1+Rn.dayOfYear(t),n,3)},L:function(t,n){return Yn(t.getMilliseconds(),n,3)},m:function(t,n){return Yn(t.getMonth()+1,n,2)},M:function(t,n){return Yn(t.getMinutes(),n,2)},p:function(t){return i[+(t.getHours()>=12)]},S:function(t,n){return Yn(t.getSeconds(),n,2)},U:function(t,n){return Yn(Rn.sundayOfYear(t),n,2)},w:function(t){return t.getDay()},W:function(t,n){return Yn(Rn.mondayOfYear(t),n,2)},x:l(e),X:l(r),y:function(t,n){return Yn(t.getFullYear()%100,n,2)},Y:function(t,n){return Yn(t.getFullYear()%1e4,n,4)},Z:ce,"%":function(){return"%"}},k={a:function(t,n,e){d.lastIndex=0;var r=d.exec(n.slice(e));return r?(t.w=v.get(r[0].toLowerCase()),e+r[0].length):-1},A:function(t,n,e){p.lastIndex=0;var r=p.exec(n.slice(e));return r?(t.w=y.get(r[0].toLowerCase()),e+r[0].length):-1},b:function(t,n,e){m.lastIndex=0;var r=m.exec(n.slice(e));return r?(t.m=b.get(r[0].toLowerCase()),e+r[0].length):-1},B:function(t,n,e){g.lastIndex=0;var r=g.exec(n.slice(e));return r?(t.m=x.get(r[0].toLowerCase()),e+r[0].length):-1},c:function(t,n,e){return f(t,w.c.toString(),n,e)},d:re,e:re,H:oe,I:oe,j:ie,L:ue,m:ee,M:ae,p:function(t,n,e){var r=h.get(n.slice(e,e+=2).toLowerCase());return null==r?-1:(t.p=r,e)},S:se,U:$n,w:Kn,W:Jn,x:function(t,n,e){return f(t,w.x.toString(),n,e)},X:function(t,n,e){return f(t,w.X.toString(),n,e)},y:te,Y:Qn,Z:ne,"%":le};return l}Rn.year=Bn((function(t){return(t=Rn.day(t)).setMonth(0,1),t}),(function(t,n){t.setFullYear(t.getFullYear()+n)}),(function(t){return t.getFullYear()})),Rn.years=Rn.year.range,Rn.years.utc=Rn.year.utc.range,Rn.day=Bn((function(t){var n=new jn(2e3,0);return n.setFullYear(t.getFullYear(),t.getMonth(),t.getDate()),n}),(function(t,n){t.setDate(t.getDate()+n)}),(function(t){return t.getDate()-1})),Rn.days=Rn.day.range,Rn.days.utc=Rn.day.utc.range,Rn.dayOfYear=function(t){var n=Rn.year(t);return Math.floor((t-n-6e4*(t.getTimezoneOffset()-n.getTimezoneOffset()))/864e5)},["sunday","monday","tuesday","wednesday","thursday","friday","saturday"].forEach((function(t,n){n=7-n;var e=Rn[t]=Bn((function(t){return(t=Rn.day(t)).setDate(t.getDate()-(t.getDay()+n)%7),t}),(function(t,n){t.setDate(t.getDate()+7*Math.floor(n))}),(function(t){var e=Rn.year(t).getDay();return Math.floor((Rn.dayOfYear(t)+(e+n)%7)/7)-(e!==n)}));Rn[t+"s"]=e.range,Rn[t+"s"].utc=e.utc.range,Rn[t+"OfYear"]=function(t){var e=Rn.year(t).getDay();return Math.floor((Rn.dayOfYear(t)+(e+n)%7)/7)}})),Rn.week=Rn.sunday,Rn.weeks=Rn.sunday.range,Rn.weeks.utc=Rn.sunday.utc.range,Rn.weekOfYear=Rn.sundayOfYear;var Un={"-":"",_:" ",0:"0"},Hn=/^\s*\d+/,Xn=/^%/;function Yn(t,n,e){var r=t<0?"-":"",i=(r?-t:t)+"",o=i.length;return r+(o<e?new Array(e-o+1).join(n)+i:i)}function Zn(t){return new RegExp("^(?:"+t.map(o.requote).join("|")+")","i")}function Wn(t){for(var n=new M,e=-1,r=t.length;++e<r;)n.set(t[e].toLowerCase(),e);return n}function Kn(t,n,e){Hn.lastIndex=0;var r=Hn.exec(n.slice(e,e+1));return r?(t.w=+r[0],e+r[0].length):-1}function $n(t,n,e){Hn.lastIndex=0;var r=Hn.exec(n.slice(e));return r?(t.U=+r[0],e+r[0].length):-1}function Jn(t,n,e){Hn.lastIndex=0;var r=Hn.exec(n.slice(e));return r?(t.W=+r[0],e+r[0].length):-1}function Qn(t,n,e){Hn.lastIndex=0;var r=Hn.exec(n.slice(e,e+4));return r?(t.y=+r[0],e+r[0].length):-1}function te(t,n,e){Hn.lastIndex=0;var r,i=Hn.exec(n.slice(e,e+2));return i?(t.y=(r=+i[0])+(r>68?1900:2e3),e+i[0].length):-1}function ne(t,n,e){return/^[+-]\d{4}$/.test(n=n.slice(e,e+5))?(t.Z=-n,e+5):-1}function ee(t,n,e){Hn.lastIndex=0;var r=Hn.exec(n.slice(e,e+2));return r?(t.m=r[0]-1,e+r[0].length):-1}function re(t,n,e){Hn.lastIndex=0;var r=Hn.exec(n.slice(e,e+2));return r?(t.d=+r[0],e+r[0].length):-1}function ie(t,n,e){Hn.lastIndex=0;var r=Hn.exec(n.slice(e,e+3));return r?(t.j=+r[0],e+r[0].length):-1}function oe(t,n,e){Hn.lastIndex=0;var r=Hn.exec(n.slice(e,e+2));return r?(t.H=+r[0],e+r[0].length):-1}function ae(t,n,e){Hn.lastIndex=0;var r=Hn.exec(n.slice(e,e+2));return r?(t.M=+r[0],e+r[0].length):-1}function se(t,n,e){Hn.lastIndex=0;var r=Hn.exec(n.slice(e,e+2));return r?(t.S=+r[0],e+r[0].length):-1}function ue(t,n,e){Hn.lastIndex=0;var r=Hn.exec(n.slice(e,e+3));return r?(t.L=+r[0],e+r[0].length):-1}function ce(t){var n=t.getTimezoneOffset(),e=n>0?"-":"+",r=k(n)/60|0,i=k(n)%60;return e+Yn(r,"0",2)+Yn(i,"0",2)}function le(t,n,e){Xn.lastIndex=0;var r=Xn.exec(n.slice(e,e+1));return r?e+r[0].length:-1}function fe(t){for(var n=t.length,e=-1;++e<n;)t[e][0]=this(t[e][0]);return function(n){for(var e=0,r=t[e];!r[1](n);)r=t[++e];return r[0](n)}}o.locale=function(t){return{numberFormat:Tn(t),timeFormat:Fn(t)}};var he=o.locale({decimal:".",thousands:",",grouping:[3],currency:["$",""],dateTime:"%a %b %e %X %Y",date:"%m/%d/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function pe(){}o.format=he.numberFormat,o.geo={},pe.prototype={s:0,t:0,add:function(t){de(t,this.t,ye),de(ye.s,this.s,this),this.s?this.t+=ye.t:this.s=ye.t},reset:function(){this.s=this.t=0},valueOf:function(){return this.s}};var ye=new pe;function de(t,n,e){var r=e.s=t+n,i=r-t,o=r-i;e.t=t-o+(n-i)}function ve(t,n){t&&xe.hasOwnProperty(t.type)&&xe[t.type](t,n)}o.geo.stream=function(t,n){t&&ge.hasOwnProperty(t.type)?ge[t.type](t,n):ve(t,n)};var ge={Feature:function(t,n){ve(t.geometry,n)},FeatureCollection:function(t,n){for(var e=t.features,r=-1,i=e.length;++r<i;)ve(e[r].geometry,n)}},xe={Sphere:function(t,n){n.sphere()},Point:function(t,n){t=t.coordinates,n.point(t[0],t[1],t[2])},MultiPoint:function(t,n){for(var e=t.coordinates,r=-1,i=e.length;++r<i;)t=e[r],n.point(t[0],t[1],t[2])},LineString:function(t,n){me(t.coordinates,n,0)},MultiLineString:function(t,n){for(var e=t.coordinates,r=-1,i=e.length;++r<i;)me(e[r],n,0)},Polygon:function(t,n){be(t.coordinates,n)},MultiPolygon:function(t,n){for(var e=t.coordinates,r=-1,i=e.length;++r<i;)be(e[r],n)},GeometryCollection:function(t,n){for(var e=t.geometries,r=-1,i=e.length;++r<i;)ve(e[r],n)}};function me(t,n,e){var r,i=-1,o=t.length-e;for(n.lineStart();++i<o;)r=t[i],n.point(r[0],r[1],r[2]);n.lineEnd()}function be(t,n){var e=-1,r=t.length;for(n.polygonStart();++e<r;)me(t[e],n,1);n.polygonEnd()}o.geo.area=function(t){return we=0,o.geo.stream(t,Ie),we};var we,ke,_e,Se,Me,Ee,Ae,Le,Pe,Ne,Ce,Oe,Te=new pe,Ie={sphere:function(){we+=4*Nt},point:j,lineStart:j,lineEnd:j,polygonStart:function(){Te.reset(),Ie.lineStart=De},polygonEnd:function(){var t=2*Te;we+=t<0?4*Nt+t:t,Ie.lineStart=Ie.lineEnd=Ie.point=j}};function De(){var t,n,e,r,i;function o(t,n){n=n*It/2+Nt/4;var o=(t*=It)-e,a=o>=0?1:-1,s=a*o,u=Math.cos(n),c=Math.sin(n),l=i*c,f=r*u+l*Math.cos(s),h=l*a*Math.sin(s);Te.add(Math.atan2(h,f)),e=t,r=u,i=c}Ie.point=function(a,s){Ie.point=o,e=(t=a)*It,r=Math.cos(s=(n=s)*It/2+Nt/4),i=Math.sin(s)},Ie.lineEnd=function(){o(t,n)}}function ze(t){var n=t[0],e=t[1],r=Math.cos(e);return[r*Math.cos(n),r*Math.sin(n),Math.sin(e)]}function Re(t,n){return t[0]*n[0]+t[1]*n[1]+t[2]*n[2]}function je(t,n){return[t[1]*n[2]-t[2]*n[1],t[2]*n[0]-t[0]*n[2],t[0]*n[1]-t[1]*n[0]]}function qe(t,n){t[0]+=n[0],t[1]+=n[1],t[2]+=n[2]}function Ge(t,n){return[t[0]*n,t[1]*n,t[2]*n]}function Be(t){var n=Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=n,t[1]/=n,t[2]/=n}function Ve(t){return[Math.atan2(t[1],t[0]),qt(t[2])]}function Fe(t,n){return k(t[0]-n[0])<Lt&&k(t[1]-n[1])<Lt}o.geo.bounds=function(){var t,n,e,r,i,a,s,u,c,l,f,h={point:p,lineStart:d,lineEnd:v,polygonStart:function(){h.point=g,h.lineStart=x,h.lineEnd=m,c=0,Ie.polygonStart()},polygonEnd:function(){Ie.polygonEnd(),h.point=p,h.lineStart=d,h.lineEnd=v,Te<0?(t=-(e=180),n=-(r=90)):c>Lt?r=90:c<-Lt&&(n=-90),f[0]=t,f[1]=e}};function p(i,o){l.push(f=[t=i,e=i]),o<n&&(n=o),o>r&&(r=o)}function y(o,a){var s=ze([o*It,a*It]);if(u){var c=je(u,s),l=je([c[1],-c[0],0],c);Be(l),l=Ve(l);var f=o-i,h=f>0?1:-1,y=l[0]*Dt*h,d=k(f)>180;if(d^(h*i<y&&y<h*o))(v=l[1]*Dt)>r&&(r=v);else if(d^(h*i<(y=(y+360)%360-180)&&y<h*o)){var v;(v=-l[1]*Dt)<n&&(n=v)}else a<n&&(n=a),a>r&&(r=a);d?o<i?b(t,o)>b(t,e)&&(e=o):b(o,e)>b(t,e)&&(t=o):e>=t?(o<t&&(t=o),o>e&&(e=o)):o>i?b(t,o)>b(t,e)&&(e=o):b(o,e)>b(t,e)&&(t=o)}else p(o,a);u=s,i=o}function d(){h.point=y}function v(){f[0]=t,f[1]=e,h.point=p,u=null}function g(t,n){if(u){var e=t-i;c+=k(e)>180?e+(e>0?360:-360):e}else a=t,s=n;Ie.point(t,n),y(t,n)}function x(){Ie.lineStart()}function m(){g(a,s),Ie.lineEnd(),k(c)>Lt&&(t=-(e=180)),f[0]=t,f[1]=e,u=null}function b(t,n){return(n-=t)<0?n+360:n}function w(t,n){return t[0]-n[0]}function _(t,n){return n[0]<=n[1]?n[0]<=t&&t<=n[1]:t<n[0]||n[1]<t}return function(i){if(r=e=-(t=n=1/0),l=[],o.geo.stream(i,h),c=l.length){l.sort(w);for(var a=1,s=[d=l[0]];a<c;++a)_((p=l[a])[0],d)||_(p[1],d)?(b(d[0],p[1])>b(d[0],d[1])&&(d[1]=p[1]),b(p[0],d[1])>b(d[0],d[1])&&(d[0]=p[0])):s.push(d=p);for(var u,c,p,y=-1/0,d=(a=0,s[c=s.length-1]);a<=c;d=p,++a)p=s[a],(u=b(d[1],p[0]))>y&&(y=u,t=p[0],e=d[1])}return l=f=null,t===1/0||n===1/0?[[NaN,NaN],[NaN,NaN]]:[[t,n],[e,r]]}}(),o.geo.centroid=function(t){ke=_e=Se=Me=Ee=Ae=Le=Pe=Ne=Ce=Oe=0,o.geo.stream(t,Ue);var n=Ne,e=Ce,r=Oe,i=n*n+e*e+r*r;return i<Pt&&(n=Ae,e=Le,r=Pe,_e<Lt&&(n=Se,e=Me,r=Ee),(i=n*n+e*e+r*r)<Pt)?[NaN,NaN]:[Math.atan2(e,n)*Dt,qt(r/Math.sqrt(i))*Dt]};var Ue={sphere:j,point:He,lineStart:Ye,lineEnd:Ze,polygonStart:function(){Ue.lineStart=We},polygonEnd:function(){Ue.lineStart=Ye}};function He(t,n){t*=It;var e=Math.cos(n*=It);Xe(e*Math.cos(t),e*Math.sin(t),Math.sin(n))}function Xe(t,n,e){++ke,Se+=(t-Se)/ke,Me+=(n-Me)/ke,Ee+=(e-Ee)/ke}function Ye(){var t,n,e;function r(r,i){r*=It;var o=Math.cos(i*=It),a=o*Math.cos(r),s=o*Math.sin(r),u=Math.sin(i),c=Math.atan2(Math.sqrt((c=n*u-e*s)*c+(c=e*a-t*u)*c+(c=t*s-n*a)*c),t*a+n*s+e*u);_e+=c,Ae+=c*(t+(t=a)),Le+=c*(n+(n=s)),Pe+=c*(e+(e=u)),Xe(t,n,e)}Ue.point=function(i,o){i*=It;var a=Math.cos(o*=It);t=a*Math.cos(i),n=a*Math.sin(i),e=Math.sin(o),Ue.point=r,Xe(t,n,e)}}function Ze(){Ue.point=He}function We(){var t,n,e,r,i;function o(t,n){t*=It;var o=Math.cos(n*=It),a=o*Math.cos(t),s=o*Math.sin(t),u=Math.sin(n),c=r*u-i*s,l=i*a-e*u,f=e*s-r*a,h=Math.sqrt(c*c+l*l+f*f),p=e*a+r*s+i*u,y=h&&-jt(p)/h,d=Math.atan2(h,p);Ne+=y*c,Ce+=y*l,Oe+=y*f,_e+=d,Ae+=d*(e+(e=a)),Le+=d*(r+(r=s)),Pe+=d*(i+(i=u)),Xe(e,r,i)}Ue.point=function(a,s){t=a,n=s,Ue.point=o,a*=It;var u=Math.cos(s*=It);e=u*Math.cos(a),r=u*Math.sin(a),i=Math.sin(s),Xe(e,r,i)},Ue.lineEnd=function(){o(t,n),Ue.lineEnd=Ze,Ue.point=He}}function Ke(t,n){function e(e,r){return e=t(e,r),n(e[0],e[1])}return t.invert&&n.invert&&(e.invert=function(e,r){return(e=n.invert(e,r))&&t.invert(e[0],e[1])}),e}function $e(){return!0}function Je(t,n,e,r,i){var o=[],a=[];if(t.forEach((function(t){if(!((n=t.length-1)<=0)){var n,e=t[0],r=t[n];if(Fe(e,r)){i.lineStart();for(var s=0;s<n;++s)i.point((e=t[s])[0],e[1]);i.lineEnd()}else{var u=new tr(e,t,null,!0),c=new tr(e,null,u,!1);u.o=c,o.push(u),a.push(c),u=new tr(r,t,null,!1),c=new tr(r,null,u,!0),u.o=c,o.push(u),a.push(c)}}})),a.sort(n),Qe(o),Qe(a),o.length){for(var s=0,u=e,c=a.length;s<c;++s)a[s].e=u=!u;for(var l,f,h=o[0];;){for(var p=h,y=!0;p.v;)if((p=p.n)===h)return;l=p.z,i.lineStart();do{if(p.v=p.o.v=!0,p.e){if(y)for(s=0,c=l.length;s<c;++s)i.point((f=l[s])[0],f[1]);else r(p.x,p.n.x,1,i);p=p.n}else{if(y)for(s=(l=p.p.z).length-1;s>=0;--s)i.point((f=l[s])[0],f[1]);else r(p.x,p.p.x,-1,i);p=p.p}l=(p=p.o).z,y=!y}while(!p.v);i.lineEnd()}}}function Qe(t){if(n=t.length){for(var n,e,r=0,i=t[0];++r<n;)i.n=e=t[r],e.p=i,i=e;i.n=e=t[0],e.p=i}}function tr(t,n,e,r){this.x=t,this.z=n,this.o=e,this.e=r,this.v=!1,this.n=this.p=null}function nr(t,n,e,r){return function(i,a){var s,u=n(a),c=i.invert(r[0],r[1]),l={point:f,lineStart:p,lineEnd:y,polygonStart:function(){l.point=b,l.lineStart=w,l.lineEnd=k,s=[],d=[]},polygonEnd:function(){l.point=f,l.lineStart=p,l.lineEnd=y,s=o.merge(s);var t=function(t,n){var e=t[0],r=t[1],i=[Math.sin(e),-Math.cos(e),0],o=0,a=0;Te.reset();for(var s=0,u=n.length;s<u;++s){var c=n[s],l=c.length;if(l)for(var f=c[0],h=f[0],p=f[1]/2+Nt/4,y=Math.sin(p),d=Math.cos(p),v=1;;){v===l&&(v=0);var g=(t=c[v])[0],x=t[1]/2+Nt/4,m=Math.sin(x),b=Math.cos(x),w=g-h,k=w>=0?1:-1,_=k*w,S=_>Nt,M=y*m;if(Te.add(Math.atan2(M*k*Math.sin(_),d*b+M*Math.cos(_))),o+=S?w+k*Ct:w,S^h>=e^g>=e){var E=je(ze(f),ze(t));Be(E);var A=je(i,E);Be(A);var L=(S^w>=0?-1:1)*qt(A[2]);(r>L||r===L&&(E[0]||E[1]))&&(a+=S^w>=0?1:-1)}if(!v++)break;h=g,y=m,d=b,f=t}}return(o<-Lt||o<Lt&&Te<-Lt)^1&a}(c,d);s.length?(m||(a.polygonStart(),m=!0),Je(s,ir,t,e,a)):t&&(m||(a.polygonStart(),m=!0),a.lineStart(),e(null,null,1,a),a.lineEnd()),m&&(a.polygonEnd(),m=!1),s=d=null},sphere:function(){a.polygonStart(),a.lineStart(),e(null,null,1,a),a.lineEnd(),a.polygonEnd()}};function f(n,e){var r=i(n,e);t(n=r[0],e=r[1])&&a.point(n,e)}function h(t,n){var e=i(t,n);u.point(e[0],e[1])}function p(){l.point=h,u.lineStart()}function y(){l.point=f,u.lineEnd()}var d,v,g=rr(),x=n(g),m=!1;function b(t,n){v.push([t,n]);var e=i(t,n);x.point(e[0],e[1])}function w(){x.lineStart(),v=[]}function k(){b(v[0][0],v[0][1]),x.lineEnd();var t,n=x.clean(),e=g.buffer(),r=e.length;if(v.pop(),d.push(v),v=null,r)if(1&n){var i,o=-1;if((r=(t=e[0]).length-1)>0){for(m||(a.polygonStart(),m=!0),a.lineStart();++o<r;)a.point((i=t[o])[0],i[1]);a.lineEnd()}}else r>1&&2&n&&e.push(e.pop().concat(e.shift())),s.push(e.filter(er))}return l}}function er(t){return t.length>1}function rr(){var t,n=[];return{lineStart:function(){n.push(t=[])},point:function(n,e){t.push([n,e])},lineEnd:j,buffer:function(){var e=n;return n=[],t=null,e},rejoin:function(){n.length>1&&n.push(n.pop().concat(n.shift()))}}}function ir(t,n){return((t=t.x)[0]<0?t[1]-Tt-Lt:Tt-t[1])-((n=n.x)[0]<0?n[1]-Tt-Lt:Tt-n[1])}var or=nr($e,(function(t){var n,e=NaN,r=NaN,i=NaN;return{lineStart:function(){t.lineStart(),n=1},point:function(o,a){var s=o>0?Nt:-Nt,u=k(o-e);k(u-Nt)<Lt?(t.point(e,r=(r+a)/2>0?Tt:-Tt),t.point(i,r),t.lineEnd(),t.lineStart(),t.point(s,r),t.point(o,r),n=0):i!==s&&u>=Nt&&(k(e-i)<Lt&&(e-=i*Lt),k(o-s)<Lt&&(o-=s*Lt),r=function(t,n,e,r){var i,o,a=Math.sin(t-e);return k(a)>Lt?Math.atan((Math.sin(n)*(o=Math.cos(r))*Math.sin(e)-Math.sin(r)*(i=Math.cos(n))*Math.sin(t))/(i*o*a)):(n+r)/2}(e,r,o,a),t.point(i,r),t.lineEnd(),t.lineStart(),t.point(s,r),n=0),t.point(e=o,r=a),i=s},lineEnd:function(){t.lineEnd(),e=r=NaN},clean:function(){return 2-n}}}),(function(t,n,e,r){var i;if(null==t)i=e*Tt,r.point(-Nt,i),r.point(0,i),r.point(Nt,i),r.point(Nt,0),r.point(Nt,-i),r.point(0,-i),r.point(-Nt,-i),r.point(-Nt,0),r.point(-Nt,i);else if(k(t[0]-n[0])>Lt){var o=t[0]<n[0]?Nt:-Nt;i=e*o/2,r.point(-o,i),r.point(0,i),r.point(o,i)}else r.point(n[0],n[1])}),[-Nt,-Nt/2]);function ar(t){var n=Math.cos(t),e=n>0,r=k(n)>Lt;return nr(i,(function(t){var n,s,u,c,l;return{lineStart:function(){c=u=!1,l=1},point:function(f,h){var p,y=[f,h],d=i(f,h),v=e?d?0:a(f,h):d?a(f+(f<0?Nt:-Nt),h):0;if(!n&&(c=u=d)&&t.lineStart(),d!==u&&(p=o(n,y),(Fe(n,p)||Fe(y,p))&&(y[0]+=Lt,y[1]+=Lt,d=i(y[0],y[1]))),d!==u)l=0,d?(t.lineStart(),p=o(y,n),t.point(p[0],p[1])):(p=o(n,y),t.point(p[0],p[1]),t.lineEnd()),n=p;else if(r&&n&&e^d){var g;v&s||!(g=o(y,n,!0))||(l=0,e?(t.lineStart(),t.point(g[0][0],g[0][1]),t.point(g[1][0],g[1][1]),t.lineEnd()):(t.point(g[1][0],g[1][1]),t.lineEnd(),t.lineStart(),t.point(g[0][0],g[0][1])))}!d||n&&Fe(n,y)||t.point(y[0],y[1]),n=y,u=d,s=v},lineEnd:function(){u&&t.lineEnd(),n=null},clean:function(){return l|(c&&u)<<1}}}),Vr(t,6*It),e?[0,-t]:[-Nt,t-Nt]);function i(t,e){return Math.cos(t)*Math.cos(e)>n}function o(t,e,r){var i=[1,0,0],o=je(ze(t),ze(e)),a=Re(o,o),s=o[0],u=a-s*s;if(!u)return!r&&t;var c=n*a/u,l=-n*s/u,f=je(i,o),h=Ge(i,c);qe(h,Ge(o,l));var p=f,y=Re(h,p),d=Re(p,p),v=y*y-d*(Re(h,h)-1);if(!(v<0)){var g=Math.sqrt(v),x=Ge(p,(-y-g)/d);if(qe(x,h),x=Ve(x),!r)return x;var m,b=t[0],w=e[0],_=t[1],S=e[1];w<b&&(m=b,b=w,w=m);var M=w-b,E=k(M-Nt)<Lt;if(!E&&S<_&&(m=_,_=S,S=m),E||M<Lt?E?_+S>0^x[1]<(k(x[0]-b)<Lt?_:S):_<=x[1]&&x[1]<=S:M>Nt^(b<=x[0]&&x[0]<=w)){var A=Ge(p,(-y+g)/d);return qe(A,h),[x,Ve(A)]}}}function a(n,r){var i=e?t:Nt-t,o=0;return n<-i?o|=1:n>i&&(o|=2),r<-i?o|=4:r>i&&(o|=8),o}}function sr(t,n,e,r){return function(i){var o,a=i.a,s=i.b,u=a.x,c=a.y,l=0,f=1,h=s.x-u,p=s.y-c;if(o=t-u,h||!(o>0)){if(o/=h,h<0){if(o<l)return;o<f&&(f=o)}else if(h>0){if(o>f)return;o>l&&(l=o)}if(o=e-u,h||!(o<0)){if(o/=h,h<0){if(o>f)return;o>l&&(l=o)}else if(h>0){if(o<l)return;o<f&&(f=o)}if(o=n-c,p||!(o>0)){if(o/=p,p<0){if(o<l)return;o<f&&(f=o)}else if(p>0){if(o>f)return;o>l&&(l=o)}if(o=r-c,p||!(o<0)){if(o/=p,p<0){if(o>f)return;o>l&&(l=o)}else if(p>0){if(o<l)return;o<f&&(f=o)}return l>0&&(i.a={x:u+l*h,y:c+l*p}),f<1&&(i.b={x:u+f*h,y:c+f*p}),i}}}}}}function ur(t,n,e,r){return function(u){var c,l,f,h,p,y,d,v,g,x,m,b=u,w=rr(),k=sr(t,n,e,r),_={point:E,lineStart:function(){_.point=A,l&&l.push(f=[]);x=!0,g=!1,d=v=NaN},lineEnd:function(){c&&(A(h,p),y&&g&&w.rejoin(),c.push(w.buffer()));_.point=E,g&&u.lineEnd()},polygonStart:function(){u=w,c=[],l=[],m=!0},polygonEnd:function(){u=b,c=o.merge(c);var n=function(t){for(var n=0,e=l.length,r=t[1],i=0;i<e;++i)for(var o,a=1,s=l[i],u=s.length,c=s[0];a<u;++a)o=s[a],c[1]<=r?o[1]>r&&Rt(c,o,t)>0&&++n:o[1]<=r&&Rt(c,o,t)<0&&--n,c=o;return 0!==n}([t,r]),e=m&&n,i=c.length;(e||i)&&(u.polygonStart(),e&&(u.lineStart(),S(null,null,1,u),u.lineEnd()),i&&Je(c,a,n,S,u),u.polygonEnd()),c=l=f=null}};function S(o,a,u,c){var l=0,f=0;if(null==o||(l=i(o,u))!==(f=i(a,u))||s(o,a)<0^u>0)do{c.point(0===l||3===l?t:e,l>1?r:n)}while((l=(l+u+4)%4)!==f);else c.point(a[0],a[1])}function M(i,o){return t<=i&&i<=e&&n<=o&&o<=r}function E(t,n){M(t,n)&&u.point(t,n)}function A(t,n){var e=M(t=Math.max(-1e9,Math.min(1e9,t)),n=Math.max(-1e9,Math.min(1e9,n)));if(l&&f.push([t,n]),x)h=t,p=n,y=e,x=!1,e&&(u.lineStart(),u.point(t,n));else if(e&&g)u.point(t,n);else{var r={a:{x:d,y:v},b:{x:t,y:n}};k(r)?(g||(u.lineStart(),u.point(r.a.x,r.a.y)),u.point(r.b.x,r.b.y),e||u.lineEnd(),m=!1):e&&(u.lineStart(),u.point(t,n),m=!1)}d=t,v=n,g=e}return _};function i(r,i){return k(r[0]-t)<Lt?i>0?0:3:k(r[0]-e)<Lt?i>0?2:1:k(r[1]-n)<Lt?i>0?1:0:i>0?3:2}function a(t,n){return s(t.x,n.x)}function s(t,n){var e=i(t,1),r=i(n,1);return e!==r?e-r:0===e?n[1]-t[1]:1===e?t[0]-n[0]:2===e?t[1]-n[1]:n[0]-t[0]}}function cr(t){var n=0,e=Nt/3,r=Ir(t),i=r(n,e);return i.parallels=function(t){return arguments.length?r(n=t[0]*Nt/180,e=t[1]*Nt/180):[n/Nt*180,e/Nt*180]},i}function lr(t,n){var e=Math.sin(t),r=(e+Math.sin(n))/2,i=1+e*(2*r-e),o=Math.sqrt(i)/r;function a(t,n){var e=Math.sqrt(i-2*r*Math.sin(n))/r;return[e*Math.sin(t*=r),o-e*Math.cos(t)]}return a.invert=function(t,n){var e=o-n;return[Math.atan2(t,e)/r,qt((i-(t*t+e*e)*r*r)/(2*r))]},a}o.geo.clipExtent=function(){var t,n,e,r,i,o,a={stream:function(t){return i&&(i.valid=!1),(i=o(t)).valid=!0,i},extent:function(s){return arguments.length?(o=ur(t=+s[0][0],n=+s[0][1],e=+s[1][0],r=+s[1][1]),i&&(i.valid=!1,i=null),a):[[t,n],[e,r]]}};return a.extent([[0,0],[960,500]])},(o.geo.conicEqualArea=function(){return cr(lr)}).raw=lr,o.geo.albers=function(){return o.geo.conicEqualArea().rotate([96,0]).center([-.6,38.7]).parallels([29.5,45.5]).scale(1070)},o.geo.albersUsa=function(){var t,n,e,r,i=o.geo.albers(),a=o.geo.conicEqualArea().rotate([154,0]).center([-2,58.5]).parallels([55,65]),s=o.geo.conicEqualArea().rotate([157,0]).center([-3,19.9]).parallels([8,18]),u={point:function(n,e){t=[n,e]}};function c(i){var o=i[0],a=i[1];return t=null,n(o,a),t||(e(o,a),t)||r(o,a),t}return c.invert=function(t){var n=i.scale(),e=i.translate(),r=(t[0]-e[0])/n,o=(t[1]-e[1])/n;return(o>=.12&&o<.234&&r>=-.425&&r<-.214?a:o>=.166&&o<.234&&r>=-.214&&r<-.115?s:i).invert(t)},c.stream=function(t){var n=i.stream(t),e=a.stream(t),r=s.stream(t);return{point:function(t,i){n.point(t,i),e.point(t,i),r.point(t,i)},sphere:function(){n.sphere(),e.sphere(),r.sphere()},lineStart:function(){n.lineStart(),e.lineStart(),r.lineStart()},lineEnd:function(){n.lineEnd(),e.lineEnd(),r.lineEnd()},polygonStart:function(){n.polygonStart(),e.polygonStart(),r.polygonStart()},polygonEnd:function(){n.polygonEnd(),e.polygonEnd(),r.polygonEnd()}}},c.precision=function(t){return arguments.length?(i.precision(t),a.precision(t),s.precision(t),c):i.precision()},c.scale=function(t){return arguments.length?(i.scale(t),a.scale(.35*t),s.scale(t),c.translate(i.translate())):i.scale()},c.translate=function(t){if(!arguments.length)return i.translate();var o=i.scale(),l=+t[0],f=+t[1];return n=i.translate(t).clipExtent([[l-.455*o,f-.238*o],[l+.455*o,f+.238*o]]).stream(u).point,e=a.translate([l-.307*o,f+.201*o]).clipExtent([[l-.425*o+Lt,f+.12*o+Lt],[l-.214*o-Lt,f+.234*o-Lt]]).stream(u).point,r=s.translate([l-.205*o,f+.212*o]).clipExtent([[l-.214*o+Lt,f+.166*o+Lt],[l-.115*o-Lt,f+.234*o-Lt]]).stream(u).point,c},c.scale(1070)};var fr,hr,pr,yr,dr,vr,gr={point:j,lineStart:j,lineEnd:j,polygonStart:function(){hr=0,gr.lineStart=xr},polygonEnd:function(){gr.lineStart=gr.lineEnd=gr.point=j,fr+=k(hr/2)}};function xr(){var t,n,e,r;function i(t,n){hr+=r*t-e*n,e=t,r=n}gr.point=function(o,a){gr.point=i,t=e=o,n=r=a},gr.lineEnd=function(){i(t,n)}}var mr={point:function(t,n){t<pr&&(pr=t);t>dr&&(dr=t);n<yr&&(yr=n);n>vr&&(vr=n)},lineStart:j,lineEnd:j,polygonStart:j,polygonEnd:j};function br(){var t=wr(4.5),n=[],e={point:r,lineStart:function(){e.point=i},lineEnd:a,polygonStart:function(){e.lineEnd=s},polygonEnd:function(){e.lineEnd=a,e.point=r},pointRadius:function(n){return t=wr(n),e},result:function(){if(n.length){var t=n.join("");return n=[],t}}};function r(e,r){n.push("M",e,",",r,t)}function i(t,r){n.push("M",t,",",r),e.point=o}function o(t,e){n.push("L",t,",",e)}function a(){e.point=r}function s(){n.push("Z")}return e}function wr(t){return"m0,"+t+"a"+t+","+t+" 0 1,1 0,"+-2*t+"a"+t+","+t+" 0 1,1 0,"+2*t+"z"}var kr,_r={point:Sr,lineStart:Mr,lineEnd:Er,polygonStart:function(){_r.lineStart=Ar},polygonEnd:function(){_r.point=Sr,_r.lineStart=Mr,_r.lineEnd=Er}};function Sr(t,n){Se+=t,Me+=n,++Ee}function Mr(){var t,n;function e(e,r){var i=e-t,o=r-n,a=Math.sqrt(i*i+o*o);Ae+=a*(t+e)/2,Le+=a*(n+r)/2,Pe+=a,Sr(t=e,n=r)}_r.point=function(r,i){_r.point=e,Sr(t=r,n=i)}}function Er(){_r.point=Sr}function Ar(){var t,n,e,r;function i(t,n){var i=t-e,o=n-r,a=Math.sqrt(i*i+o*o);Ae+=a*(e+t)/2,Le+=a*(r+n)/2,Pe+=a,Ne+=(a=r*t-e*n)*(e+t),Ce+=a*(r+n),Oe+=3*a,Sr(e=t,r=n)}_r.point=function(o,a){_r.point=i,Sr(t=e=o,n=r=a)},_r.lineEnd=function(){i(t,n)}}function Lr(t){var n=4.5,e={point:r,lineStart:function(){e.point=i},lineEnd:a,polygonStart:function(){e.lineEnd=s},polygonEnd:function(){e.lineEnd=a,e.point=r},pointRadius:function(t){return n=t,e},result:j};function r(e,r){t.moveTo(e+n,r),t.arc(e,r,n,0,Ct)}function i(n,r){t.moveTo(n,r),e.point=o}function o(n,e){t.lineTo(n,e)}function a(){e.point=r}function s(){t.closePath()}return e}function Pr(t){var n=.5,e=Math.cos(30*It),r=16;function i(t){return(r?a:o)(t)}function o(n){return Or(n,(function(e,r){e=t(e,r),n.point(e[0],e[1])}))}function a(n){var e,i,o,a,u,c,l,f,h,p,y,d,v={point:g,lineStart:x,lineEnd:b,polygonStart:function(){n.polygonStart(),v.lineStart=w},polygonEnd:function(){n.polygonEnd(),v.lineStart=x}};function g(e,r){e=t(e,r),n.point(e[0],e[1])}function x(){f=NaN,v.point=m,n.lineStart()}function m(e,i){var o=ze([e,i]),a=t(e,i);s(f,h,l,p,y,d,f=a[0],h=a[1],l=e,p=o[0],y=o[1],d=o[2],r,n),n.point(f,h)}function b(){v.point=g,n.lineEnd()}function w(){x(),v.point=k,v.lineEnd=_}function k(t,n){m(e=t,n),i=f,o=h,a=p,u=y,c=d,v.point=m}function _(){s(f,h,l,p,y,d,i,o,e,a,u,c,r,n),v.lineEnd=b,b()}return v}function s(r,i,o,a,u,c,l,f,h,p,y,d,v,g){var x=l-r,m=f-i,b=x*x+m*m;if(b>4*n&&v--){var w=a+p,_=u+y,S=c+d,M=Math.sqrt(w*w+_*_+S*S),E=Math.asin(S/=M),A=k(k(S)-1)<Lt||k(o-h)<Lt?(o+h)/2:Math.atan2(_,w),L=t(A,E),P=L[0],N=L[1],C=P-r,O=N-i,T=m*C-x*O;(T*T/b>n||k((x*C+m*O)/b-.5)>.3||a*p+u*y+c*d<e)&&(s(r,i,o,a,u,c,P,N,A,w/=M,_/=M,S,v,g),g.point(P,N),s(P,N,A,w,_,S,l,f,h,p,y,d,v,g))}}return i.precision=function(t){return arguments.length?(r=(n=t*t)>0&&16,i):Math.sqrt(n)},i}function Nr(t){var n=Pr((function(n,e){return t([n*Dt,e*Dt])}));return function(t){return Dr(n(t))}}function Cr(t){this.stream=t}function Or(t,n){return{point:n,sphere:function(){t.sphere()},lineStart:function(){t.lineStart()},lineEnd:function(){t.lineEnd()},polygonStart:function(){t.polygonStart()},polygonEnd:function(){t.polygonEnd()}}}function Tr(t){return Ir((function(){return t}))()}function Ir(t){var n,e,r,i,a,s,u=Pr((function(t,e){return[(t=n(t,e))[0]*c+i,a-t[1]*c]})),c=150,l=480,f=250,h=0,p=0,y=0,d=0,v=0,g=or,x=I,m=null,b=null;function w(t){return[(t=r(t[0]*It,t[1]*It))[0]*c+i,a-t[1]*c]}function k(t){return(t=r.invert((t[0]-i)/c,(a-t[1])/c))&&[t[0]*Dt,t[1]*Dt]}function _(){r=Ke(e=jr(y,d,v),n);var t=n(h,p);return i=l-t[0]*c,a=f+t[1]*c,S()}function S(){return s&&(s.valid=!1,s=null),w}return w.stream=function(t){return s&&(s.valid=!1),(s=Dr(g(e,u(x(t))))).valid=!0,s},w.clipAngle=function(t){return arguments.length?(g=null==t?(m=t,or):ar((m=+t)*It),S()):m},w.clipExtent=function(t){return arguments.length?(b=t,x=t?ur(t[0][0],t[0][1],t[1][0],t[1][1]):I,S()):b},w.scale=function(t){return arguments.length?(c=+t,_()):c},w.translate=function(t){return arguments.length?(l=+t[0],f=+t[1],_()):[l,f]},w.center=function(t){return arguments.length?(h=t[0]%360*It,p=t[1]%360*It,_()):[h*Dt,p*Dt]},w.rotate=function(t){return arguments.length?(y=t[0]%360*It,d=t[1]%360*It,v=t.length>2?t[2]%360*It:0,_()):[y*Dt,d*Dt,v*Dt]},o.rebind(w,u,"precision"),function(){return n=t.apply(this,arguments),w.invert=n.invert&&k,_()}}function Dr(t){return Or(t,(function(n,e){t.point(n*It,e*It)}))}function zr(t,n){return[t,n]}function Rr(t,n){return[t>Nt?t-Ct:t<-Nt?t+Ct:t,n]}function jr(t,n,e){return t?n||e?Ke(Gr(t),Br(n,e)):Gr(t):n||e?Br(n,e):Rr}function qr(t){return function(n,e){return[(n+=t)>Nt?n-Ct:n<-Nt?n+Ct:n,e]}}function Gr(t){var n=qr(t);return n.invert=qr(-t),n}function Br(t,n){var e=Math.cos(t),r=Math.sin(t),i=Math.cos(n),o=Math.sin(n);function a(t,n){var a=Math.cos(n),s=Math.cos(t)*a,u=Math.sin(t)*a,c=Math.sin(n),l=c*e+s*r;return[Math.atan2(u*i-l*o,s*e-c*r),qt(l*i+u*o)]}return a.invert=function(t,n){var a=Math.cos(n),s=Math.cos(t)*a,u=Math.sin(t)*a,c=Math.sin(n),l=c*i-u*o;return[Math.atan2(u*i+c*o,s*e+l*r),qt(l*e-s*r)]},a}function Vr(t,n){var e=Math.cos(t),r=Math.sin(t);return function(i,o,a,s){var u=a*n;null!=i?(i=Fr(e,i),o=Fr(e,o),(a>0?i<o:i>o)&&(i+=a*Ct)):(i=t+a*Ct,o=t-.5*u);for(var c,l=i;a>0?l>o:l<o;l-=u)s.point((c=Ve([e,-r*Math.cos(l),-r*Math.sin(l)]))[0],c[1])}}function Fr(t,n){var e=ze(n);e[0]-=t,Be(e);var r=jt(-e[1]);return((-e[2]<0?-r:r)+2*Math.PI-Lt)%(2*Math.PI)}function Ur(t,n,e){var r=o.range(t,n-Lt,e).concat(n);return function(t){return r.map((function(n){return[t,n]}))}}function Hr(t,n,e){var r=o.range(t,n-Lt,e).concat(n);return function(t){return r.map((function(n){return[n,t]}))}}function Xr(t){return t.source}function Yr(t){return t.target}o.geo.path=function(){var t,n,e,r,i,a=4.5;function s(t){return t&&("function"==typeof a&&r.pointRadius(+a.apply(this,arguments)),i&&i.valid||(i=e(r)),o.geo.stream(t,i)),r.result()}function u(){return i=null,s}return s.area=function(t){return fr=0,o.geo.stream(t,e(gr)),fr},s.centroid=function(t){return Se=Me=Ee=Ae=Le=Pe=Ne=Ce=Oe=0,o.geo.stream(t,e(_r)),Oe?[Ne/Oe,Ce/Oe]:Pe?[Ae/Pe,Le/Pe]:Ee?[Se/Ee,Me/Ee]:[NaN,NaN]},s.bounds=function(t){return dr=vr=-(pr=yr=1/0),o.geo.stream(t,e(mr)),[[pr,yr],[dr,vr]]},s.projection=function(n){return arguments.length?(e=(t=n)?n.stream||Nr(n):I,u()):t},s.context=function(t){return arguments.length?(r=null==(n=t)?new br:new Lr(t),"function"!=typeof a&&r.pointRadius(a),u()):n},s.pointRadius=function(t){return arguments.length?(a="function"==typeof t?t:(r.pointRadius(+t),+t),s):a},s.projection(o.geo.albersUsa()).context(null)},o.geo.transform=function(t){return{stream:function(n){var e=new Cr(n);for(var r in t)e[r]=t[r];return e}}},Cr.prototype={point:function(t,n){this.stream.point(t,n)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}},o.geo.projection=Tr,o.geo.projectionMutator=Ir,(o.geo.equirectangular=function(){return Tr(zr)}).raw=zr.invert=zr,o.geo.rotation=function(t){function n(n){return(n=t(n[0]*It,n[1]*It))[0]*=Dt,n[1]*=Dt,n}return t=jr(t[0]%360*It,t[1]*It,t.length>2?t[2]*It:0),n.invert=function(n){return(n=t.invert(n[0]*It,n[1]*It))[0]*=Dt,n[1]*=Dt,n},n},Rr.invert=zr,o.geo.circle=function(){var t,n,e=[0,0],r=6;function i(){var t="function"==typeof e?e.apply(this,arguments):e,r=jr(-t[0]*It,-t[1]*It,0).invert,i=[];return n(null,null,1,{point:function(t,n){i.push(t=r(t,n)),t[0]*=Dt,t[1]*=Dt}}),{type:"Polygon",coordinates:[i]}}return i.origin=function(t){return arguments.length?(e=t,i):e},i.angle=function(e){return arguments.length?(n=Vr((t=+e)*It,r*It),i):t},i.precision=function(e){return arguments.length?(n=Vr(t*It,(r=+e)*It),i):r},i.angle(90)},o.geo.distance=function(t,n){var e,r=(n[0]-t[0])*It,i=t[1]*It,o=n[1]*It,a=Math.sin(r),s=Math.cos(r),u=Math.sin(i),c=Math.cos(i),l=Math.sin(o),f=Math.cos(o);return Math.atan2(Math.sqrt((e=f*a)*e+(e=c*l-u*f*s)*e),u*l+c*f*s)},o.geo.graticule=function(){var t,n,e,r,i,a,s,u,c,l,f,h,p=10,y=p,d=90,v=360,g=2.5;function x(){return{type:"MultiLineString",coordinates:m()}}function m(){return o.range(Math.ceil(r/d)*d,e,d).map(f).concat(o.range(Math.ceil(u/v)*v,s,v).map(h)).concat(o.range(Math.ceil(n/p)*p,t,p).filter((function(t){return k(t%d)>Lt})).map(c)).concat(o.range(Math.ceil(a/y)*y,i,y).filter((function(t){return k(t%v)>Lt})).map(l))}return x.lines=function(){return m().map((function(t){return{type:"LineString",coordinates:t}}))},x.outline=function(){return{type:"Polygon",coordinates:[f(r).concat(h(s).slice(1),f(e).reverse().slice(1),h(u).reverse().slice(1))]}},x.extent=function(t){return arguments.length?x.majorExtent(t).minorExtent(t):x.minorExtent()},x.majorExtent=function(t){return arguments.length?(r=+t[0][0],e=+t[1][0],u=+t[0][1],s=+t[1][1],r>e&&(t=r,r=e,e=t),u>s&&(t=u,u=s,s=t),x.precision(g)):[[r,u],[e,s]]},x.minorExtent=function(e){return arguments.length?(n=+e[0][0],t=+e[1][0],a=+e[0][1],i=+e[1][1],n>t&&(e=n,n=t,t=e),a>i&&(e=a,a=i,i=e),x.precision(g)):[[n,a],[t,i]]},x.step=function(t){return arguments.length?x.majorStep(t).minorStep(t):x.minorStep()},x.majorStep=function(t){return arguments.length?(d=+t[0],v=+t[1],x):[d,v]},x.minorStep=function(t){return arguments.length?(p=+t[0],y=+t[1],x):[p,y]},x.precision=function(o){return arguments.length?(g=+o,c=Ur(a,i,90),l=Hr(n,t,g),f=Ur(u,s,90),h=Hr(r,e,g),x):g},x.majorExtent([[-180,-90+Lt],[180,90-Lt]]).minorExtent([[-180,-80-Lt],[180,80+Lt]])},o.geo.greatArc=function(){var t,n,e=Xr,r=Yr;function i(){return{type:"LineString",coordinates:[t||e.apply(this,arguments),n||r.apply(this,arguments)]}}return i.distance=function(){return o.geo.distance(t||e.apply(this,arguments),n||r.apply(this,arguments))},i.source=function(n){return arguments.length?(e=n,t="function"==typeof n?null:n,i):e},i.target=function(t){return arguments.length?(r=t,n="function"==typeof t?null:t,i):r},i.precision=function(){return arguments.length?i:0},i},o.geo.interpolate=function(t,n){return e=t[0]*It,r=t[1]*It,i=n[0]*It,o=n[1]*It,a=Math.cos(r),s=Math.sin(r),u=Math.cos(o),c=Math.sin(o),l=a*Math.cos(e),f=a*Math.sin(e),h=u*Math.cos(i),p=u*Math.sin(i),y=2*Math.asin(Math.sqrt(Bt(o-r)+a*u*Bt(i-e))),d=1/Math.sin(y),(v=y?function(t){var n=Math.sin(t*=y)*d,e=Math.sin(y-t)*d,r=e*l+n*h,i=e*f+n*p,o=e*s+n*c;return[Math.atan2(i,r)*Dt,Math.atan2(o,Math.sqrt(r*r+i*i))*Dt]}:function(){return[e*Dt,r*Dt]}).distance=y,v;var e,r,i,o,a,s,u,c,l,f,h,p,y,d,v},o.geo.length=function(t){return kr=0,o.geo.stream(t,Zr),kr};var Zr={sphere:j,point:j,lineStart:function(){var t,n,e;function r(r,i){var o=Math.sin(i*=It),a=Math.cos(i),s=k((r*=It)-t),u=Math.cos(s);kr+=Math.atan2(Math.sqrt((s=a*Math.sin(s))*s+(s=e*o-n*a*u)*s),n*o+e*a*u),t=r,n=o,e=a}Zr.point=function(i,o){t=i*It,n=Math.sin(o*=It),e=Math.cos(o),Zr.point=r},Zr.lineEnd=function(){Zr.point=Zr.lineEnd=j}},lineEnd:j,polygonStart:j,polygonEnd:j};function Wr(t,n){function e(n,e){var r=Math.cos(n),i=Math.cos(e),o=t(r*i);return[o*i*Math.sin(n),o*Math.sin(e)]}return e.invert=function(t,e){var r=Math.sqrt(t*t+e*e),i=n(r),o=Math.sin(i),a=Math.cos(i);return[Math.atan2(t*o,r*a),Math.asin(r&&e*o/r)]},e}var Kr=Wr((function(t){return Math.sqrt(2/(1+t))}),(function(t){return 2*Math.asin(t/2)}));(o.geo.azimuthalEqualArea=function(){return Tr(Kr)}).raw=Kr;var $r=Wr((function(t){var n=Math.acos(t);return n&&n/Math.sin(n)}),I);function Jr(t,n){var e=Math.cos(t),r=function(t){return Math.tan(Nt/4+t/2)},i=t===n?Math.sin(t):Math.log(e/Math.cos(n))/Math.log(r(n)/r(t)),o=e*Math.pow(r(t),i)/i;if(!i)return ni;function a(t,n){o>0?n<-Tt+Lt&&(n=-Tt+Lt):n>Tt-Lt&&(n=Tt-Lt);var e=o/Math.pow(r(n),i);return[e*Math.sin(i*t),o-e*Math.cos(i*t)]}return a.invert=function(t,n){var e=o-n,r=zt(i)*Math.sqrt(t*t+e*e);return[Math.atan2(t,e)/i,2*Math.atan(Math.pow(o/r,1/i))-Tt]},a}function Qr(t,n){var e=Math.cos(t),r=t===n?Math.sin(t):(e-Math.cos(n))/(n-t),i=e/r+t;if(k(r)<Lt)return zr;function o(t,n){var e=i-n;return[e*Math.sin(r*t),i-e*Math.cos(r*t)]}return o.invert=function(t,n){var e=i-n;return[Math.atan2(t,e)/r,i-zt(r)*Math.sqrt(t*t+e*e)]},o}(o.geo.azimuthalEquidistant=function(){return Tr($r)}).raw=$r,(o.geo.conicConformal=function(){return cr(Jr)}).raw=Jr,(o.geo.conicEquidistant=function(){return cr(Qr)}).raw=Qr;var ti=Wr((function(t){return 1/t}),Math.atan);function ni(t,n){return[t,Math.log(Math.tan(Nt/4+n/2))]}function ei(t){var n,e=Tr(t),r=e.scale,i=e.translate,o=e.clipExtent;return e.scale=function(){var t=r.apply(e,arguments);return t===e?n?e.clipExtent(null):e:t},e.translate=function(){var t=i.apply(e,arguments);return t===e?n?e.clipExtent(null):e:t},e.clipExtent=function(t){var a=o.apply(e,arguments);if(a===e){if(n=null==t){var s=Nt*r(),u=i();o([[u[0]-s,u[1]-s],[u[0]+s,u[1]+s]])}}else n&&(a=null);return a},e.clipExtent(null)}(o.geo.gnomonic=function(){return Tr(ti)}).raw=ti,ni.invert=function(t,n){return[t,2*Math.atan(Math.exp(n))-Tt]},(o.geo.mercator=function(){return ei(ni)}).raw=ni;var ri=Wr((function(){return 1}),Math.asin);(o.geo.orthographic=function(){return Tr(ri)}).raw=ri;var ii=Wr((function(t){return 1/(1+t)}),(function(t){return 2*Math.atan(t)}));function oi(t,n){return[Math.log(Math.tan(Nt/4+n/2)),-t]}function ai(t){return t[0]}function si(t){return t[1]}function ui(t){for(var n=t.length,e=[0,1],r=2,i=2;i<n;i++){for(;r>1&&Rt(t[e[r-2]],t[e[r-1]],t[i])<=0;)--r;e[r++]=i}return e.slice(0,r)}function ci(t,n){return t[0]-n[0]||t[1]-n[1]}(o.geo.stereographic=function(){return Tr(ii)}).raw=ii,oi.invert=function(t,n){return[-n,2*Math.atan(Math.exp(t))-Tt]},(o.geo.transverseMercator=function(){var t=ei(oi),n=t.center,e=t.rotate;return t.center=function(t){return t?n([-t[1],t[0]]):[(t=n())[1],-t[0]]},t.rotate=function(t){return t?e([t[0],t[1],t.length>2?t[2]+90:90]):[(t=e())[0],t[1],t[2]-90]},e([0,0,90])}).raw=oi,o.geom={},o.geom.hull=function(t){var n=ai,e=si;if(arguments.length)return r(t);function r(t){if(t.length<3)return[];var r,i=mn(n),o=mn(e),a=t.length,s=[],u=[];for(r=0;r<a;r++)s.push([+i.call(this,t[r],r),+o.call(this,t[r],r),r]);for(s.sort(ci),r=0;r<a;r++)u.push([s[r][0],-s[r][1]]);var c=ui(s),l=ui(u),f=l[0]===c[0],h=l[l.length-1]===c[c.length-1],p=[];for(r=c.length-1;r>=0;--r)p.push(t[s[c[r]][2]]);for(r=+f;r<l.length-h;++r)p.push(t[s[l[r]][2]]);return p}return r.x=function(t){return arguments.length?(n=t,r):n},r.y=function(t){return arguments.length?(e=t,r):e},r},o.geom.polygon=function(t){return H(t,li),t};var li=o.geom.polygon.prototype=[];function fi(t,n,e){return(e[0]-n[0])*(t[1]-n[1])<(e[1]-n[1])*(t[0]-n[0])}function hi(t,n,e,r){var i=t[0],o=e[0],a=n[0]-i,s=r[0]-o,u=t[1],c=e[1],l=n[1]-u,f=r[1]-c,h=(s*(u-c)-f*(i-o))/(f*a-s*l);return[i+h*a,u+h*l]}function pi(t){var n=t[0],e=t[t.length-1];return!(n[0]-e[0]||n[1]-e[1])}li.area=function(){for(var t,n=-1,e=this.length,r=this[e-1],i=0;++n<e;)t=r,r=this[n],i+=t[1]*r[0]-t[0]*r[1];return.5*i},li.centroid=function(t){var n,e,r=-1,i=this.length,o=0,a=0,s=this[i-1];for(arguments.length||(t=-1/(6*this.area()));++r<i;)n=s,s=this[r],e=n[0]*s[1]-s[0]*n[1],o+=(n[0]+s[0])*e,a+=(n[1]+s[1])*e;return[o*t,a*t]},li.clip=function(t){for(var n,e,r,i,o,a,s=pi(t),u=-1,c=this.length-pi(this),l=this[c-1];++u<c;){for(n=t.slice(),t.length=0,i=this[u],o=n[(r=n.length-s)-1],e=-1;++e<r;)fi(a=n[e],l,i)?(fi(o,l,i)||t.push(hi(o,a,l,i)),t.push(a)):fi(o,l,i)&&t.push(hi(o,a,l,i)),o=a;s&&t.push(t[0]),l=i}return t};var yi,di,vi,gi,xi,mi=[],bi=[];function wi(){Gi(this),this.edge=this.site=this.circle=null}function ki(t){var n=mi.pop()||new wi;return n.site=t,n}function _i(t){Oi(t),vi.remove(t),mi.push(t),Gi(t)}function Si(t){var n=t.circle,e=n.x,r=n.cy,i={x:e,y:r},o=t.P,a=t.N,s=[t];_i(t);for(var u=o;u.circle&&k(e-u.circle.x)<Lt&&k(r-u.circle.cy)<Lt;)o=u.P,s.unshift(u),_i(u),u=o;s.unshift(u),Oi(u);for(var c=a;c.circle&&k(e-c.circle.x)<Lt&&k(r-c.circle.cy)<Lt;)a=c.N,s.push(c),_i(c),c=a;s.push(c),Oi(c);var l,f=s.length;for(l=1;l<f;++l)c=s[l],u=s[l-1],Ri(c.edge,u.site,c.site,i);u=s[0],(c=s[f-1]).edge=Di(u.site,c.site,null,i),Ci(u),Ci(c)}function Mi(t){for(var n,e,r,i,o=t.x,a=t.y,s=vi._;s;)if((r=Ei(s,a)-o)>Lt)s=s.L;else{if(!((i=o-Ai(s,a))>Lt)){r>-Lt?(n=s.P,e=s):i>-Lt?(n=s,e=s.N):n=e=s;break}if(!s.R){n=s;break}s=s.R}var u=ki(t);if(vi.insert(n,u),n||e){if(n===e)return Oi(n),e=ki(n.site),vi.insert(u,e),u.edge=e.edge=Di(n.site,u.site),Ci(n),void Ci(e);if(e){Oi(n),Oi(e);var c=n.site,l=c.x,f=c.y,h=t.x-l,p=t.y-f,y=e.site,d=y.x-l,v=y.y-f,g=2*(h*v-p*d),x=h*h+p*p,m=d*d+v*v,b={x:(v*x-p*m)/g+l,y:(h*m-d*x)/g+f};Ri(e.edge,c,y,b),u.edge=Di(c,t,null,b),e.edge=Di(t,y,null,b),Ci(n),Ci(e)}else u.edge=Di(n.site,u.site)}}function Ei(t,n){var e=t.site,r=e.x,i=e.y,o=i-n;if(!o)return r;var a=t.P;if(!a)return-1/0;var s=(e=a.site).x,u=e.y,c=u-n;if(!c)return s;var l=s-r,f=1/o-1/c,h=l/c;return f?(-h+Math.sqrt(h*h-2*f*(l*l/(-2*c)-u+c/2+i-o/2)))/f+r:(r+s)/2}function Ai(t,n){var e=t.N;if(e)return Ei(e,n);var r=t.site;return r.y===n?r.x:1/0}function Li(t){this.site=t,this.edges=[]}function Pi(t,n){return n.angle-t.angle}function Ni(){Gi(this),this.x=this.y=this.arc=this.site=this.cy=null}function Ci(t){var n=t.P,e=t.N;if(n&&e){var r=n.site,i=t.site,o=e.site;if(r!==o){var a=i.x,s=i.y,u=r.x-a,c=r.y-s,l=o.x-a,f=2*(u*(v=o.y-s)-c*l);if(!(f>=-Pt)){var h=u*u+c*c,p=l*l+v*v,y=(v*h-c*p)/f,d=(u*p-l*h)/f,v=d+s,g=bi.pop()||new Ni;g.arc=t,g.site=i,g.x=y+a,g.y=v+Math.sqrt(y*y+d*d),g.cy=v,t.circle=g;for(var x=null,m=xi._;m;)if(g.y<m.y||g.y===m.y&&g.x<=m.x){if(!m.L){x=m.P;break}m=m.L}else{if(!m.R){x=m;break}m=m.R}xi.insert(x,g),x||(gi=g)}}}}function Oi(t){var n=t.circle;n&&(n.P||(gi=n.N),xi.remove(n),bi.push(n),Gi(n),t.circle=null)}function Ti(t,n){var e=t.b;if(e)return!0;var r,i,o=t.a,a=n[0][0],s=n[1][0],u=n[0][1],c=n[1][1],l=t.l,f=t.r,h=l.x,p=l.y,y=f.x,d=f.y,v=(h+y)/2,g=(p+d)/2;if(d===p){if(v<a||v>=s)return;if(h>y){if(o){if(o.y>=c)return}else o={x:v,y:u};e={x:v,y:c}}else{if(o){if(o.y<u)return}else o={x:v,y:c};e={x:v,y:u}}}else if(i=g-(r=(h-y)/(d-p))*v,r<-1||r>1)if(h>y){if(o){if(o.y>=c)return}else o={x:(u-i)/r,y:u};e={x:(c-i)/r,y:c}}else{if(o){if(o.y<u)return}else o={x:(c-i)/r,y:c};e={x:(u-i)/r,y:u}}else if(p<d){if(o){if(o.x>=s)return}else o={x:a,y:r*a+i};e={x:s,y:r*s+i}}else{if(o){if(o.x<a)return}else o={x:s,y:r*s+i};e={x:a,y:r*a+i}}return t.a=o,t.b=e,!0}function Ii(t,n){this.l=t,this.r=n,this.a=this.b=null}function Di(t,n,e,r){var i=new Ii(t,n);return yi.push(i),e&&Ri(i,t,n,e),r&&Ri(i,n,t,r),di[t.i].edges.push(new ji(i,t,n)),di[n.i].edges.push(new ji(i,n,t)),i}function zi(t,n,e){var r=new Ii(t,null);return r.a=n,r.b=e,yi.push(r),r}function Ri(t,n,e,r){t.a||t.b?t.l===e?t.b=r:t.a=r:(t.a=r,t.l=n,t.r=e)}function ji(t,n,e){var r=t.a,i=t.b;this.edge=t,this.site=n,this.angle=e?Math.atan2(e.y-n.y,e.x-n.x):t.l===n?Math.atan2(i.x-r.x,r.y-i.y):Math.atan2(r.x-i.x,i.y-r.y)}function qi(){this._=null}function Gi(t){t.U=t.C=t.L=t.R=t.P=t.N=null}function Bi(t,n){var e=n,r=n.R,i=e.U;i?i.L===e?i.L=r:i.R=r:t._=r,r.U=i,e.U=r,e.R=r.L,e.R&&(e.R.U=e),r.L=e}function Vi(t,n){var e=n,r=n.L,i=e.U;i?i.L===e?i.L=r:i.R=r:t._=r,r.U=i,e.U=r,e.L=r.R,e.L&&(e.L.U=e),r.R=e}function Fi(t){for(;t.L;)t=t.L;return t}function Ui(t,n){var e,r,i,o=t.sort(Hi).pop();for(yi=[],di=new Array(t.length),vi=new qi,xi=new qi;;)if(i=gi,o&&(!i||o.y<i.y||o.y===i.y&&o.x<i.x))o.x===e&&o.y===r||(di[o.i]=new Li(o),Mi(o),e=o.x,r=o.y),o=t.pop();else{if(!i)break;Si(i.arc)}n&&(function(t){for(var n,e=yi,r=sr(t[0][0],t[0][1],t[1][0],t[1][1]),i=e.length;i--;)(!Ti(n=e[i],t)||!r(n)||k(n.a.x-n.b.x)<Lt&&k(n.a.y-n.b.y)<Lt)&&(n.a=n.b=null,e.splice(i,1))}(n),function(t){for(var n,e,r,i,o,a,s,u,c,l,f=t[0][0],h=t[1][0],p=t[0][1],y=t[1][1],d=di,v=d.length;v--;)if((o=d[v])&&o.prepare())for(u=(s=o.edges).length,a=0;a<u;)r=(l=s[a].end()).x,i=l.y,n=(c=s[++a%u].start()).x,e=c.y,(k(r-n)>Lt||k(i-e)>Lt)&&(s.splice(a,0,new ji(zi(o.site,l,k(r-f)<Lt&&y-i>Lt?{x:f,y:k(n-f)<Lt?e:y}:k(i-y)<Lt&&h-r>Lt?{x:k(e-y)<Lt?n:h,y:y}:k(r-h)<Lt&&i-p>Lt?{x:h,y:k(n-h)<Lt?e:p}:k(i-p)<Lt&&r-f>Lt?{x:k(e-p)<Lt?n:f,y:p}:null),o.site,null)),++u)}(n));var a={cells:di,edges:yi};return vi=xi=yi=di=null,a}function Hi(t,n){return n.y-t.y||n.x-t.x}Li.prototype.prepare=function(){for(var t,n=this.edges,e=n.length;e--;)(t=n[e].edge).b&&t.a||n.splice(e,1);return n.sort(Pi),n.length},ji.prototype={start:function(){return this.edge.l===this.site?this.edge.a:this.edge.b},end:function(){return this.edge.l===this.site?this.edge.b:this.edge.a}},qi.prototype={insert:function(t,n){var e,r,i;if(t){if(n.P=t,n.N=t.N,t.N&&(t.N.P=n),t.N=n,t.R){for(t=t.R;t.L;)t=t.L;t.L=n}else t.R=n;e=t}else this._?(t=Fi(this._),n.P=null,n.N=t,t.P=t.L=n,e=t):(n.P=n.N=null,this._=n,e=null);for(n.L=n.R=null,n.U=e,n.C=!0,t=n;e&&e.C;)e===(r=e.U).L?(i=r.R)&&i.C?(e.C=i.C=!1,r.C=!0,t=r):(t===e.R&&(Bi(this,e),e=(t=e).U),e.C=!1,r.C=!0,Vi(this,r)):(i=r.L)&&i.C?(e.C=i.C=!1,r.C=!0,t=r):(t===e.L&&(Vi(this,e),e=(t=e).U),e.C=!1,r.C=!0,Bi(this,r)),e=t.U;this._.C=!1},remove:function(t){t.N&&(t.N.P=t.P),t.P&&(t.P.N=t.N),t.N=t.P=null;var n,e,r,i=t.U,o=t.L,a=t.R;if(e=o?a?Fi(a):o:a,i?i.L===t?i.L=e:i.R=e:this._=e,o&&a?(r=e.C,e.C=t.C,e.L=o,o.U=e,e!==a?(i=e.U,e.U=t.U,t=e.R,i.L=t,e.R=a,a.U=e):(e.U=i,i=e,t=e.R)):(r=t.C,t=e),t&&(t.U=i),!r)if(t&&t.C)t.C=!1;else{do{if(t===this._)break;if(t===i.L){if((n=i.R).C&&(n.C=!1,i.C=!0,Bi(this,i),n=i.R),n.L&&n.L.C||n.R&&n.R.C){n.R&&n.R.C||(n.L.C=!1,n.C=!0,Vi(this,n),n=i.R),n.C=i.C,i.C=n.R.C=!1,Bi(this,i),t=this._;break}}else if((n=i.L).C&&(n.C=!1,i.C=!0,Vi(this,i),n=i.L),n.L&&n.L.C||n.R&&n.R.C){n.L&&n.L.C||(n.R.C=!1,n.C=!0,Bi(this,n),n=i.L),n.C=i.C,i.C=n.L.C=!1,Vi(this,i),t=this._;break}n.C=!0,t=i,i=i.U}while(!t.C);t&&(t.C=!1)}}},o.geom.voronoi=function(t){var n=ai,e=si,r=n,i=e,o=Xi;if(t)return a(t);function a(t){var n=new Array(t.length),e=o[0][0],r=o[0][1],i=o[1][0],a=o[1][1];return Ui(s(t),o).cells.forEach((function(o,s){var u=o.edges,c=o.site;(n[s]=u.length?u.map((function(t){var n=t.start();return[n.x,n.y]})):c.x>=e&&c.x<=i&&c.y>=r&&c.y<=a?[[e,a],[i,a],[i,r],[e,r]]:[]).point=t[s]})),n}function s(t){return t.map((function(t,n){return{x:Math.round(r(t,n)/Lt)*Lt,y:Math.round(i(t,n)/Lt)*Lt,i:n}}))}return a.links=function(t){return Ui(s(t)).edges.filter((function(t){return t.l&&t.r})).map((function(n){return{source:t[n.l.i],target:t[n.r.i]}}))},a.triangles=function(t){var n=[];return Ui(s(t)).cells.forEach((function(e,r){for(var i,o,a,s,u=e.site,c=e.edges.sort(Pi),l=-1,f=c.length,h=c[f-1].edge,p=h.l===u?h.r:h.l;++l<f;)h,i=p,p=(h=c[l].edge).l===u?h.r:h.l,r<i.i&&r<p.i&&(a=i,s=p,((o=u).x-s.x)*(a.y-o.y)-(o.x-a.x)*(s.y-o.y)<0)&&n.push([t[r],t[i.i],t[p.i]])})),n},a.x=function(t){return arguments.length?(r=mn(n=t),a):n},a.y=function(t){return arguments.length?(i=mn(e=t),a):e},a.clipExtent=function(t){return arguments.length?(o=null==t?Xi:t,a):o===Xi?null:o},a.size=function(t){return arguments.length?a.clipExtent(t&&[[0,0],t]):o===Xi?null:o&&o[1]},a};var Xi=[[-1e6,-1e6],[1e6,1e6]];function Yi(t){return t.x}function Zi(t){return t.y}function Wi(t,n,e,r,i,o){if(!t(n,e,r,i,o)){var a=.5*(e+i),s=.5*(r+o),u=n.nodes;u[0]&&Wi(t,u[0],e,r,a,s),u[1]&&Wi(t,u[1],a,r,i,s),u[2]&&Wi(t,u[2],e,s,a,o),u[3]&&Wi(t,u[3],a,s,i,o)}}function Ki(t,n,e,r,i,o,a){var s,u=1/0;return function t(c,l,f,h,p){if(!(l>o||f>a||h<r||p<i)){if(y=c.point){var y,d=n-c.x,v=e-c.y,g=d*d+v*v;if(g<u){var x=Math.sqrt(u=g);r=n-x,i=e-x,o=n+x,a=e+x,s=y}}for(var m=c.nodes,b=.5*(l+h),w=.5*(f+p),k=(e>=w)<<1|n>=b,_=k+4;k<_;++k)if(c=m[3&k])switch(3&k){case 0:t(c,l,f,b,w);break;case 1:t(c,b,f,h,w);break;case 2:t(c,l,w,b,p);break;case 3:t(c,b,w,h,p)}}}(t,r,i,o,a),s}function $i(t,n){t=o.rgb(t),n=o.rgb(n);var e=t.r,r=t.g,i=t.b,a=n.r-e,s=n.g-r,u=n.b-i;return function(t){return"#"+hn(Math.round(e+a*t))+hn(Math.round(r+s*t))+hn(Math.round(i+u*t))}}function Ji(t,n){var e,r={},i={};for(e in t)e in n?r[e]=ro(t[e],n[e]):i[e]=t[e];for(e in n)e in t||(i[e]=n[e]);return function(t){for(e in r)i[e]=r[e](t);return i}}function Qi(t,n){return t=+t,n=+n,function(e){return t*(1-e)+n*e}}function to(t,n){var e,r,i,o=no.lastIndex=eo.lastIndex=0,a=-1,s=[],u=[];for(t+="",n+="";(e=no.exec(t))&&(r=eo.exec(n));)(i=r.index)>o&&(i=n.slice(o,i),s[a]?s[a]+=i:s[++a]=i),(e=e[0])===(r=r[0])?s[a]?s[a]+=r:s[++a]=r:(s[++a]=null,u.push({i:a,x:Qi(e,r)})),o=eo.lastIndex;return o<n.length&&(i=n.slice(o),s[a]?s[a]+=i:s[++a]=i),s.length<2?u[0]?(n=u[0].x,function(t){return n(t)+""}):function(){return n}:(n=u.length,function(t){for(var e,r=0;r<n;++r)s[(e=u[r]).i]=e.x(t);return s.join("")})}o.geom.delaunay=function(t){return o.geom.voronoi().triangles(t)},o.geom.quadtree=function(t,n,e,r,i){var o,a=ai,s=si;if(o=arguments.length)return a=Yi,s=Zi,3===o&&(i=e,r=n,e=n=0),u(t);function u(t){var u,c,l,f,h,p,y,d,v,g=mn(a),x=mn(s);if(null!=n)p=n,y=e,d=r,v=i;else if(d=v=-(p=y=1/0),c=[],l=[],h=t.length,o)for(f=0;f<h;++f)(u=t[f]).x<p&&(p=u.x),u.y<y&&(y=u.y),u.x>d&&(d=u.x),u.y>v&&(v=u.y),c.push(u.x),l.push(u.y);else for(f=0;f<h;++f){var m=+g(u=t[f],f),b=+x(u,f);m<p&&(p=m),b<y&&(y=b),m>d&&(d=m),b>v&&(v=b),c.push(m),l.push(b)}var w=d-p,_=v-y;function S(t,n,e,r,i,o,a,s){if(!isNaN(e)&&!isNaN(r))if(t.leaf){var u=t.x,c=t.y;if(null!=u)if(k(u-e)+k(c-r)<.01)M(t,n,e,r,i,o,a,s);else{var l=t.point;t.x=t.y=t.point=null,M(t,l,u,c,i,o,a,s),M(t,n,e,r,i,o,a,s)}else t.x=e,t.y=r,t.point=n}else M(t,n,e,r,i,o,a,s)}function M(t,n,e,r,i,o,a,s){var u=.5*(i+a),c=.5*(o+s),l=e>=u,f=r>=c,h=f<<1|l;t.leaf=!1,l?i=u:a=u,f?o=c:s=c,S(t=t.nodes[h]||(t.nodes[h]={leaf:!0,nodes:[],point:null,x:null,y:null}),n,e,r,i,o,a,s)}w>_?v=y+w:d=p+_;var E={leaf:!0,nodes:[],point:null,x:null,y:null,add:function(t){S(E,t,+g(t,++f),+x(t,f),p,y,d,v)},visit:function(t){Wi(t,E,p,y,d,v)},find:function(t){return Ki(E,t[0],t[1],p,y,d,v)}};if(f=-1,null==n){for(;++f<h;)S(E,t[f],c[f],l[f],p,y,d,v);--f}else t.forEach(E.add);return c=l=t=u=null,E}return u.x=function(t){return arguments.length?(a=t,u):a},u.y=function(t){return arguments.length?(s=t,u):s},u.extent=function(t){return arguments.length?(null==t?n=e=r=i=null:(n=+t[0][0],e=+t[0][1],r=+t[1][0],i=+t[1][1]),u):null==n?null:[[n,e],[r,i]]},u.size=function(t){return arguments.length?(null==t?n=e=r=i=null:(n=e=0,r=+t[0],i=+t[1]),u):null==n?null:[r-n,i-e]},u},o.interpolateRgb=$i,o.interpolateObject=Ji,o.interpolateNumber=Qi,o.interpolateString=to;var no=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,eo=new RegExp(no.source,"g");function ro(t,n){for(var e,r=o.interpolators.length;--r>=0&&!(e=o.interpolators[r](t,n)););return e}function io(t,n){var e,r=[],i=[],o=t.length,a=n.length,s=Math.min(t.length,n.length);for(e=0;e<s;++e)r.push(ro(t[e],n[e]));for(;e<o;++e)i[e]=t[e];for(;e<a;++e)i[e]=n[e];return function(t){for(e=0;e<s;++e)i[e]=r[e](t);return i}}o.interpolate=ro,o.interpolators=[function(t,n){var e=typeof n;return("string"===e?xn.has(n.toLowerCase())||/^(#|rgb\(|hsl\()/i.test(n)?$i:to:n instanceof Xt?$i:Array.isArray(n)?io:"object"===e&&isNaN(n)?Ji:Qi)(t,n)}],o.interpolateArray=io;var oo=function(){return I},ao=o.map({linear:oo,poly:function(t){return function(n){return Math.pow(n,t)}},quad:function(){return fo},cubic:function(){return ho},sin:function(){return yo},exp:function(){return vo},circle:function(){return go},elastic:function(t,n){var e;arguments.length<2&&(n=.45);arguments.length?e=n/Ct*Math.asin(1/t):(t=1,e=n/4);return function(r){return 1+t*Math.pow(2,-10*r)*Math.sin((r-e)*Ct/n)}},back:function(t){t||(t=1.70158);return function(n){return n*n*((t+1)*n-t)}},bounce:function(){return xo}}),so=o.map({in:I,out:co,"in-out":lo,"out-in":function(t){return lo(co(t))}});function uo(t){return function(n){return n<=0?0:n>=1?1:t(n)}}function co(t){return function(n){return 1-t(1-n)}}function lo(t){return function(n){return.5*(n<.5?t(2*n):2-t(2-2*n))}}function fo(t){return t*t}function ho(t){return t*t*t}function po(t){if(t<=0)return 0;if(t>=1)return 1;var n=t*t,e=n*t;return 4*(t<.5?e:3*(t-n)+e-.75)}function yo(t){return 1-Math.cos(t*Tt)}function vo(t){return Math.pow(2,10*(t-1))}function go(t){return 1-Math.sqrt(1-t*t)}function xo(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375}function mo(t,n){return n-=t,function(e){return Math.round(t+n*e)}}function bo(t){var n,e,r,i=[t.a,t.b],o=[t.c,t.d],a=ko(i),s=wo(i,o),u=ko(((n=o)[0]+=(r=-s)*(e=i)[0],n[1]+=r*e[1],n))||0;i[0]*o[1]<o[0]*i[1]&&(i[0]*=-1,i[1]*=-1,a*=-1,s*=-1),this.rotate=(a?Math.atan2(i[1],i[0]):Math.atan2(-o[0],o[1]))*Dt,this.translate=[t.e,t.f],this.scale=[a,u],this.skew=u?Math.atan2(s,u)*Dt:0}function wo(t,n){return t[0]*n[0]+t[1]*n[1]}function ko(t){var n=Math.sqrt(wo(t,t));return n&&(t[0]/=n,t[1]/=n),n}o.ease=function(t){var n=t.indexOf("-"),e=n>=0?t.slice(0,n):t,r=n>=0?t.slice(n+1):"in";return e=ao.get(e)||oo,uo((r=so.get(r)||I)(e.apply(null,a.call(arguments,1))))},o.interpolateHcl=function(t,n){t=o.hcl(t),n=o.hcl(n);var e=t.h,r=t.c,i=t.l,a=n.h-e,s=n.c-r,u=n.l-i;isNaN(s)&&(s=0,r=isNaN(r)?n.c:r);isNaN(a)?(a=0,e=isNaN(e)?n.h:e):a>180?a-=360:a<-180&&(a+=360);return function(t){return Jt(e+a*t,r+s*t,i+u*t)+""}},o.interpolateHsl=function(t,n){t=o.hsl(t),n=o.hsl(n);var e=t.h,r=t.s,i=t.l,a=n.h-e,s=n.s-r,u=n.l-i;isNaN(s)&&(s=0,r=isNaN(r)?n.s:r);isNaN(a)?(a=0,e=isNaN(e)?n.h:e):a>180?a-=360:a<-180&&(a+=360);return function(t){return Wt(e+a*t,r+s*t,i+u*t)+""}},o.interpolateLab=function(t,n){t=o.lab(t),n=o.lab(n);var e=t.l,r=t.a,i=t.b,a=n.l-e,s=n.a-r,u=n.b-i;return function(t){return en(e+a*t,r+s*t,i+u*t)+""}},o.interpolateRound=mo,o.transform=function(t){var n=u.createElementNS(o.ns.prefix.svg,"g");return(o.transform=function(t){if(null!=t){n.setAttribute("transform",t);var e=n.transform.baseVal.consolidate()}return new bo(e?e.matrix:_o)})(t)},bo.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var _o={a:1,b:0,c:0,d:1,e:0,f:0};function So(t){return t.length?t.pop()+",":""}function Mo(t,n){var e=[],r=[];return t=o.transform(t),n=o.transform(n),function(t,n,e,r){if(t[0]!==n[0]||t[1]!==n[1]){var i=e.push("translate(",null,",",null,")");r.push({i:i-4,x:Qi(t[0],n[0])},{i:i-2,x:Qi(t[1],n[1])})}else(n[0]||n[1])&&e.push("translate("+n+")")}(t.translate,n.translate,e,r),function(t,n,e,r){t!==n?(t-n>180?n+=360:n-t>180&&(t+=360),r.push({i:e.push(So(e)+"rotate(",null,")")-2,x:Qi(t,n)})):n&&e.push(So(e)+"rotate("+n+")")}(t.rotate,n.rotate,e,r),function(t,n,e,r){t!==n?r.push({i:e.push(So(e)+"skewX(",null,")")-2,x:Qi(t,n)}):n&&e.push(So(e)+"skewX("+n+")")}(t.skew,n.skew,e,r),function(t,n,e,r){if(t[0]!==n[0]||t[1]!==n[1]){var i=e.push(So(e)+"scale(",null,",",null,")");r.push({i:i-4,x:Qi(t[0],n[0])},{i:i-2,x:Qi(t[1],n[1])})}else 1===n[0]&&1===n[1]||e.push(So(e)+"scale("+n+")")}(t.scale,n.scale,e,r),t=n=null,function(t){for(var n,i=-1,o=r.length;++i<o;)e[(n=r[i]).i]=n.x(t);return e.join("")}}function Eo(t,n){return n=(n-=t=+t)||1/n,function(e){return(e-t)/n}}function Ao(t,n){return n=(n-=t=+t)||1/n,function(e){return Math.max(0,Math.min(1,(e-t)/n))}}function Lo(t){for(var n=t.source,e=t.target,r=function(t,n){if(t===n)return t;var e=Po(t),r=Po(n),i=e.pop(),o=r.pop(),a=null;for(;i===o;)a=i,i=e.pop(),o=r.pop();return a}(n,e),i=[n];n!==r;)n=n.parent,i.push(n);for(var o=i.length;e!==r;)i.splice(o,0,e),e=e.parent;return i}function Po(t){for(var n=[],e=t.parent;null!=e;)n.push(t),t=e,e=e.parent;return n.push(t),n}function No(t){t.fixed|=2}function Co(t){t.fixed&=-7}function Oo(t){t.fixed|=4,t.px=t.x,t.py=t.y}function To(t){t.fixed&=-5}o.interpolateTransform=Mo,o.layout={},o.layout.bundle=function(){return function(t){for(var n=[],e=-1,r=t.length;++e<r;)n.push(Lo(t[e]));return n}},o.layout.chord=function(){var t,n,e,r,i,a,s,u={},c=0;function l(){var u,l,h,p,y,d={},v=[],g=o.range(r),x=[];for(t=[],n=[],u=0,p=-1;++p<r;){for(l=0,y=-1;++y<r;)l+=e[p][y];v.push(l),x.push(o.range(r)),u+=l}for(i&&g.sort((function(t,n){return i(v[t],v[n])})),a&&x.forEach((function(t,n){t.sort((function(t,r){return a(e[n][t],e[n][r])}))})),u=(Ct-c*r)/u,l=0,p=-1;++p<r;){for(h=l,y=-1;++y<r;){var m=g[p],b=x[m][y],w=e[m][b],k=l,_=l+=w*u;d[m+"-"+b]={index:m,subindex:b,startAngle:k,endAngle:_,value:w}}n[m]={index:m,startAngle:h,endAngle:l,value:v[m]},l+=c}for(p=-1;++p<r;)for(y=p-1;++y<r;){var S=d[p+"-"+y],M=d[y+"-"+p];(S.value||M.value)&&t.push(S.value<M.value?{source:M,target:S}:{source:S,target:M})}s&&f()}function f(){t.sort((function(t,n){return s((t.source.value+t.target.value)/2,(n.source.value+n.target.value)/2)}))}return u.matrix=function(i){return arguments.length?(r=(e=i)&&e.length,t=n=null,u):e},u.padding=function(e){return arguments.length?(c=e,t=n=null,u):c},u.sortGroups=function(e){return arguments.length?(i=e,t=n=null,u):i},u.sortSubgroups=function(n){return arguments.length?(a=n,t=null,u):a},u.sortChords=function(n){return arguments.length?(s=n,t&&f(),u):s},u.chords=function(){return t||l(),t},u.groups=function(){return n||l(),n},u},o.layout.force=function(){var t,n,e,r,i,a,s={},u=o.dispatch("start","tick","end"),c=[1,1],l=.9,f=Io,h=Do,p=-30,y=zo,d=.1,v=.64,g=[],x=[];function m(t){return function(n,e,r,i){if(n.point!==t){var o=n.cx-t.x,a=n.cy-t.y,s=i-e,u=o*o+a*a;if(s*s/v<u){if(u<y){var c=n.charge/u;t.px-=o*c,t.py-=a*c}return!0}if(n.point&&u&&u<y){c=n.pointCharge/u;t.px-=o*c,t.py-=a*c}}return!n.charge}}function b(t){t.px=o.event.x,t.py=o.event.y,s.resume()}return s.tick=function(){if((e*=.99)<.005)return t=null,u.end({type:"end",alpha:e=0}),!0;var n,s,f,h,y,v,b,w,k,_=g.length,S=x.length;for(s=0;s<S;++s)h=(f=x[s]).source,(v=(w=(y=f.target).x-h.x)*w+(k=y.y-h.y)*k)&&(w*=v=e*i[s]*((v=Math.sqrt(v))-r[s])/v,k*=v,y.x-=w*(b=h.weight+y.weight?h.weight/(h.weight+y.weight):.5),y.y-=k*b,h.x+=w*(b=1-b),h.y+=k*b);if((b=e*d)&&(w=c[0]/2,k=c[1]/2,s=-1,b))for(;++s<_;)(f=g[s]).x+=(w-f.x)*b,f.y+=(k-f.y)*b;if(p)for(!function t(n,e,r){var i=0,o=0;if(n.charge=0,!n.leaf)for(var a,s=n.nodes,u=s.length,c=-1;++c<u;)null!=(a=s[c])&&(t(a,e,r),n.charge+=a.charge,i+=a.charge*a.cx,o+=a.charge*a.cy);if(n.point){n.leaf||(n.point.x+=Math.random()-.5,n.point.y+=Math.random()-.5);var l=e*r[n.point.index];n.charge+=n.pointCharge=l,i+=l*n.point.x,o+=l*n.point.y}n.cx=i/n.charge,n.cy=o/n.charge}(n=o.geom.quadtree(g),e,a),s=-1;++s<_;)(f=g[s]).fixed||n.visit(m(f));for(s=-1;++s<_;)(f=g[s]).fixed?(f.x=f.px,f.y=f.py):(f.x-=(f.px-(f.px=f.x))*l,f.y-=(f.py-(f.py=f.y))*l);u.tick({type:"tick",alpha:e})},s.nodes=function(t){return arguments.length?(g=t,s):g},s.links=function(t){return arguments.length?(x=t,s):x},s.size=function(t){return arguments.length?(c=t,s):c},s.linkDistance=function(t){return arguments.length?(f="function"==typeof t?t:+t,s):f},s.distance=s.linkDistance,s.linkStrength=function(t){return arguments.length?(h="function"==typeof t?t:+t,s):h},s.friction=function(t){return arguments.length?(l=+t,s):l},s.charge=function(t){return arguments.length?(p="function"==typeof t?t:+t,s):p},s.chargeDistance=function(t){return arguments.length?(y=t*t,s):Math.sqrt(y)},s.gravity=function(t){return arguments.length?(d=+t,s):d},s.theta=function(t){return arguments.length?(v=t*t,s):Math.sqrt(v)},s.alpha=function(n){return arguments.length?(n=+n,e?n>0?e=n:(t.c=null,t.t=NaN,t=null,u.end({type:"end",alpha:e=0})):n>0&&(u.start({type:"start",alpha:e=n}),t=An(s.tick)),s):e},s.start=function(){var t,n,e,o=g.length,u=x.length,l=c[0],y=c[1];for(t=0;t<o;++t)(e=g[t]).index=t,e.weight=0;for(t=0;t<u;++t)"number"==typeof(e=x[t]).source&&(e.source=g[e.source]),"number"==typeof e.target&&(e.target=g[e.target]),++e.source.weight,++e.target.weight;for(t=0;t<o;++t)e=g[t],isNaN(e.x)&&(e.x=d("x",l)),isNaN(e.y)&&(e.y=d("y",y)),isNaN(e.px)&&(e.px=e.x),isNaN(e.py)&&(e.py=e.y);if(r=[],"function"==typeof f)for(t=0;t<u;++t)r[t]=+f.call(this,x[t],t);else for(t=0;t<u;++t)r[t]=f;if(i=[],"function"==typeof h)for(t=0;t<u;++t)i[t]=+h.call(this,x[t],t);else for(t=0;t<u;++t)i[t]=h;if(a=[],"function"==typeof p)for(t=0;t<o;++t)a[t]=+p.call(this,g[t],t);else for(t=0;t<o;++t)a[t]=p;function d(e,r){if(!n){for(n=new Array(o),c=0;c<o;++c)n[c]=[];for(c=0;c<u;++c){var i=x[c];n[i.source.index].push(i.target),n[i.target.index].push(i.source)}}for(var a,s=n[t],c=-1,l=s.length;++c<l;)if(!isNaN(a=s[c][e]))return a;return Math.random()*r}return s.resume()},s.resume=function(){return s.alpha(.1)},s.stop=function(){return s.alpha(0)},s.drag=function(){if(n||(n=o.behavior.drag().origin(I).on("dragstart.force",No).on("drag.force",b).on("dragend.force",Co)),!arguments.length)return n;this.on("mouseover.force",Oo).on("mouseout.force",To).call(n)},o.rebind(s,u,"on")};var Io=20,Do=1,zo=1/0;function Ro(t,n){return o.rebind(t,n,"sort","children","value"),t.nodes=t,t.links=Fo,t}function jo(t,n){for(var e=[t];null!=(t=e.pop());)if(n(t),(i=t.children)&&(r=i.length))for(var r,i;--r>=0;)e.push(i[r])}function qo(t,n){for(var e=[t],r=[];null!=(t=e.pop());)if(r.push(t),(o=t.children)&&(i=o.length))for(var i,o,a=-1;++a<i;)e.push(o[a]);for(;null!=(t=r.pop());)n(t)}function Go(t){return t.children}function Bo(t){return t.value}function Vo(t,n){return n.value-t.value}function Fo(t){return o.merge(t.map((function(t){return(t.children||[]).map((function(n){return{source:t,target:n}}))})))}o.layout.hierarchy=function(){var t=Vo,n=Go,e=Bo;function r(i){var o,a=[i],s=[];for(i.depth=0;null!=(o=a.pop());)if(s.push(o),(c=n.call(r,o,o.depth))&&(u=c.length)){for(var u,c,l;--u>=0;)a.push(l=c[u]),l.parent=o,l.depth=o.depth+1;e&&(o.value=0),o.children=c}else e&&(o.value=+e.call(r,o,o.depth)||0),delete o.children;return qo(i,(function(n){var r,i;t&&(r=n.children)&&r.sort(t),e&&(i=n.parent)&&(i.value+=n.value)})),s}return r.sort=function(n){return arguments.length?(t=n,r):t},r.children=function(t){return arguments.length?(n=t,r):n},r.value=function(t){return arguments.length?(e=t,r):e},r.revalue=function(t){return e&&(jo(t,(function(t){t.children&&(t.value=0)})),qo(t,(function(t){var n;t.children||(t.value=+e.call(r,t,t.depth)||0),(n=t.parent)&&(n.value+=t.value)}))),t},r},o.layout.partition=function(){var t=o.layout.hierarchy(),n=[1,1];function e(e,r){var i=t.call(this,e,r);return function t(n,e,r,i){var o=n.children;if(n.x=e,n.y=n.depth*i,n.dx=r,n.dy=i,o&&(a=o.length)){var a,s,u,c=-1;for(r=n.value?r/n.value:0;++c<a;)t(s=o[c],e,u=s.value*r,i),e+=u}}(i[0],0,n[0],n[1]/function t(n){var e=n.children,r=0;if(e&&(i=e.length))for(var i,o=-1;++o<i;)r=Math.max(r,t(e[o]));return 1+r}(i[0])),i}return e.size=function(t){return arguments.length?(n=t,e):n},Ro(e,t)},o.layout.pie=function(){var t=Number,n=Uo,e=0,r=Ct,i=0;function a(s){var u,c=s.length,l=s.map((function(n,e){return+t.call(a,n,e)})),f=+("function"==typeof e?e.apply(this,arguments):e),h=("function"==typeof r?r.apply(this,arguments):r)-f,p=Math.min(Math.abs(h)/c,+("function"==typeof i?i.apply(this,arguments):i)),y=p*(h<0?-1:1),d=o.sum(l),v=d?(h-c*y)/d:0,g=o.range(c),x=[];return null!=n&&g.sort(n===Uo?function(t,n){return l[n]-l[t]}:function(t,e){return n(s[t],s[e])}),g.forEach((function(t){x[t]={data:s[t],value:u=l[t],startAngle:f,endAngle:f+=u*v+y,padAngle:p}})),x}return a.value=function(n){return arguments.length?(t=n,a):t},a.sort=function(t){return arguments.length?(n=t,a):n},a.startAngle=function(t){return arguments.length?(e=t,a):e},a.endAngle=function(t){return arguments.length?(r=t,a):r},a.padAngle=function(t){return arguments.length?(i=t,a):i},a};var Uo={};function Ho(t){return t.x}function Xo(t){return t.y}function Yo(t,n,e){t.y0=n,t.y=e}o.layout.stack=function(){var t=I,n=Ko,e=$o,r=Yo,i=Ho,a=Xo;function s(u,c){if(!(p=u.length))return u;var l=u.map((function(n,e){return t.call(s,n,e)})),f=l.map((function(t){return t.map((function(t,n){return[i.call(s,t,n),a.call(s,t,n)]}))})),h=n.call(s,f,c);l=o.permute(l,h),f=o.permute(f,h);var p,y,d,v,g=e.call(s,f,c),x=l[0].length;for(d=0;d<x;++d)for(r.call(s,l[0][d],v=g[d],f[0][d][1]),y=1;y<p;++y)r.call(s,l[y][d],v+=f[y-1][d][1],f[y][d][1]);return u}return s.values=function(n){return arguments.length?(t=n,s):t},s.order=function(t){return arguments.length?(n="function"==typeof t?t:Zo.get(t)||Ko,s):n},s.offset=function(t){return arguments.length?(e="function"==typeof t?t:Wo.get(t)||$o,s):e},s.x=function(t){return arguments.length?(i=t,s):i},s.y=function(t){return arguments.length?(a=t,s):a},s.out=function(t){return arguments.length?(r=t,s):r},s};var Zo=o.map({"inside-out":function(t){var n,e,r=t.length,i=t.map(Jo),a=t.map(Qo),s=o.range(r).sort((function(t,n){return i[t]-i[n]})),u=0,c=0,l=[],f=[];for(n=0;n<r;++n)e=s[n],u<c?(u+=a[e],l.push(e)):(c+=a[e],f.push(e));return f.reverse().concat(l)},reverse:function(t){return o.range(t.length).reverse()},default:Ko}),Wo=o.map({silhouette:function(t){var n,e,r,i=t.length,o=t[0].length,a=[],s=0,u=[];for(e=0;e<o;++e){for(n=0,r=0;n<i;n++)r+=t[n][e][1];r>s&&(s=r),a.push(r)}for(e=0;e<o;++e)u[e]=(s-a[e])/2;return u},wiggle:function(t){var n,e,r,i,o,a,s,u,c,l=t.length,f=t[0],h=f.length,p=[];for(p[0]=u=c=0,e=1;e<h;++e){for(n=0,i=0;n<l;++n)i+=t[n][e][1];for(n=0,o=0,s=f[e][0]-f[e-1][0];n<l;++n){for(r=0,a=(t[n][e][1]-t[n][e-1][1])/(2*s);r<n;++r)a+=(t[r][e][1]-t[r][e-1][1])/s;o+=a*t[n][e][1]}p[e]=u-=i?o/i*s:0,u<c&&(c=u)}for(e=0;e<h;++e)p[e]-=c;return p},expand:function(t){var n,e,r,i=t.length,o=t[0].length,a=1/i,s=[];for(e=0;e<o;++e){for(n=0,r=0;n<i;n++)r+=t[n][e][1];if(r)for(n=0;n<i;n++)t[n][e][1]/=r;else for(n=0;n<i;n++)t[n][e][1]=a}for(e=0;e<o;++e)s[e]=0;return s},zero:$o});function Ko(t){return o.range(t.length)}function $o(t){for(var n=-1,e=t[0].length,r=[];++n<e;)r[n]=0;return r}function Jo(t){for(var n,e=1,r=0,i=t[0][1],o=t.length;e<o;++e)(n=t[e][1])>i&&(r=e,i=n);return r}function Qo(t){return t.reduce(ta,0)}function ta(t,n){return t+n[1]}function na(t,n){return ea(t,Math.ceil(Math.log(n.length)/Math.LN2+1))}function ea(t,n){for(var e=-1,r=+t[0],i=(t[1]-r)/n,o=[];++e<=n;)o[e]=i*e+r;return o}function ra(t){return[o.min(t),o.max(t)]}function ia(t,n){return t.value-n.value}function oa(t,n){var e=t._pack_next;t._pack_next=n,n._pack_prev=t,n._pack_next=e,e._pack_prev=n}function aa(t,n){t._pack_next=n,n._pack_prev=t}function sa(t,n){var e=n.x-t.x,r=n.y-t.y,i=t.r+n.r;return.999*i*i>e*e+r*r}function ua(t){if((n=t.children)&&(u=n.length)){var n,e,r,i,o,a,s,u,c=1/0,l=-1/0,f=1/0,h=-1/0;if(n.forEach(ca),(e=n[0]).x=-e.r,e.y=0,m(e),u>1&&((r=n[1]).x=r.r,r.y=0,m(r),u>2))for(fa(e,r,i=n[2]),m(i),oa(e,i),e._pack_prev=i,oa(i,r),r=e._pack_next,o=3;o<u;o++){fa(e,r,i=n[o]);var p=0,y=1,d=1;for(a=r._pack_next;a!==r;a=a._pack_next,y++)if(sa(a,i)){p=1;break}if(1==p)for(s=e._pack_prev;s!==a._pack_prev&&!sa(s,i);s=s._pack_prev,d++);p?(y<d||y==d&&r.r<e.r?aa(e,r=a):aa(e=s,r),o--):(oa(e,i),r=i,m(i))}var v=(c+l)/2,g=(f+h)/2,x=0;for(o=0;o<u;o++)(i=n[o]).x-=v,i.y-=g,x=Math.max(x,i.r+Math.sqrt(i.x*i.x+i.y*i.y));t.r=x,n.forEach(la)}function m(t){c=Math.min(t.x-t.r,c),l=Math.max(t.x+t.r,l),f=Math.min(t.y-t.r,f),h=Math.max(t.y+t.r,h)}}function ca(t){t._pack_next=t._pack_prev=t}function la(t){delete t._pack_next,delete t._pack_prev}function fa(t,n,e){var r=t.r+e.r,i=n.x-t.x,o=n.y-t.y;if(r&&(i||o)){var a=n.r+e.r,s=i*i+o*o,u=.5+((r*=r)-(a*=a))/(2*s),c=Math.sqrt(Math.max(0,2*a*(r+s)-(r-=s)*r-a*a))/(2*s);e.x=t.x+u*i+c*o,e.y=t.y+u*o-c*i}else e.x=t.x+r,e.y=t.y}function ha(t,n){return t.parent==n.parent?1:2}function pa(t){var n=t.children;return n.length?n[0]:t.t}function ya(t){var n,e=t.children;return(n=e.length)?e[n-1]:t.t}function da(t,n,e){var r=e/(n.i-t.i);n.c-=r,n.s+=e,t.c+=r,n.z+=e,n.m+=e}function va(t,n,e){return t.a.parent===n.parent?t.a:e}function ga(t){return{x:t.x,y:t.y,dx:t.dx,dy:t.dy}}function xa(t,n){var e=t.x+n[3],r=t.y+n[0],i=t.dx-n[1]-n[3],o=t.dy-n[0]-n[2];return i<0&&(e+=i/2,i=0),o<0&&(r+=o/2,o=0),{x:e,y:r,dx:i,dy:o}}function ma(t){var n=t[0],e=t[t.length-1];return n<e?[n,e]:[e,n]}function ba(t){return t.rangeExtent?t.rangeExtent():ma(t.range())}function wa(t,n,e,r){var i=e(t[0],t[1]),o=r(n[0],n[1]);return function(t){return o(i(t))}}function ka(t,n){var e,r=0,i=t.length-1,o=t[r],a=t[i];return a<o&&(e=r,r=i,i=e,e=o,o=a,a=e),t[r]=n.floor(o),t[i]=n.ceil(a),t}function _a(t){return t?{floor:function(n){return Math.floor(n/t)*t},ceil:function(n){return Math.ceil(n/t)*t}}:Sa}o.layout.histogram=function(){var t=!0,n=Number,e=ra,r=na;function i(i,a){for(var s,u,c=[],l=i.map(n,this),f=e.call(this,l,a),h=r.call(this,f,l,a),p=(a=-1,l.length),y=h.length-1,d=t?1:1/p;++a<y;)(s=c[a]=[]).dx=h[a+1]-(s.x=h[a]),s.y=0;if(y>0)for(a=-1;++a<p;)(u=l[a])>=f[0]&&u<=f[1]&&((s=c[o.bisect(h,u,1,y)-1]).y+=d,s.push(i[a]));return c}return i.value=function(t){return arguments.length?(n=t,i):n},i.range=function(t){return arguments.length?(e=mn(t),i):e},i.bins=function(t){return arguments.length?(r="number"==typeof t?function(n){return ea(n,t)}:mn(t),i):r},i.frequency=function(n){return arguments.length?(t=!!n,i):t},i},o.layout.pack=function(){var t,n=o.layout.hierarchy().sort(ia),e=0,r=[1,1];function i(i,o){var a=n.call(this,i,o),s=a[0],u=r[0],c=r[1],l=null==t?Math.sqrt:"function"==typeof t?t:function(){return t};if(s.x=s.y=0,qo(s,(function(t){t.r=+l(t.value)})),qo(s,ua),e){var f=e*(t?1:Math.max(2*s.r/u,2*s.r/c))/2;qo(s,(function(t){t.r+=f})),qo(s,ua),qo(s,(function(t){t.r-=f}))}return function t(n,e,r,i){var o=n.children;if(n.x=e+=i*n.x,n.y=r+=i*n.y,n.r*=i,o)for(var a=-1,s=o.length;++a<s;)t(o[a],e,r,i)}(s,u/2,c/2,t?1:1/Math.max(2*s.r/u,2*s.r/c)),a}return i.size=function(t){return arguments.length?(r=t,i):r},i.radius=function(n){return arguments.length?(t=null==n||"function"==typeof n?n:+n,i):t},i.padding=function(t){return arguments.length?(e=+t,i):e},Ro(i,n)},o.layout.tree=function(){var t=o.layout.hierarchy().sort(null).value(null),n=ha,e=[1,1],r=null;function i(i,o){var c=t.call(this,i,o),l=c[0],f=function(t){var n,e={A:null,children:[t]},r=[e];for(;null!=(n=r.pop());)for(var i,o=n.children,a=0,s=o.length;a<s;++a)r.push((o[a]=i={_:o[a],parent:n,children:(i=o[a].children)&&i.slice()||[],A:null,a:null,z:0,m:0,c:0,s:0,t:null,i:a}).a=i);return e.children[0]}(l);if(qo(f,a),f.parent.m=-f.z,jo(f,s),r)jo(l,u);else{var h=l,p=l,y=l;jo(l,(function(t){t.x<h.x&&(h=t),t.x>p.x&&(p=t),t.depth>y.depth&&(y=t)}));var d=n(h,p)/2-h.x,v=e[0]/(p.x+n(p,h)/2+d),g=e[1]/(y.depth||1);jo(l,(function(t){t.x=(t.x+d)*v,t.y=t.depth*g}))}return c}function a(t){var e=t.children,r=t.parent.children,i=t.i?r[t.i-1]:null;if(e.length){!function(t){var n,e=0,r=0,i=t.children,o=i.length;for(;--o>=0;)(n=i[o]).z+=e,n.m+=e,e+=n.s+(r+=n.c)}(t);var o=(e[0].z+e[e.length-1].z)/2;i?(t.z=i.z+n(t._,i._),t.m=t.z-o):t.z=o}else i&&(t.z=i.z+n(t._,i._));t.parent.A=function(t,e,r){if(e){for(var i,o=t,a=t,s=e,u=o.parent.children[0],c=o.m,l=a.m,f=s.m,h=u.m;s=ya(s),o=pa(o),s&&o;)u=pa(u),(a=ya(a)).a=t,(i=s.z+f-o.z-c+n(s._,o._))>0&&(da(va(s,t,r),t,i),c+=i,l+=i),f+=s.m,c+=o.m,h+=u.m,l+=a.m;s&&!ya(a)&&(a.t=s,a.m+=f-l),o&&!pa(u)&&(u.t=o,u.m+=c-h,r=t)}return r}(t,i,t.parent.A||r[0])}function s(t){t._.x=t.z+t.parent.m,t.m+=t.parent.m}function u(t){t.x*=e[0],t.y=t.depth*e[1]}return i.separation=function(t){return arguments.length?(n=t,i):n},i.size=function(t){return arguments.length?(r=null==(e=t)?u:null,i):r?null:e},i.nodeSize=function(t){return arguments.length?(r=null==(e=t)?null:u,i):r?e:null},Ro(i,t)},o.layout.cluster=function(){var t=o.layout.hierarchy().sort(null).value(null),n=ha,e=[1,1],r=!1;function i(i,a){var s,u=t.call(this,i,a),c=u[0],l=0;qo(c,(function(t){var e=t.children;e&&e.length?(t.x=function(t){return t.reduce((function(t,n){return t+n.x}),0)/t.length}(e),t.y=function(t){return 1+o.max(t,(function(t){return t.y}))}(e)):(t.x=s?l+=n(t,s):0,t.y=0,s=t)}));var f=function t(n){var e=n.children;return e&&e.length?t(e[0]):n}(c),h=function t(n){var e,r=n.children;return r&&(e=r.length)?t(r[e-1]):n}(c),p=f.x-n(f,h)/2,y=h.x+n(h,f)/2;return qo(c,r?function(t){t.x=(t.x-c.x)*e[0],t.y=(c.y-t.y)*e[1]}:function(t){t.x=(t.x-p)/(y-p)*e[0],t.y=(1-(c.y?t.y/c.y:1))*e[1]}),u}return i.separation=function(t){return arguments.length?(n=t,i):n},i.size=function(t){return arguments.length?(r=null==(e=t),i):r?null:e},i.nodeSize=function(t){return arguments.length?(r=null!=(e=t),i):r?e:null},Ro(i,t)},o.layout.treemap=function(){var t,n=o.layout.hierarchy(),e=Math.round,r=[1,1],i=null,a=ga,s=!1,u="squarify",c=.5*(1+Math.sqrt(5));function l(t,n){for(var e,r,i=-1,o=t.length;++i<o;)r=(e=t[i]).value*(n<0?0:n),e.area=isNaN(r)||r<=0?0:r}function f(t){var n=t.children;if(n&&n.length){var e,r,i,o=a(t),s=[],c=n.slice(),h=1/0,d="slice"===u?o.dx:"dice"===u?o.dy:"slice-dice"===u?1&t.depth?o.dy:o.dx:Math.min(o.dx,o.dy);for(l(c,o.dx*o.dy/t.value),s.area=0;(i=c.length)>0;)s.push(e=c[i-1]),s.area+=e.area,"squarify"!==u||(r=p(s,d))<=h?(c.pop(),h=r):(s.area-=s.pop().area,y(s,d,o,!1),d=Math.min(o.dx,o.dy),s.length=s.area=0,h=1/0);s.length&&(y(s,d,o,!0),s.length=s.area=0),n.forEach(f)}}function h(t){var n=t.children;if(n&&n.length){var e,r=a(t),i=n.slice(),o=[];for(l(i,r.dx*r.dy/t.value),o.area=0;e=i.pop();)o.push(e),o.area+=e.area,null!=e.z&&(y(o,e.z?r.dx:r.dy,r,!i.length),o.length=o.area=0);n.forEach(h)}}function p(t,n){for(var e,r=t.area,i=0,o=1/0,a=-1,s=t.length;++a<s;)(e=t[a].area)&&(e<o&&(o=e),e>i&&(i=e));return n*=n,(r*=r)?Math.max(n*i*c/r,r/(n*o*c)):1/0}function y(t,n,r,i){var o,a=-1,s=t.length,u=r.x,c=r.y,l=n?e(t.area/n):0;if(n==r.dx){for((i||l>r.dy)&&(l=r.dy);++a<s;)(o=t[a]).x=u,o.y=c,o.dy=l,u+=o.dx=Math.min(r.x+r.dx-u,l?e(o.area/l):0);o.z=!0,o.dx+=r.x+r.dx-u,r.y+=l,r.dy-=l}else{for((i||l>r.dx)&&(l=r.dx);++a<s;)(o=t[a]).x=u,o.y=c,o.dx=l,c+=o.dy=Math.min(r.y+r.dy-c,l?e(o.area/l):0);o.z=!1,o.dy+=r.y+r.dy-c,r.x+=l,r.dx-=l}}function d(e){var i=t||n(e),o=i[0];return o.x=o.y=0,o.value?(o.dx=r[0],o.dy=r[1]):o.dx=o.dy=0,t&&n.revalue(o),l([o],o.dx*o.dy/o.value),(t?h:f)(o),s&&(t=i),i}return d.size=function(t){return arguments.length?(r=t,d):r},d.padding=function(t){if(!arguments.length)return i;function n(n){var e=t.call(d,n,n.depth);return null==e?ga(n):xa(n,"number"==typeof e?[e,e,e,e]:e)}function e(n){return xa(n,t)}var r;return a=null==(i=t)?ga:"function"==(r=typeof t)?n:"number"===r?(t=[t,t,t,t],e):e,d},d.round=function(t){return arguments.length?(e=t?Math.round:Number,d):e!=Number},d.sticky=function(n){return arguments.length?(s=n,t=null,d):s},d.ratio=function(t){return arguments.length?(c=t,d):c},d.mode=function(t){return arguments.length?(u=t+"",d):u},Ro(d,n)},o.random={normal:function(t,n){var e=arguments.length;return e<2&&(n=1),e<1&&(t=0),function(){var e,r,i;do{i=(e=2*Math.random()-1)*e+(r=2*Math.random()-1)*r}while(!i||i>1);return t+n*e*Math.sqrt(-2*Math.log(i)/i)}},logNormal:function(){var t=o.random.normal.apply(o,arguments);return function(){return Math.exp(t())}},bates:function(t){var n=o.random.irwinHall(t);return function(){return n()/t}},irwinHall:function(t){return function(){for(var n=0,e=0;e<t;e++)n+=Math.random();return n}}},o.scale={};var Sa={floor:I,ceil:I};function Ma(t,n,e,r){var i=[],a=[],s=0,u=Math.min(t.length,n.length)-1;for(t[u]<t[0]&&(t=t.slice().reverse(),n=n.slice().reverse());++s<=u;)i.push(e(t[s-1],t[s])),a.push(r(n[s-1],n[s]));return function(n){var e=o.bisect(t,n,1,u)-1;return a[e](i[e](n))}}function Ea(t,n){return o.rebind(t,n,"range","rangeRound","interpolate","clamp")}function Aa(t,n){return ka(t,_a(La(t,n)[2])),ka(t,_a(La(t,n)[2])),t}function La(t,n){null==n&&(n=10);var e=ma(t),r=e[1]-e[0],i=Math.pow(10,Math.floor(Math.log(r/n)/Math.LN10)),o=n/r*i;return o<=.15?i*=10:o<=.35?i*=5:o<=.75&&(i*=2),e[0]=Math.ceil(e[0]/i)*i,e[1]=Math.floor(e[1]/i)*i+.5*i,e[2]=i,e}function Pa(t,n){return o.range.apply(o,La(t,n))}function Na(t,n,e){var r=La(t,n);if(e){var i=In.exec(e);if(i.shift(),"s"===i[8]){var a=o.formatPrefix(Math.max(k(r[0]),k(r[1])));return i[7]||(i[7]="."+Oa(a.scale(r[2]))),i[8]="f",e=o.format(i.join("")),function(t){return e(a.scale(t))+a.symbol}}i[7]||(i[7]="."+function(t,n){var e=Oa(n[2]);return t in Ca?Math.abs(e-Oa(Math.max(k(n[0]),k(n[1]))))+ +("e"!==t):e-2*("%"===t)}(i[8],r)),e=i.join("")}else e=",."+Oa(r[2])+"f";return o.format(e)}o.scale.linear=function(){return function t(n,e,r,i){var o,a;function s(){var t=Math.min(n.length,e.length)>2?Ma:wa,s=i?Ao:Eo;return o=t(n,e,s,r),a=t(e,n,s,ro),u}function u(t){return o(t)}return u.invert=function(t){return a(t)},u.domain=function(t){return arguments.length?(n=t.map(Number),s()):n},u.range=function(t){return arguments.length?(e=t,s()):e},u.rangeRound=function(t){return u.range(t).interpolate(mo)},u.clamp=function(t){return arguments.length?(i=t,s()):i},u.interpolate=function(t){return arguments.length?(r=t,s()):r},u.ticks=function(t){return Pa(n,t)},u.tickFormat=function(t,e){return Na(n,t,e)},u.nice=function(t){return Aa(n,t),s()},u.copy=function(){return t(n,e,r,i)},s()}([0,1],[0,1],ro,!1)};var Ca={s:1,g:1,p:1,r:1,e:1};function Oa(t){return-Math.floor(Math.log(t)/Math.LN10+.01)}o.scale.log=function(){return function t(n,e,r,i){function a(t){return(r?Math.log(t<0?0:t):-Math.log(t>0?0:-t))/Math.log(e)}function s(t){return r?Math.pow(e,t):-Math.pow(e,-t)}function u(t){return n(a(t))}return u.invert=function(t){return s(n.invert(t))},u.domain=function(t){return arguments.length?(r=t[0]>=0,n.domain((i=t.map(Number)).map(a)),u):i},u.base=function(t){return arguments.length?(e=+t,n.domain(i.map(a)),u):e},u.nice=function(){var t=ka(i.map(a),r?Math:Ia);return n.domain(t),i=t.map(s),u},u.ticks=function(){var t=ma(i),n=[],o=t[0],u=t[1],c=Math.floor(a(o)),l=Math.ceil(a(u)),f=e%1?2:e;if(isFinite(l-c)){if(r){for(;c<l;c++)for(var h=1;h<f;h++)n.push(s(c)*h);n.push(s(c))}else for(n.push(s(c));c++<l;)for(h=f-1;h>0;h--)n.push(s(c)*h);for(c=0;n[c]<o;c++);for(l=n.length;n[l-1]>u;l--);n=n.slice(c,l)}return n},u.tickFormat=function(t,n){if(!arguments.length)return Ta;arguments.length<2?n=Ta:"function"!=typeof n&&(n=o.format(n));var r=Math.max(1,e*t/u.ticks().length);return function(t){var i=t/s(Math.round(a(t)));return i*e<e-.5&&(i*=e),i<=r?n(t):""}},u.copy=function(){return t(n.copy(),e,r,i)},Ea(u,n)}(o.scale.linear().domain([0,1]),10,!0,[1,10])};var Ta=o.format(".0e"),Ia={floor:function(t){return-Math.ceil(-t)},ceil:function(t){return-Math.floor(-t)}};function Da(t){return function(n){return n<0?-Math.pow(-n,t):Math.pow(n,t)}}o.scale.pow=function(){return function t(n,e,r){var i=Da(e),o=Da(1/e);function a(t){return n(i(t))}return a.invert=function(t){return o(n.invert(t))},a.domain=function(t){return arguments.length?(n.domain((r=t.map(Number)).map(i)),a):r},a.ticks=function(t){return Pa(r,t)},a.tickFormat=function(t,n){return Na(r,t,n)},a.nice=function(t){return a.domain(Aa(r,t))},a.exponent=function(t){return arguments.length?(i=Da(e=t),o=Da(1/e),n.domain(r.map(i)),a):e},a.copy=function(){return t(n.copy(),e,r)},Ea(a,n)}(o.scale.linear(),1,[0,1])},o.scale.sqrt=function(){return o.scale.pow().exponent(.5)},o.scale.ordinal=function(){return function t(n,e){var r,i,a;function s(t){return i[((r.get(t)||("range"===e.t?r.set(t,n.push(t)):NaN))-1)%i.length]}function u(t,e){return o.range(n.length).map((function(n){return t+e*n}))}return s.domain=function(t){if(!arguments.length)return n;n=[],r=new M;for(var i,o=-1,a=t.length;++o<a;)r.has(i=t[o])||r.set(i,n.push(i));return s[e.t].apply(s,e.a)},s.range=function(t){return arguments.length?(i=t,a=0,e={t:"range",a:arguments},s):i},s.rangePoints=function(t,r){arguments.length<2&&(r=0);var o=t[0],c=t[1],l=n.length<2?(o=(o+c)/2,0):(c-o)/(n.length-1+r);return i=u(o+l*r/2,l),a=0,e={t:"rangePoints",a:arguments},s},s.rangeRoundPoints=function(t,r){arguments.length<2&&(r=0);var o=t[0],c=t[1],l=n.length<2?(o=c=Math.round((o+c)/2),0):(c-o)/(n.length-1+r)|0;return i=u(o+Math.round(l*r/2+(c-o-(n.length-1+r)*l)/2),l),a=0,e={t:"rangeRoundPoints",a:arguments},s},s.rangeBands=function(t,r,o){arguments.length<2&&(r=0),arguments.length<3&&(o=r);var c=t[1]<t[0],l=t[c-0],f=t[1-c],h=(f-l)/(n.length-r+2*o);return i=u(l+h*o,h),c&&i.reverse(),a=h*(1-r),e={t:"rangeBands",a:arguments},s},s.rangeRoundBands=function(t,r,o){arguments.length<2&&(r=0),arguments.length<3&&(o=r);var c=t[1]<t[0],l=t[c-0],f=t[1-c],h=Math.floor((f-l)/(n.length-r+2*o));return i=u(l+Math.round((f-l-(n.length-r)*h)/2),h),c&&i.reverse(),a=Math.round(h*(1-r)),e={t:"rangeRoundBands",a:arguments},s},s.rangeBand=function(){return a},s.rangeExtent=function(){return ma(e.a[0])},s.copy=function(){return t(n,e)},s.domain(n)}([],{t:"range",a:[[]]})},o.scale.category10=function(){return o.scale.ordinal().range(za)},o.scale.category20=function(){return o.scale.ordinal().range(Ra)},o.scale.category20b=function(){return o.scale.ordinal().range(ja)},o.scale.category20c=function(){return o.scale.ordinal().range(qa)};var za=[2062260,16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175].map(ln),Ra=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,1556175,10410725].map(ln),ja=[3750777,5395619,7040719,10264286,6519097,9216594,11915115,13556636,9202993,12426809,15186514,15190932,8666169,11356490,14049643,15177372,8077683,10834324,13528509,14589654].map(ln),qa=[3244733,7057110,10406625,13032431,15095053,16616764,16625259,16634018,3253076,7652470,10607003,13101504,7695281,10394312,12369372,14342891,6513507,9868950,12434877,14277081].map(ln);function Ga(){return 0}o.scale.quantile=function(){return function t(n,e){var r;function i(){var t=0,i=e.length;for(r=[];++t<i;)r[t-1]=o.quantile(n,t/i);return a}function a(t){if(!isNaN(t=+t))return e[o.bisect(r,t)]}return a.domain=function(t){return arguments.length?(n=t.map(g).filter(x).sort(v),i()):n},a.range=function(t){return arguments.length?(e=t,i()):e},a.quantiles=function(){return r},a.invertExtent=function(t){return(t=e.indexOf(t))<0?[NaN,NaN]:[t>0?r[t-1]:n[0],t<r.length?r[t]:n[n.length-1]]},a.copy=function(){return t(n,e)},i()}([],[])},o.scale.quantize=function(){return function t(n,e,r){var i,o;function a(t){return r[Math.max(0,Math.min(o,Math.floor(i*(t-n))))]}function s(){return i=r.length/(e-n),o=r.length-1,a}return a.domain=function(t){return arguments.length?(n=+t[0],e=+t[t.length-1],s()):[n,e]},a.range=function(t){return arguments.length?(r=t,s()):r},a.invertExtent=function(t){return[t=(t=r.indexOf(t))<0?NaN:t/i+n,t+1/i]},a.copy=function(){return t(n,e,r)},s()}(0,1,[0,1])},o.scale.threshold=function(){return function t(n,e){function r(t){if(t<=t)return e[o.bisect(n,t)]}return r.domain=function(t){return arguments.length?(n=t,r):n},r.range=function(t){return arguments.length?(e=t,r):e},r.invertExtent=function(t){return t=e.indexOf(t),[n[t-1],n[t]]},r.copy=function(){return t(n,e)},r}([.5],[0,1])},o.scale.identity=function(){return function t(n){function e(t){return+t}return e.invert=e,e.domain=e.range=function(t){return arguments.length?(n=t.map(e),e):n},e.ticks=function(t){return Pa(n,t)},e.tickFormat=function(t,e){return Na(n,t,e)},e.copy=function(){return t(n)},e}([0,1])},o.svg={},o.svg.arc=function(){var t=Va,n=Fa,e=Ga,r=Ba,i=Ua,o=Ha,a=Xa;function s(){var s=Math.max(0,+t.apply(this,arguments)),c=Math.max(0,+n.apply(this,arguments)),l=i.apply(this,arguments)-Tt,f=o.apply(this,arguments)-Tt,h=Math.abs(f-l),p=l>f?0:1;if(c<s&&(y=c,c=s,s=y),h>=Ot)return u(c,p)+(s?u(s,1-p):"")+"Z";var y,d,v,g,x,m,b,w,k,_,S,M,E=0,A=0,L=[];if((g=(+a.apply(this,arguments)||0)/2)&&(v=r===Ba?Math.sqrt(s*s+c*c):+r.apply(this,arguments),p||(A*=-1),c&&(A=qt(v/c*Math.sin(g))),s&&(E=qt(v/s*Math.sin(g)))),c){x=c*Math.cos(l+A),m=c*Math.sin(l+A),b=c*Math.cos(f-A),w=c*Math.sin(f-A);var P=Math.abs(f-l-2*A)<=Nt?0:1;if(A&&Ya(x,m,b,w)===p^P){var N=(l+f)/2;x=c*Math.cos(N),m=c*Math.sin(N),b=w=null}}else x=m=0;if(s){k=s*Math.cos(f-E),_=s*Math.sin(f-E),S=s*Math.cos(l+E),M=s*Math.sin(l+E);var C=Math.abs(l-f+2*E)<=Nt?0:1;if(E&&Ya(k,_,S,M)===1-p^C){var O=(l+f)/2;k=s*Math.cos(O),_=s*Math.sin(O),S=M=null}}else k=_=0;if(h>Lt&&(y=Math.min(Math.abs(c-s)/2,+e.apply(this,arguments)))>.001){d=s<c^p?0:1;var T=y,I=y;if(h<Nt){var D=null==S?[k,_]:null==b?[x,m]:hi([x,m],[S,M],[b,w],[k,_]),z=x-D[0],R=m-D[1],j=b-D[0],q=w-D[1],G=1/Math.sin(Math.acos((z*j+R*q)/(Math.sqrt(z*z+R*R)*Math.sqrt(j*j+q*q)))/2),B=Math.sqrt(D[0]*D[0]+D[1]*D[1]);I=Math.min(y,(s-B)/(G-1)),T=Math.min(y,(c-B)/(G+1))}if(null!=b){var V=Za(null==S?[k,_]:[S,M],[x,m],c,T,p),F=Za([b,w],[k,_],c,T,p);y===T?L.push("M",V[0],"A",T,",",T," 0 0,",d," ",V[1],"A",c,",",c," 0 ",1-p^Ya(V[1][0],V[1][1],F[1][0],F[1][1]),",",p," ",F[1],"A",T,",",T," 0 0,",d," ",F[0]):L.push("M",V[0],"A",T,",",T," 0 1,",d," ",F[0])}else L.push("M",x,",",m);if(null!=S){var U=Za([x,m],[S,M],s,-I,p),H=Za([k,_],null==b?[x,m]:[b,w],s,-I,p);y===I?L.push("L",H[0],"A",I,",",I," 0 0,",d," ",H[1],"A",s,",",s," 0 ",p^Ya(H[1][0],H[1][1],U[1][0],U[1][1]),",",1-p," ",U[1],"A",I,",",I," 0 0,",d," ",U[0]):L.push("L",H[0],"A",I,",",I," 0 0,",d," ",U[0])}else L.push("L",k,",",_)}else L.push("M",x,",",m),null!=b&&L.push("A",c,",",c," 0 ",P,",",p," ",b,",",w),L.push("L",k,",",_),null!=S&&L.push("A",s,",",s," 0 ",C,",",1-p," ",S,",",M);return L.push("Z"),L.join("")}function u(t,n){return"M0,"+t+"A"+t+","+t+" 0 1,"+n+" 0,"+-t+"A"+t+","+t+" 0 1,"+n+" 0,"+t}return s.innerRadius=function(n){return arguments.length?(t=mn(n),s):t},s.outerRadius=function(t){return arguments.length?(n=mn(t),s):n},s.cornerRadius=function(t){return arguments.length?(e=mn(t),s):e},s.padRadius=function(t){return arguments.length?(r=t==Ba?Ba:mn(t),s):r},s.startAngle=function(t){return arguments.length?(i=mn(t),s):i},s.endAngle=function(t){return arguments.length?(o=mn(t),s):o},s.padAngle=function(t){return arguments.length?(a=mn(t),s):a},s.centroid=function(){var e=(+t.apply(this,arguments)+ +n.apply(this,arguments))/2,r=(+i.apply(this,arguments)+ +o.apply(this,arguments))/2-Tt;return[Math.cos(r)*e,Math.sin(r)*e]},s};var Ba="auto";function Va(t){return t.innerRadius}function Fa(t){return t.outerRadius}function Ua(t){return t.startAngle}function Ha(t){return t.endAngle}function Xa(t){return t&&t.padAngle}function Ya(t,n,e,r){return(t-e)*n-(n-r)*t>0?0:1}function Za(t,n,e,r,i){var o=t[0]-n[0],a=t[1]-n[1],s=(i?r:-r)/Math.sqrt(o*o+a*a),u=s*a,c=-s*o,l=t[0]+u,f=t[1]+c,h=n[0]+u,p=n[1]+c,y=(l+h)/2,d=(f+p)/2,v=h-l,g=p-f,x=v*v+g*g,m=e-r,b=l*p-h*f,w=(g<0?-1:1)*Math.sqrt(Math.max(0,m*m*x-b*b)),k=(b*g-v*w)/x,_=(-b*v-g*w)/x,S=(b*g+v*w)/x,M=(-b*v+g*w)/x,E=k-y,A=_-d,L=S-y,P=M-d;return E*E+A*A>L*L+P*P&&(k=S,_=M),[[k-u,_-c],[k*e/m,_*e/m]]}function Wa(t){var n=ai,e=si,r=$e,i=$a,o=i.key,a=.7;function s(o){var s,u=[],c=[],l=-1,f=o.length,h=mn(n),p=mn(e);function y(){u.push("M",i(t(c),a))}for(;++l<f;)r.call(this,s=o[l],l)?c.push([+h.call(this,s,l),+p.call(this,s,l)]):c.length&&(y(),c=[]);return c.length&&y(),u.length?u.join(""):null}return s.x=function(t){return arguments.length?(n=t,s):n},s.y=function(t){return arguments.length?(e=t,s):e},s.defined=function(t){return arguments.length?(r=t,s):r},s.interpolate=function(t){return arguments.length?(o="function"==typeof t?i=t:(i=Ka.get(t)||$a).key,s):o},s.tension=function(t){return arguments.length?(a=t,s):a},s}o.svg.line=function(){return Wa(I)};var Ka=o.map({linear:$a,"linear-closed":Ja,step:function(t){var n=0,e=t.length,r=t[0],i=[r[0],",",r[1]];for(;++n<e;)i.push("H",(r[0]+(r=t[n])[0])/2,"V",r[1]);e>1&&i.push("H",r[0]);return i.join("")},"step-before":Qa,"step-after":ts,basis:rs,"basis-open":function(t){if(t.length<4)return $a(t);var n,e=[],r=-1,i=t.length,o=[0],a=[0];for(;++r<3;)n=t[r],o.push(n[0]),a.push(n[1]);e.push(is(ss,o)+","+is(ss,a)),--r;for(;++r<i;)n=t[r],o.shift(),o.push(n[0]),a.shift(),a.push(n[1]),us(e,o,a);return e.join("")},"basis-closed":function(t){var n,e,r=-1,i=t.length,o=i+4,a=[],s=[];for(;++r<4;)e=t[r%i],a.push(e[0]),s.push(e[1]);n=[is(ss,a),",",is(ss,s)],--r;for(;++r<o;)e=t[r%i],a.shift(),a.push(e[0]),s.shift(),s.push(e[1]),us(n,a,s);return n.join("")},bundle:function(t,n){var e=t.length-1;if(e)for(var r,i,o=t[0][0],a=t[0][1],s=t[e][0]-o,u=t[e][1]-a,c=-1;++c<=e;)r=t[c],i=c/e,r[0]=n*r[0]+(1-n)*(o+i*s),r[1]=n*r[1]+(1-n)*(a+i*u);return rs(t)},cardinal:function(t,n){return t.length<3?$a(t):t[0]+ns(t,es(t,n))},"cardinal-open":function(t,n){return t.length<4?$a(t):t[1]+ns(t.slice(1,-1),es(t,n))},"cardinal-closed":function(t,n){return t.length<3?Ja(t):t[0]+ns((t.push(t[0]),t),es([t[t.length-2]].concat(t,[t[1]]),n))},monotone:function(t){return t.length<3?$a(t):t[0]+ns(t,function(t){var n,e,r,i,o=[],a=function(t){var n=0,e=t.length-1,r=[],i=t[0],o=t[1],a=r[0]=cs(i,o);for(;++n<e;)r[n]=(a+(a=cs(i=o,o=t[n+1])))/2;return r[n]=a,r}(t),s=-1,u=t.length-1;for(;++s<u;)n=cs(t[s],t[s+1]),k(n)<Lt?a[s]=a[s+1]=0:(e=a[s]/n,r=a[s+1]/n,(i=e*e+r*r)>9&&(i=3*n/Math.sqrt(i),a[s]=i*e,a[s+1]=i*r));s=-1;for(;++s<=u;)i=(t[Math.min(u,s+1)][0]-t[Math.max(0,s-1)][0])/(6*(1+a[s]*a[s])),o.push([i||0,a[s]*i||0]);return o}(t))}});function $a(t){return t.length>1?t.join("L"):t+"Z"}function Ja(t){return t.join("L")+"Z"}function Qa(t){for(var n=0,e=t.length,r=t[0],i=[r[0],",",r[1]];++n<e;)i.push("V",(r=t[n])[1],"H",r[0]);return i.join("")}function ts(t){for(var n=0,e=t.length,r=t[0],i=[r[0],",",r[1]];++n<e;)i.push("H",(r=t[n])[0],"V",r[1]);return i.join("")}function ns(t,n){if(n.length<1||t.length!=n.length&&t.length!=n.length+2)return $a(t);var e=t.length!=n.length,r="",i=t[0],o=t[1],a=n[0],s=a,u=1;if(e&&(r+="Q"+(o[0]-2*a[0]/3)+","+(o[1]-2*a[1]/3)+","+o[0]+","+o[1],i=t[1],u=2),n.length>1){s=n[1],o=t[u],u++,r+="C"+(i[0]+a[0])+","+(i[1]+a[1])+","+(o[0]-s[0])+","+(o[1]-s[1])+","+o[0]+","+o[1];for(var c=2;c<n.length;c++,u++)o=t[u],s=n[c],r+="S"+(o[0]-s[0])+","+(o[1]-s[1])+","+o[0]+","+o[1]}if(e){var l=t[u];r+="Q"+(o[0]+2*s[0]/3)+","+(o[1]+2*s[1]/3)+","+l[0]+","+l[1]}return r}function es(t,n){for(var e,r=[],i=(1-n)/2,o=t[0],a=t[1],s=1,u=t.length;++s<u;)e=o,o=a,a=t[s],r.push([i*(a[0]-e[0]),i*(a[1]-e[1])]);return r}function rs(t){if(t.length<3)return $a(t);var n=1,e=t.length,r=t[0],i=r[0],o=r[1],a=[i,i,i,(r=t[1])[0]],s=[o,o,o,r[1]],u=[i,",",o,"L",is(ss,a),",",is(ss,s)];for(t.push(t[e-1]);++n<=e;)r=t[n],a.shift(),a.push(r[0]),s.shift(),s.push(r[1]),us(u,a,s);return t.pop(),u.push("L",r),u.join("")}function is(t,n){return t[0]*n[0]+t[1]*n[1]+t[2]*n[2]+t[3]*n[3]}Ka.forEach((function(t,n){n.key=t,n.closed=/-closed$/.test(t)}));var os=[0,2/3,1/3,0],as=[0,1/3,2/3,0],ss=[0,1/6,2/3,1/6];function us(t,n,e){t.push("C",is(os,n),",",is(os,e),",",is(as,n),",",is(as,e),",",is(ss,n),",",is(ss,e))}function cs(t,n){return(n[1]-t[1])/(n[0]-t[0])}function ls(t){for(var n,e,r,i=-1,o=t.length;++i<o;)e=(n=t[i])[0],r=n[1]-Tt,n[0]=e*Math.cos(r),n[1]=e*Math.sin(r);return t}function fs(t){var n=ai,e=ai,r=0,i=si,o=$e,a=$a,s=a.key,u=a,c="L",l=.7;function f(s){var f,h,p,y=[],d=[],v=[],g=-1,x=s.length,m=mn(n),b=mn(r),w=n===e?function(){return h}:mn(e),k=r===i?function(){return p}:mn(i);function _(){y.push("M",a(t(v),l),c,u(t(d.reverse()),l),"Z")}for(;++g<x;)o.call(this,f=s[g],g)?(d.push([h=+m.call(this,f,g),p=+b.call(this,f,g)]),v.push([+w.call(this,f,g),+k.call(this,f,g)])):d.length&&(_(),d=[],v=[]);return d.length&&_(),y.length?y.join(""):null}return f.x=function(t){return arguments.length?(n=e=t,f):e},f.x0=function(t){return arguments.length?(n=t,f):n},f.x1=function(t){return arguments.length?(e=t,f):e},f.y=function(t){return arguments.length?(r=i=t,f):i},f.y0=function(t){return arguments.length?(r=t,f):r},f.y1=function(t){return arguments.length?(i=t,f):i},f.defined=function(t){return arguments.length?(o=t,f):o},f.interpolate=function(t){return arguments.length?(s="function"==typeof t?a=t:(a=Ka.get(t)||$a).key,u=a.reverse||a,c=a.closed?"M":"L",f):s},f.tension=function(t){return arguments.length?(l=t,f):l},f}function hs(t){return t.radius}function ps(t){return[t.x,t.y]}function ys(t){return function(){var n=t.apply(this,arguments),e=n[0],r=n[1]-Tt;return[e*Math.cos(r),e*Math.sin(r)]}}function ds(){return 64}function vs(){return"circle"}function gs(t){var n=Math.sqrt(t/Nt);return"M0,"+n+"A"+n+","+n+" 0 1,1 0,"+-n+"A"+n+","+n+" 0 1,1 0,"+n+"Z"}o.svg.line.radial=function(){var t=Wa(ls);return t.radius=t.x,delete t.x,t.angle=t.y,delete t.y,t},Qa.reverse=ts,ts.reverse=Qa,o.svg.area=function(){return fs(I)},o.svg.area.radial=function(){var t=fs(ls);return t.radius=t.x,delete t.x,t.innerRadius=t.x0,delete t.x0,t.outerRadius=t.x1,delete t.x1,t.angle=t.y,delete t.y,t.startAngle=t.y0,delete t.y0,t.endAngle=t.y1,delete t.y1,t},o.svg.chord=function(){var t=Xr,n=Yr,e=hs,r=Ua,i=Ha;function o(e,r){var i,o,c=a(this,t,e,r),l=a(this,n,e,r);return"M"+c.p0+s(c.r,c.p1,c.a1-c.a0)+(o=l,((i=c).a0==o.a0&&i.a1==o.a1?u(c.r,c.p1,c.r,c.p0):u(c.r,c.p1,l.r,l.p0)+s(l.r,l.p1,l.a1-l.a0)+u(l.r,l.p1,c.r,c.p0))+"Z")}function a(t,n,o,a){var s=n.call(t,o,a),u=e.call(t,s,a),c=r.call(t,s,a)-Tt,l=i.call(t,s,a)-Tt;return{r:u,a0:c,a1:l,p0:[u*Math.cos(c),u*Math.sin(c)],p1:[u*Math.cos(l),u*Math.sin(l)]}}function s(t,n,e){return"A"+t+","+t+" 0 "+ +(e>Nt)+",1 "+n}function u(t,n,e,r){return"Q 0,0 "+r}return o.radius=function(t){return arguments.length?(e=mn(t),o):e},o.source=function(n){return arguments.length?(t=mn(n),o):t},o.target=function(t){return arguments.length?(n=mn(t),o):n},o.startAngle=function(t){return arguments.length?(r=mn(t),o):r},o.endAngle=function(t){return arguments.length?(i=mn(t),o):i},o},o.svg.diagonal=function(){var t=Xr,n=Yr,e=ps;function r(r,i){var o=t.call(this,r,i),a=n.call(this,r,i),s=(o.y+a.y)/2,u=[o,{x:o.x,y:s},{x:a.x,y:s},a];return"M"+(u=u.map(e))[0]+"C"+u[1]+" "+u[2]+" "+u[3]}return r.source=function(n){return arguments.length?(t=mn(n),r):t},r.target=function(t){return arguments.length?(n=mn(t),r):n},r.projection=function(t){return arguments.length?(e=t,r):e},r},o.svg.diagonal.radial=function(){var t=o.svg.diagonal(),n=ps,e=t.projection;return t.projection=function(t){return arguments.length?e(ys(n=t)):n},t},o.svg.symbol=function(){var t=vs,n=ds;function e(e,r){return(xs.get(t.call(this,e,r))||gs)(n.call(this,e,r))}return e.type=function(n){return arguments.length?(t=mn(n),e):t},e.size=function(t){return arguments.length?(n=mn(t),e):n},e};var xs=o.map({circle:gs,cross:function(t){var n=Math.sqrt(t/5)/2;return"M"+-3*n+","+-n+"H"+-n+"V"+-3*n+"H"+n+"V"+-n+"H"+3*n+"V"+n+"H"+n+"V"+3*n+"H"+-n+"V"+n+"H"+-3*n+"Z"},diamond:function(t){var n=Math.sqrt(t/(2*bs)),e=n*bs;return"M0,"+-n+"L"+e+",0 0,"+n+" "+-e+",0Z"},square:function(t){var n=Math.sqrt(t)/2;return"M"+-n+","+-n+"L"+n+","+-n+" "+n+","+n+" "+-n+","+n+"Z"},"triangle-down":function(t){var n=Math.sqrt(t/ms),e=n*ms/2;return"M0,"+e+"L"+n+","+-e+" "+-n+","+-e+"Z"},"triangle-up":function(t){var n=Math.sqrt(t/ms),e=n*ms/2;return"M0,"+-e+"L"+n+","+e+" "+-n+","+e+"Z"}});o.svg.symbolTypes=xs.keys();var ms=Math.sqrt(3),bs=Math.tan(30*It);K.transition=function(t){for(var n,e,r=Ss||++As,i=Ns(t),o=[],a=Ms||{time:Date.now(),ease:po,delay:0,duration:250},s=-1,u=this.length;++s<u;){o.push(n=[]);for(var c=this[s],l=-1,f=c.length;++l<f;)(e=c[l])&&Cs(e,l,i,r,a),n.push(e)}return _s(o,i,r)},K.interrupt=function(t){return this.each(null==t?ws:ks(Ns(t)))};var ws=ks(Ns());function ks(t){return function(){var n,e,r;(n=this[t])&&(r=n[e=n.active])&&(r.timer.c=null,r.timer.t=NaN,--n.count?delete n[e]:delete this[t],n.active+=.5,r.event&&r.event.interrupt.call(this,this.__data__,r.index))}}function _s(t,n,e){return H(t,Es),t.namespace=n,t.id=e,t}var Ss,Ms,Es=[],As=0;function Ls(t,n,e,r){var i=t.id,o=t.namespace;return yt(t,"function"==typeof e?function(t,a,s){t[o][i].tween.set(n,r(e.call(t,t.__data__,a,s)))}:(e=r(e),function(t){t[o][i].tween.set(n,e)}))}function Ps(t){return null==t&&(t=""),function(){this.textContent=t}}function Ns(t){return null==t?"__transition__":"__transition_"+t+"__"}function Cs(t,n,e,r,i){var o,a,s,u,c,l=t[e]||(t[e]={active:0,count:0}),f=l[r];function h(e){var i=l.active,h=l[i];for(var y in h&&(h.timer.c=null,h.timer.t=NaN,--l.count,delete l[i],h.event&&h.event.interrupt.call(t,t.__data__,h.index)),l)if(+y<r){var d=l[y];d.timer.c=null,d.timer.t=NaN,--l.count,delete l[y]}a.c=p,An((function(){return a.c&&p(e||1)&&(a.c=null,a.t=NaN),1}),0,o),l.active=r,f.event&&f.event.start.call(t,t.__data__,n),c=[],f.tween.forEach((function(e,r){(r=r.call(t,t.__data__,n))&&c.push(r)})),u=f.ease,s=f.duration}function p(i){for(var o=i/s,a=u(o),h=c.length;h>0;)c[--h].call(t,a);if(o>=1)return f.event&&f.event.end.call(t,t.__data__,n),--l.count?delete l[r]:delete t[e],1}f||(o=i.time,a=An((function(t){var n=f.delay;if(a.t=n+o,n<=t)return h(t-n);a.c=h}),0,o),f=l[r]={tween:new M,time:o,timer:a,delay:i.delay,duration:i.duration,ease:i.ease,index:n},i=null,++l.count)}Es.call=K.call,Es.empty=K.empty,Es.node=K.node,Es.size=K.size,o.transition=function(t,n){return t&&t.transition?Ss?t.transition(n):t:o.selection().transition(t)},o.transition.prototype=Es,Es.select=function(t){var n,e,r,i=this.id,o=this.namespace,a=[];t=$(t);for(var s=-1,u=this.length;++s<u;){a.push(n=[]);for(var c=this[s],l=-1,f=c.length;++l<f;)(r=c[l])&&(e=t.call(r,r.__data__,l,s))?("__data__"in r&&(e.__data__=r.__data__),Cs(e,l,o,i,r[o][i]),n.push(e)):n.push(null)}return _s(a,o,i)},Es.selectAll=function(t){var n,e,r,i,o,a=this.id,s=this.namespace,u=[];t=J(t);for(var c=-1,l=this.length;++c<l;)for(var f=this[c],h=-1,p=f.length;++h<p;)if(r=f[h]){o=r[s][a],e=t.call(r,r.__data__,h,c),u.push(n=[]);for(var y=-1,d=e.length;++y<d;)(i=e[y])&&Cs(i,y,s,a,o),n.push(i)}return _s(u,s,a)},Es.filter=function(t){var n,e,r=[];"function"!=typeof t&&(t=ht(t));for(var i=0,o=this.length;i<o;i++){r.push(n=[]);for(var a,s=0,u=(a=this[i]).length;s<u;s++)(e=a[s])&&t.call(e,e.__data__,s,i)&&n.push(e)}return _s(r,this.namespace,this.id)},Es.tween=function(t,n){var e=this.id,r=this.namespace;return arguments.length<2?this.node()[r][e].tween.get(t):yt(this,null==n?function(n){n[r][e].tween.remove(t)}:function(i){i[r][e].tween.set(t,n)})},Es.attr=function(t,n){if(arguments.length<2){for(n in t)this.attr(n,t[n]);return this}var e="transform"==t?Mo:ro,r=o.ns.qualify(t);function i(){this.removeAttribute(r)}function a(){this.removeAttributeNS(r.space,r.local)}function s(t){return null==t?i:(t+="",function(){var n,i=this.getAttribute(r);return i!==t&&(n=e(i,t),function(t){this.setAttribute(r,n(t))})})}function u(t){return null==t?a:(t+="",function(){var n,i=this.getAttributeNS(r.space,r.local);return i!==t&&(n=e(i,t),function(t){this.setAttributeNS(r.space,r.local,n(t))})})}return Ls(this,"attr."+t,n,r.local?u:s)},Es.attrTween=function(t,n){var e=o.ns.qualify(t);return this.tween("attr."+t,e.local?function(t,r){var i=n.call(this,t,r,this.getAttributeNS(e.space,e.local));return i&&function(t){this.setAttributeNS(e.space,e.local,i(t))}}:function(t,r){var i=n.call(this,t,r,this.getAttribute(e));return i&&function(t){this.setAttribute(e,i(t))}})},Es.style=function(t,n,e){var r=arguments.length;if(r<3){if("string"!=typeof t){for(e in r<2&&(n=""),t)this.style(e,t[e],n);return this}e=""}function i(){this.style.removeProperty(t)}function o(n){return null==n?i:(n+="",function(){var r,i=l(this).getComputedStyle(this,null).getPropertyValue(t);return i!==n&&(r=ro(i,n),function(n){this.style.setProperty(t,r(n),e)})})}return Ls(this,"style."+t,n,o)},Es.styleTween=function(t,n,e){function r(r,i){var o=n.call(this,r,i,l(this).getComputedStyle(this,null).getPropertyValue(t));return o&&function(n){this.style.setProperty(t,o(n),e)}}return arguments.length<3&&(e=""),this.tween("style."+t,r)},Es.text=function(t){return Ls(this,"text",t,Ps)},Es.remove=function(){var t=this.namespace;return this.each("end.transition",(function(){var n;this[t].count<2&&(n=this.parentNode)&&n.removeChild(this)}))},Es.ease=function(t){var n=this.id,e=this.namespace;return arguments.length<1?this.node()[e][n].ease:("function"!=typeof t&&(t=o.ease.apply(o,arguments)),yt(this,(function(r){r[e][n].ease=t})))},Es.delay=function(t){var n=this.id,e=this.namespace;return arguments.length<1?this.node()[e][n].delay:yt(this,"function"==typeof t?function(r,i,o){r[e][n].delay=+t.call(r,r.__data__,i,o)}:(t=+t,function(r){r[e][n].delay=t}))},Es.duration=function(t){var n=this.id,e=this.namespace;return arguments.length<1?this.node()[e][n].duration:yt(this,"function"==typeof t?function(r,i,o){r[e][n].duration=Math.max(1,t.call(r,r.__data__,i,o))}:(t=Math.max(1,t),function(r){r[e][n].duration=t}))},Es.each=function(t,n){var e=this.id,r=this.namespace;if(arguments.length<2){var i=Ms,a=Ss;try{Ss=e,yt(this,(function(n,i,o){Ms=n[r][e],t.call(n,n.__data__,i,o)}))}finally{Ms=i,Ss=a}}else yt(this,(function(i){var a=i[r][e];(a.event||(a.event=o.dispatch("start","end","interrupt"))).on(t,n)}));return this},Es.transition=function(){for(var t,n,e,r=this.id,i=++As,o=this.namespace,a=[],s=0,u=this.length;s<u;s++){a.push(t=[]);for(var c,l=0,f=(c=this[s]).length;l<f;l++)(n=c[l])&&Cs(n,l,o,i,{time:(e=n[o][r]).time,ease:e.ease,delay:e.delay+e.duration,duration:e.duration}),t.push(n)}return _s(a,o,i)},o.svg.axis=function(){var t,n=o.scale.linear(),e=Os,r=6,i=6,a=3,u=[10],c=null;function l(s){s.each((function(){var s,l=o.select(this),f=this.__chart__||n,h=this.__chart__=n.copy(),p=null==c?h.ticks?h.ticks.apply(h,u):h.domain():c,y=null==t?h.tickFormat?h.tickFormat.apply(h,u):I:t,d=l.selectAll(".tick").data(p,h),v=d.enter().insert("g",".domain").attr("class","tick").style("opacity",Lt),g=o.transition(d.exit()).style("opacity",Lt).remove(),x=o.transition(d.order()).style("opacity",1),m=Math.max(r,0)+a,b=ba(h),w=l.selectAll(".domain").data([0]),k=(w.enter().append("path").attr("class","domain"),o.transition(w));v.append("line"),v.append("text");var _,S,M,E,A=v.select("line"),L=x.select("line"),P=d.select("text").text(y),N=v.select("text"),C=x.select("text"),O="top"===e||"left"===e?-1:1;if("bottom"===e||"top"===e?(s=Is,_="x",M="y",S="x2",E="y2",P.attr("dy",O<0?"0em":".71em").style("text-anchor","middle"),k.attr("d","M"+b[0]+","+O*i+"V0H"+b[1]+"V"+O*i)):(s=Ds,_="y",M="x",S="y2",E="x2",P.attr("dy",".32em").style("text-anchor",O<0?"end":"start"),k.attr("d","M"+O*i+","+b[0]+"H0V"+b[1]+"H"+O*i)),A.attr(E,O*r),N.attr(M,O*m),L.attr(S,0).attr(E,O*r),C.attr(_,0).attr(M,O*m),h.rangeBand){var T=h,D=T.rangeBand()/2;f=h=function(t){return T(t)+D}}else f.rangeBand?f=h:g.call(s,h,f);v.call(s,f,h),x.call(s,h,h)}))}return l.scale=function(t){return arguments.length?(n=t,l):n},l.orient=function(t){return arguments.length?(e=t in Ts?t+"":Os,l):e},l.ticks=function(){return arguments.length?(u=s(arguments),l):u},l.tickValues=function(t){return arguments.length?(c=t,l):c},l.tickFormat=function(n){return arguments.length?(t=n,l):t},l.tickSize=function(t){var n=arguments.length;return n?(r=+t,i=+arguments[n-1],l):r},l.innerTickSize=function(t){return arguments.length?(r=+t,l):r},l.outerTickSize=function(t){return arguments.length?(i=+t,l):i},l.tickPadding=function(t){return arguments.length?(a=+t,l):a},l.tickSubdivide=function(){return arguments.length&&l},l};var Os="bottom",Ts={top:1,right:1,bottom:1,left:1};function Is(t,n,e){t.attr("transform",(function(t){var r=n(t);return"translate("+(isFinite(r)?r:e(t))+",0)"}))}function Ds(t,n,e){t.attr("transform",(function(t){var r=n(t);return"translate(0,"+(isFinite(r)?r:e(t))+")"}))}o.svg.brush=function(){var t,n,e=F(h,"brushstart","brush","brushend"),r=null,i=null,a=[0,0],s=[0,0],u=!0,c=!0,f=Rs[0];function h(t){t.each((function(){var t=o.select(this).style("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush",v).on("touchstart.brush",v),n=t.selectAll(".background").data([0]);n.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair"),t.selectAll(".extent").data([0]).enter().append("rect").attr("class","extent").style("cursor","move");var e=t.selectAll(".resize").data(f,I);e.exit().remove(),e.enter().append("g").attr("class",(function(t){return"resize "+t})).style("cursor",(function(t){return zs[t]})).append("rect").attr("x",(function(t){return/[ew]$/.test(t)?-3:null})).attr("y",(function(t){return/^[ns]/.test(t)?-3:null})).attr("width",6).attr("height",6).style("visibility","hidden"),e.style("display",h.empty()?"none":null);var a,s=o.transition(t),u=o.transition(n);r&&(a=ba(r),u.attr("x",a[0]).attr("width",a[1]-a[0]),y(s)),i&&(a=ba(i),u.attr("y",a[0]).attr("height",a[1]-a[0]),d(s)),p(s)}))}function p(t){t.selectAll(".resize").attr("transform",(function(t){return"translate("+a[+/e$/.test(t)]+","+s[+/^s/.test(t)]+")"}))}function y(t){t.select(".extent").attr("x",a[0]),t.selectAll(".extent,.n>rect,.s>rect").attr("width",a[1]-a[0])}function d(t){t.select(".extent").attr("y",s[0]),t.selectAll(".extent,.e>rect,.w>rect").attr("height",s[1]-s[0])}function v(){var f,v,g=this,x=o.select(o.event.target),m=e.of(g,arguments),b=o.select(g),w=x.datum(),k=!/^(n|s)$/.test(w)&&r,_=!/^(e|w)$/.test(w)&&i,S=x.classed("extent"),M=St(g),E=o.mouse(g),A=o.select(l(g)).on("keydown.brush",N).on("keyup.brush",C);if(o.event.changedTouches?A.on("touchmove.brush",O).on("touchend.brush",I):A.on("mousemove.brush",O).on("mouseup.brush",I),b.interrupt().selectAll("*").interrupt(),S)E[0]=a[0]-E[0],E[1]=s[0]-E[1];else if(w){var L=+/w$/.test(w),P=+/^n/.test(w);v=[a[1-L]-E[0],s[1-P]-E[1]],E[0]=a[L],E[1]=s[P]}else o.event.altKey&&(f=E.slice());function N(){32==o.event.keyCode&&(S||(f=null,E[0]-=a[1],E[1]-=s[1],S=2),B())}function C(){32==o.event.keyCode&&2==S&&(E[0]+=a[1],E[1]+=s[1],S=0,B())}function O(){var t=o.mouse(g),n=!1;v&&(t[0]+=v[0],t[1]+=v[1]),S||(o.event.altKey?(f||(f=[(a[0]+a[1])/2,(s[0]+s[1])/2]),E[0]=a[+(t[0]<f[0])],E[1]=s[+(t[1]<f[1])]):f=null),k&&T(t,r,0)&&(y(b),n=!0),_&&T(t,i,1)&&(d(b),n=!0),n&&(p(b),m({type:"brush",mode:S?"move":"resize"}))}function T(e,r,i){var o,l,h=ba(r),p=h[0],y=h[1],d=E[i],v=i?s:a,g=v[1]-v[0];if(S&&(p-=d,y-=g+d),o=(i?c:u)?Math.max(p,Math.min(y,e[i])):e[i],S?l=(o+=d)+g:(f&&(d=Math.max(p,Math.min(y,2*f[i]-o))),d<o?(l=o,o=d):l=d),v[0]!=o||v[1]!=l)return i?n=null:t=null,v[0]=o,v[1]=l,!0}function I(){O(),b.style("pointer-events","all").selectAll(".resize").style("display",h.empty()?"none":null),o.select("body").style("cursor",null),A.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null),M(),m({type:"brushend"})}b.style("pointer-events","none").selectAll(".resize").style("display",null),o.select("body").style("cursor",x.style("cursor")),m({type:"brushstart"}),O()}return h.event=function(r){r.each((function(){var r=e.of(this,arguments),i={x:a,y:s,i:t,j:n},u=this.__chart__||i;this.__chart__=i,Ss?o.select(this).transition().each("start.brush",(function(){t=u.i,n=u.j,a=u.x,s=u.y,r({type:"brushstart"})})).tween("brush:brush",(function(){var e=io(a,i.x),o=io(s,i.y);return t=n=null,function(t){a=i.x=e(t),s=i.y=o(t),r({type:"brush",mode:"resize"})}})).each("end.brush",(function(){t=i.i,n=i.j,r({type:"brush",mode:"resize"}),r({type:"brushend"})})):(r({type:"brushstart"}),r({type:"brush",mode:"resize"}),r({type:"brushend"}))}))},h.x=function(t){return arguments.length?(f=Rs[!(r=t)<<1|!i],h):r},h.y=function(t){return arguments.length?(f=Rs[!r<<1|!(i=t)],h):i},h.clamp=function(t){return arguments.length?(r&&i?(u=!!t[0],c=!!t[1]):r?u=!!t:i&&(c=!!t),h):r&&i?[u,c]:r?u:i?c:null},h.extent=function(e){var o,u,c,l,f;return arguments.length?(r&&(o=e[0],u=e[1],i&&(o=o[0],u=u[0]),t=[o,u],r.invert&&(o=r(o),u=r(u)),u<o&&(f=o,o=u,u=f),o==a[0]&&u==a[1]||(a=[o,u])),i&&(c=e[0],l=e[1],r&&(c=c[1],l=l[1]),n=[c,l],i.invert&&(c=i(c),l=i(l)),l<c&&(f=c,c=l,l=f),c==s[0]&&l==s[1]||(s=[c,l])),h):(r&&(t?(o=t[0],u=t[1]):(o=a[0],u=a[1],r.invert&&(o=r.invert(o),u=r.invert(u)),u<o&&(f=o,o=u,u=f))),i&&(n?(c=n[0],l=n[1]):(c=s[0],l=s[1],i.invert&&(c=i.invert(c),l=i.invert(l)),l<c&&(f=c,c=l,l=f))),r&&i?[[o,c],[u,l]]:r?[o,u]:i&&[c,l])},h.clear=function(){return h.empty()||(a=[0,0],s=[0,0],t=n=null),h},h.empty=function(){return!!r&&a[0]==a[1]||!!i&&s[0]==s[1]},o.rebind(h,e,"on")};var zs={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},Rs=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]],js=Rn.format=he.timeFormat,qs=js.utc,Gs=qs("%Y-%m-%dT%H:%M:%S.%LZ");function Bs(t){return t.toISOString()}function Vs(t,n,e){function r(n){return t(n)}function i(t,e){var r=(t[1]-t[0])/e,i=o.bisect(Us,r);return i==Us.length?[n.year,La(t.map((function(t){return t/31536e6})),e)[2]]:i?n[r/Us[i-1]<Us[i]/r?i-1:i]:[Ys,La(t,e)[2]]}return r.invert=function(n){return Fs(t.invert(n))},r.domain=function(n){return arguments.length?(t.domain(n),r):t.domain().map(Fs)},r.nice=function(t,n){var e=r.domain(),o=ma(e),a=null==t?i(o,10):"number"==typeof t&&i(o,t);function s(e){return!isNaN(e)&&!t.range(e,Fs(+e+1),n).length}return a&&(t=a[0],n=a[1]),r.domain(ka(e,n>1?{floor:function(n){for(;s(n=t.floor(n));)n=Fs(n-1);return n},ceil:function(n){for(;s(n=t.ceil(n));)n=Fs(+n+1);return n}}:t))},r.ticks=function(t,n){var e=ma(r.domain()),o=null==t?i(e,10):"number"==typeof t?i(e,t):!t.range&&[{range:t},n];return o&&(t=o[0],n=o[1]),t.range(e[0],Fs(+e[1]+1),n<1?1:n)},r.tickFormat=function(){return e},r.copy=function(){return Vs(t.copy(),n,e)},Ea(r,t)}function Fs(t){return new Date(t)}js.iso=Date.prototype.toISOString&&+new Date("2000-01-01T00:00:00.000Z")?Bs:Gs,Bs.parse=function(t){var n=new Date(t);return isNaN(n)?null:n},Bs.toString=Gs.toString,Rn.second=Bn((function(t){return new jn(1e3*Math.floor(t/1e3))}),(function(t,n){t.setTime(t.getTime()+1e3*Math.floor(n))}),(function(t){return t.getSeconds()})),Rn.seconds=Rn.second.range,Rn.seconds.utc=Rn.second.utc.range,Rn.minute=Bn((function(t){return new jn(6e4*Math.floor(t/6e4))}),(function(t,n){t.setTime(t.getTime()+6e4*Math.floor(n))}),(function(t){return t.getMinutes()})),Rn.minutes=Rn.minute.range,Rn.minutes.utc=Rn.minute.utc.range,Rn.hour=Bn((function(t){var n=t.getTimezoneOffset()/60;return new jn(36e5*(Math.floor(t/36e5-n)+n))}),(function(t,n){t.setTime(t.getTime()+36e5*Math.floor(n))}),(function(t){return t.getHours()})),Rn.hours=Rn.hour.range,Rn.hours.utc=Rn.hour.utc.range,Rn.month=Bn((function(t){return(t=Rn.day(t)).setDate(1),t}),(function(t,n){t.setMonth(t.getMonth()+n)}),(function(t){return t.getMonth()})),Rn.months=Rn.month.range,Rn.months.utc=Rn.month.utc.range;var Us=[1e3,5e3,15e3,3e4,6e4,3e5,9e5,18e5,36e5,108e5,216e5,432e5,864e5,1728e5,6048e5,2592e6,7776e6,31536e6],Hs=[[Rn.second,1],[Rn.second,5],[Rn.second,15],[Rn.second,30],[Rn.minute,1],[Rn.minute,5],[Rn.minute,15],[Rn.minute,30],[Rn.hour,1],[Rn.hour,3],[Rn.hour,6],[Rn.hour,12],[Rn.day,1],[Rn.day,2],[Rn.week,1],[Rn.month,1],[Rn.month,3],[Rn.year,1]],Xs=js.multi([[".%L",function(t){return t.getMilliseconds()}],[":%S",function(t){return t.getSeconds()}],["%I:%M",function(t){return t.getMinutes()}],["%I %p",function(t){return t.getHours()}],["%a %d",function(t){return t.getDay()&&1!=t.getDate()}],["%b %d",function(t){return 1!=t.getDate()}],["%B",function(t){return t.getMonth()}],["%Y",$e]]),Ys={range:function(t,n,e){return o.range(Math.ceil(t/e)*e,+n,e).map(Fs)},floor:I,ceil:I};Hs.year=Rn.year,Rn.scale=function(){return Vs(o.scale.linear(),Hs,Xs)};var Zs=Hs.map((function(t){return[t[0].utc,t[1]]})),Ws=qs.multi([[".%L",function(t){return t.getUTCMilliseconds()}],[":%S",function(t){return t.getUTCSeconds()}],["%I:%M",function(t){return t.getUTCMinutes()}],["%I %p",function(t){return t.getUTCHours()}],["%a %d",function(t){return t.getUTCDay()&&1!=t.getUTCDate()}],["%b %d",function(t){return 1!=t.getUTCDate()}],["%B",function(t){return t.getUTCMonth()}],["%Y",$e]]);function Ks(t){return JSON.parse(t.responseText)}function $s(t){var n=u.createRange();return n.selectNode(u.body),n.createContextualFragment(t.responseText)}Zs.year=Rn.year.utc,Rn.scale.utc=function(){return Vs(o.scale.linear(),Zs,Ws)},o.text=bn((function(t){return t.responseText})),o.json=function(t,n){return wn(t,"application/json",Ks,n)},o.html=function(t,n){return wn(t,"text/html",$s,n)},o.xml=bn((function(t){return t.responseXML})),this.d3=o,void 0===(i="function"==typeof(r=o)?r.call(n,e,n,t):r)||(t.exports=i)}()},function(t,n){function e(t,n){this.x=t||0,this.y=n||0,Object.freeze(this)}e.prototype.distance=function(t){return Math.sqrt(Math.pow(this.x-t.x,2)+Math.pow(this.y-t.y,2))},e.prototype.manhattanDistance=function(t){var n=this.sub(t).abs();return n.x+n.y},e.prototype.abs=function(){return new e(Math.abs(this.x),Math.abs(this.y))},e.prototype.equals=function(t){return this.x===t.x&&this.y===t.y},e.prototype.add=function(t){return new e(this.x+t.x,this.y+t.y)},e.prototype.sub=function(t){return new e(this.x-t.x,this.y-t.y)},t.exports=e},function(t,n,e){var r=e(1);function i(t){arguments.length>0&&this.init(t)}i.prototype.init=function(t){this.status=t,this.points=new Array},i.prototype.appendPoint=function(t){this.points.push(t)},i.prototype.appendPoints=function(t){this.points=this.points.concat(t)},i.intersectShapes=function(t,n){var e,r=t.getIntersectionParams(),o=n.getIntersectionParams();if(null!=r&&null!=o)if("Path"==r.name)e=i.intersectPathShape(t,n);else if("Path"==o.name)e=i.intersectPathShape(n,t);else{var a,s;if(r.name<o.name?(a="intersect"+r.name+o.name,s=r.params.concat(o.params)):(a="intersect"+o.name+r.name,s=o.params.concat(r.params)),!(a in i))throw new Error("Intersection not available: "+a);e=i[a].apply(null,s)}else e=new i("No Intersection");return e},i.intersectPathShape=function(t,n){return t.intersectShape(n)},i.intersectBezier2Bezier2=function(t,n,e,o,a,s){var u,c,l,f,h,p,y,d,v,g=new i("No Intersection");if(u=n.multiply(-2),l=t.add(u.add(e)),u=t.multiply(-2),c=n.multiply(2),f=u.add(c),h=new r(t.x,t.y),u=a.multiply(-2),p=o.add(u.add(s)),u=o.multiply(-2),c=a.multiply(2),y=u.add(c),d=new r(o.x,o.y),0==l.y){var x=(b=l.x*(h.y-d.y))+(w=b-f.x*f.y),m=f.y*f.y;v=new Polynomial(l.x*p.y*p.y,2*l.x*y.y*p.y,l.x*y.y*y.y-p.x*m-p.y*b-p.y*w,-y.x*m-y.y*b-y.y*w,(h.x-d.x)*m+(h.y-d.y)*w)}else{var b=l.x*p.y-l.y*p.x,w=l.x*y.y-y.x*l.y,k=(x=f.x*l.y-f.y*l.x,m=h.y-d.y,l.y*(h.x-d.x)-l.x*m),_=-f.y*x+l.y*k,S=x*x;v=new Polynomial(b*b,2*b*w,(-p.y*S+l.y*w*w+l.y*b*k+b*_)/l.y,(-y.y*S+l.y*w*k+w*_)/l.y,(m*S+k*_)/l.y)}for(var M=v.getRoots(),E=0;E<M.length;E++){var A=M[E];if(0<=A&&A<=1){var L=new Polynomial(l.x,f.x,h.x-d.x-A*y.x-A*A*p.x).getRoots(),P=new Polynomial(l.y,f.y,h.y-d.y-A*y.y-A*A*p.y).getRoots();if(L.length>0&&P.length>0){t:for(var N=0;N<L.length;N++){var C=L[N];if(0<=C&&C<=1)for(var O=0;O<P.length;O++)if(Math.abs(C-P[O])<1e-4){g.points.push(p.multiply(A*A).add(y.multiply(A).add(d)));break t}}}}}return g.points.length>0&&(g.status="Intersection"),g},i.intersectBezier2Bezier3=function(t,n,e,o,a,s,u){var c,l,f,h,p,y,d,v,g,x,m,b=new i("No Intersection");c=n.multiply(-2),p=t.add(c.add(e)),c=t.multiply(-2),l=n.multiply(2),y=c.add(l),d=new r(t.x,t.y),c=o.multiply(-1),l=a.multiply(3),f=s.multiply(-3),h=c.add(l.add(f.add(u))),v=new Vector2D(h.x,h.y),c=o.multiply(3),l=a.multiply(-6),f=s.multiply(3),h=c.add(l.add(f)),g=new Vector2D(h.x,h.y),c=o.multiply(-3),l=a.multiply(3),f=c.add(l),x=new Vector2D(f.x,f.y),m=new Vector2D(o.x,o.y);for(var w=d.x*d.x,k=d.y*d.y,_=y.x*y.x,S=y.y*y.y,M=p.x*p.x,E=p.y*p.y,A=m.x*m.x,L=m.y*m.y,P=x.x*x.x,N=x.y*x.y,C=g.x*g.x,O=g.y*g.y,T=v.x*v.x,I=v.y*v.y,D=new Polynomial(-2*p.x*p.y*v.x*v.y+M*I+E*T,-2*p.x*p.y*g.x*v.y-2*p.x*p.y*g.y*v.x+2*E*g.x*v.x+2*M*g.y*v.y,-2*p.x*x.x*p.y*v.y-2*p.x*p.y*x.y*v.x-2*p.x*p.y*g.x*g.y+2*x.x*E*v.x+E*C+M*(2*x.y*v.y+O),2*d.x*p.x*p.y*v.y+2*d.y*p.x*p.y*v.x+y.x*y.y*p.x*v.y+y.x*y.y*p.y*v.x-2*m.x*p.x*p.y*v.y-2*p.x*m.y*p.y*v.x-2*p.x*x.x*p.y*g.y-2*p.x*p.y*x.y*g.x-2*d.x*E*v.x-2*d.y*M*v.y+2*m.x*E*v.x+2*x.x*E*g.x-S*p.x*v.x-_*p.y*v.y+M*(2*m.y*v.y+2*x.y*g.y),2*d.x*p.x*p.y*g.y+2*d.y*p.x*p.y*g.x+y.x*y.y*p.x*g.y+y.x*y.y*p.y*g.x-2*m.x*p.x*p.y*g.y-2*p.x*m.y*p.y*g.x-2*p.x*x.x*p.y*x.y-2*d.x*E*g.x-2*d.y*M*g.y+2*m.x*E*g.x-S*p.x*g.x-_*p.y*g.y+P*E+M*(2*m.y*g.y+N),2*d.x*p.x*p.y*x.y+2*d.y*p.x*x.x*p.y+y.x*y.y*p.x*x.y+y.x*y.y*x.x*p.y-2*m.x*p.x*p.y*x.y-2*p.x*m.y*x.x*p.y-2*d.x*x.x*E-2*d.y*M*x.y+2*m.x*x.x*E-S*p.x*x.x-_*p.y*x.y+2*M*m.y*x.y,-2*d.x*d.y*p.x*p.y-d.x*y.x*y.y*p.y-d.y*y.x*y.y*p.x+2*d.x*p.x*m.y*p.y+2*d.y*m.x*p.x*p.y+y.x*m.x*y.y*p.y+y.x*y.y*p.x*m.y-2*m.x*p.x*m.y*p.y-2*d.x*m.x*E+d.x*S*p.x+d.y*_*p.y-2*d.y*M*m.y-m.x*S*p.x-_*m.y*p.y+w*E+k*M+A*E+M*L).getRootsInInterval(0,1),z=0;z<D.length;z++){var R=D[z],j=new Polynomial(p.x,y.x,d.x-m.x-R*x.x-R*R*g.x-R*R*R*v.x).getRoots(),q=new Polynomial(p.y,y.y,d.y-m.y-R*x.y-R*R*g.y-R*R*R*v.y).getRoots();if(j.length>0&&q.length>0){t:for(var G=0;G<j.length;G++){var B=j[G];if(0<=B&&B<=1)for(var V=0;V<q.length;V++)if(Math.abs(B-q[V])<1e-4){b.points.push(v.multiply(R*R*R).add(g.multiply(R*R).add(x.multiply(R).add(m))));break t}}}}return b.points.length>0&&(b.status="Intersection"),b},i.intersectBezier2Circle=function(t,n,e,r,o){return i.intersectBezier2Ellipse(t,n,e,r,o,o)},i.intersectBezier2Ellipse=function(t,n,e,o,a,s){var u,c,l,f,h,p=new i("No Intersection");u=n.multiply(-2),l=t.add(u.add(e)),u=t.multiply(-2),c=n.multiply(2),f=u.add(c),h=new r(t.x,t.y);for(var y=a*a,d=s*s,v=new Polynomial(d*l.x*l.x+y*l.y*l.y,2*(d*l.x*f.x+y*l.y*f.y),d*(2*l.x*h.x+f.x*f.x)+y*(2*l.y*h.y+f.y*f.y)-2*(d*o.x*l.x+y*o.y*l.y),2*(d*f.x*(h.x-o.x)+y*f.y*(h.y-o.y)),d*(h.x*h.x+o.x*o.x)+y*(h.y*h.y+o.y*o.y)-2*(d*o.x*h.x+y*o.y*h.y)-y*d).getRoots(),g=0;g<v.length;g++){var x=v[g];0<=x&&x<=1&&p.points.push(l.multiply(x*x).add(f.multiply(x).add(h)))}return p.points.length>0&&(p.status="Intersection"),p},i.intersectBezier2Line=function(t,n,e,o,a){var s,u,c,l,f,h,p,y=o.min(a),d=o.max(a),v=new i("No Intersection");s=n.multiply(-2),c=t.add(s.add(e)),s=t.multiply(-2),u=n.multiply(2),l=s.add(u),f=new r(t.x,t.y),p=new Vector2D(o.y-a.y,a.x-o.x),h=o.x*a.y-a.x*o.y,roots=new Polynomial(p.dot(c),p.dot(l),p.dot(f)+h).getRoots();for(var g=0;g<roots.length;g++){var x=roots[g];if(0<=x&&x<=1){var m=t.lerp(n,x),b=n.lerp(e,x),w=m.lerp(b,x);o.x==a.x?y.y<=w.y&&w.y<=d.y&&(v.status="Intersection",v.appendPoint(w)):o.y==a.y?y.x<=w.x&&w.x<=d.x&&(v.status="Intersection",v.appendPoint(w)):w.gte(y)&&w.lte(d)&&(v.status="Intersection",v.appendPoint(w))}}return v},i.intersectBezier2Polygon=function(t,n,e,r){for(var o=new i("No Intersection"),a=r.length,s=0;s<a;s++){var u=r[s],c=r[(s+1)%a],l=i.intersectBezier2Line(t,n,e,u,c);o.appendPoints(l.points)}return o.points.length>0&&(o.status="Intersection"),o},i.intersectBezier2Rectangle=function(t,n,e,o,a){var s=o.min(a),u=o.max(a),c=new r(u.x,s.y),l=new r(s.x,u.y),f=i.intersectBezier2Line(t,n,e,s,c),h=i.intersectBezier2Line(t,n,e,c,u),p=i.intersectBezier2Line(t,n,e,u,l),y=i.intersectBezier2Line(t,n,e,l,s),d=new i("No Intersection");return d.appendPoints(f.points),d.appendPoints(h.points),d.appendPoints(p.points),d.appendPoints(y.points),d.points.length>0&&(d.status="Intersection"),d},i.intersectBezier3Bezier3=function(t,n,e,r,o,a,s,u){var c,l,f,h,p,y,d,v,g,x,m,b,w=new i("No Intersection");c=t.multiply(-1),l=n.multiply(3),f=e.multiply(-3),h=c.add(l.add(f.add(r))),p=new Vector2D(h.x,h.y),c=t.multiply(3),l=n.multiply(-6),f=e.multiply(3),h=c.add(l.add(f)),y=new Vector2D(h.x,h.y),c=t.multiply(-3),l=n.multiply(3),f=c.add(l),d=new Vector2D(f.x,f.y),v=new Vector2D(t.x,t.y),c=o.multiply(-1),l=a.multiply(3),f=s.multiply(-3),h=c.add(l.add(f.add(u))),g=new Vector2D(h.x,h.y),c=o.multiply(3),l=a.multiply(-6),f=s.multiply(3),h=c.add(l.add(f)),x=new Vector2D(h.x,h.y),c=o.multiply(-3),l=a.multiply(3),f=c.add(l),m=new Vector2D(f.x,f.y),b=new Vector2D(o.x,o.y);for(var k=v.x*v.x,_=v.x*v.x*v.x,S=v.y*v.y,M=v.y*v.y*v.y,E=d.x*d.x,A=d.x*d.x*d.x,L=d.y*d.y,P=d.y*d.y*d.y,N=y.x*y.x,C=y.x*y.x*y.x,O=y.y*y.y,T=y.y*y.y*y.y,I=p.x*p.x,D=p.x*p.x*p.x,z=p.y*p.y,R=p.y*p.y*p.y,j=b.x*b.x,q=b.x*b.x*b.x,G=b.y*b.y,B=b.y*b.y*b.y,V=m.x*m.x,F=m.x*m.x*m.x,U=m.y*m.y,H=x.x*x.x,X=x.x*x.x*x.x,Y=x.y*x.y,Z=g.x*g.x,W=g.x*g.x*g.x,K=g.y*g.y,$=g.y*g.y*g.y,J=new Polynomial(-D*$+R*W-3*p.x*z*Z*g.y+3*I*p.y*g.x*K,-6*p.x*x.x*z*g.x*g.y+6*I*p.y*x.y*g.x*g.y+3*x.x*R*Z-3*D*x.y*K-3*p.x*z*x.y*Z+3*I*x.x*p.y*K,-6*m.x*p.x*z*g.x*g.y-6*p.x*x.x*z*x.y*g.x+6*I*x.x*p.y*x.y*g.y+3*m.x*R*Z+3*H*R*g.x+3*m.x*I*p.y*K-3*p.x*m.y*z*Z-3*p.x*H*z*g.y+I*p.y*g.x*(6*m.y*g.y+3*Y)+D*(-m.y*K-2*Y*g.y-g.y*(2*m.y*g.y+Y)),d.x*y.y*p.x*p.y*g.x*g.y-d.y*y.x*p.x*p.y*g.x*g.y+6*m.x*x.x*R*g.x+3*d.x*y.x*p.x*p.y*K+6*v.x*p.x*z*g.x*g.y-3*d.x*y.x*z*g.x*g.y-3*d.y*y.y*p.x*p.y*Z-6*v.y*I*p.y*g.x*g.y-6*b.x*p.x*z*g.x*g.y+3*d.y*y.y*I*g.x*g.y-2*y.x*O*p.x*g.x*g.y-6*m.x*p.x*x.x*z*g.y-6*m.x*p.x*z*x.y*g.x-6*p.x*m.y*x.x*z*g.x+6*m.x*I*p.y*x.y*g.y+2*N*y.y*p.y*g.x*g.y+X*R-3*v.x*R*Z+3*v.y*D*K+3*b.x*R*Z+T*p.x*Z-C*p.y*K-3*v.x*I*p.y*K+3*v.y*p.x*z*Z-2*d.x*y.y*I*K+d.x*y.y*z*Z-d.y*y.x*I*K+2*d.y*y.x*z*Z+3*b.x*I*p.y*K-y.x*O*p.y*Z-3*b.y*p.x*z*Z+N*y.y*p.x*K-3*p.x*H*z*x.y+I*p.y*g.x*(6*b.y*g.y+6*m.y*x.y)+I*x.x*p.y*(6*m.y*g.y+3*Y)+D*(-2*m.y*x.y*g.y-b.y*K-x.y*(2*m.y*g.y+Y)-g.y*(2*b.y*g.y+2*m.y*x.y)),6*d.x*y.x*p.x*p.y*x.y*g.y+d.x*y.y*p.x*x.x*p.y*g.y+d.x*y.y*p.x*p.y*x.y*g.x-d.y*y.x*p.x*x.x*p.y*g.y-d.y*y.x*p.x*p.y*x.y*g.x-6*d.y*y.y*p.x*x.x*p.y*g.x-6*v.x*x.x*R*g.x+6*b.x*x.x*R*g.x+6*v.y*D*x.y*g.y+2*T*p.x*x.x*g.x-2*C*p.y*x.y*g.y+6*v.x*p.x*x.x*z*g.y+6*v.x*p.x*z*x.y*g.x+6*v.y*p.x*x.x*z*g.x-3*d.x*y.x*x.x*z*g.y-3*d.x*y.x*z*x.y*g.x+2*d.x*y.y*x.x*z*g.x+4*d.y*y.x*x.x*z*g.x-6*v.x*I*p.y*x.y*g.y-6*v.y*I*x.x*p.y*g.y-6*v.y*I*p.y*x.y*g.x-4*d.x*y.y*I*x.y*g.y-6*b.x*p.x*x.x*z*g.y-6*b.x*p.x*z*x.y*g.x-2*d.y*y.x*I*x.y*g.y+3*d.y*y.y*I*x.x*g.y+3*d.y*y.y*I*x.y*g.x-2*y.x*O*p.x*x.x*g.y-2*y.x*O*p.x*x.y*g.x-2*y.x*O*x.x*p.y*g.x-6*b.y*p.x*x.x*z*g.x-6*m.x*p.x*m.y*z*g.x-6*m.x*p.x*x.x*z*x.y+6*b.x*I*p.y*x.y*g.y+2*N*y.y*p.x*x.y*g.y+2*N*y.y*x.x*p.y*g.y+2*N*y.y*p.y*x.y*g.x+3*m.x*H*R+3*V*R*g.x-3*p.x*m.y*H*z-3*V*p.x*z*g.y+I*x.x*p.y*(6*b.y*g.y+6*m.y*x.y)+I*p.y*g.x*(6*b.y*x.y+3*U)+m.x*I*p.y*(6*m.y*g.y+3*Y)+D*(-2*b.y*x.y*g.y-g.y*(2*b.y*x.y+U)-m.y*(2*m.y*g.y+Y)-x.y*(2*b.y*g.y+2*m.y*x.y)),d.x*m.x*y.y*p.x*p.y*g.y+d.x*y.y*p.x*m.y*p.y*g.x+d.x*y.y*p.x*x.x*p.y*x.y-d.y*y.x*m.x*p.x*p.y*g.y-d.y*y.x*p.x*m.y*p.y*g.x-d.y*y.x*p.x*x.x*p.y*x.y-6*d.y*m.x*y.y*p.x*p.y*g.x-6*v.x*m.x*R*g.x+6*b.x*m.x*R*g.x+2*m.x*T*p.x*g.x+6*v.x*m.x*p.x*z*g.y+6*v.x*p.x*m.y*z*g.x+6*v.x*p.x*x.x*z*x.y+6*v.y*m.x*p.x*z*g.x-3*d.x*y.x*m.x*z*g.y-3*d.x*y.x*m.y*z*g.x-3*d.x*y.x*x.x*z*x.y+2*d.x*m.x*y.y*z*g.x+4*d.y*y.x*m.x*z*g.x-6*v.y*m.x*I*p.y*g.y-6*v.y*I*m.y*p.y*g.x-6*v.y*I*x.x*p.y*x.y-6*b.x*m.x*p.x*z*g.y-6*b.x*p.x*m.y*z*g.x-6*b.x*p.x*x.x*z*x.y+3*d.y*m.x*y.y*I*g.y-3*d.y*y.y*p.x*H*p.y+3*d.y*y.y*I*m.y*g.x+3*d.y*y.y*I*x.x*x.y-2*y.x*m.x*O*p.x*g.y-2*y.x*m.x*O*p.y*g.x-2*y.x*O*p.x*m.y*g.x-2*y.x*O*p.x*x.x*x.y-6*b.y*m.x*p.x*z*g.x-6*m.x*p.x*m.y*x.x*z+6*b.y*I*m.y*p.y*g.x+2*N*m.x*y.y*p.y*g.y+2*N*y.y*m.y*p.y*g.x+2*N*y.y*x.x*p.y*x.y-3*v.x*H*R+3*b.x*H*R+3*V*x.x*R+T*p.x*H+3*v.y*p.x*H*z+d.x*y.y*H*z+2*d.y*y.x*H*z-y.x*O*H*p.y-3*b.y*p.x*H*z-3*V*p.x*z*x.y+N*y.y*p.x*(2*m.y*g.y+Y)+d.x*y.x*p.x*p.y*(6*m.y*g.y+3*Y)+m.x*I*p.y*(6*b.y*g.y+6*m.y*x.y)+C*p.y*(-2*m.y*g.y-Y)+v.y*D*(6*m.y*g.y+3*Y)+d.y*y.x*I*(-2*m.y*g.y-Y)+d.x*y.y*I*(-4*m.y*g.y-2*Y)+v.x*I*p.y*(-6*m.y*g.y-3*Y)+I*x.x*p.y*(6*b.y*x.y+3*U)+b.x*I*p.y*(6*m.y*g.y+3*Y)+D*(-2*b.y*m.y*g.y-x.y*(2*b.y*x.y+U)-b.y*(2*m.y*g.y+Y)-m.y*(2*b.y*g.y+2*m.y*x.y)),-v.x*d.x*y.y*p.x*p.y*g.y+v.x*d.y*y.x*p.x*p.y*g.y+6*v.x*d.y*y.y*p.x*p.y*g.x-6*v.y*d.x*y.x*p.x*p.y*g.y-v.y*d.x*y.y*p.x*p.y*g.x+v.y*d.y*y.x*p.x*p.y*g.x+d.x*d.y*y.x*y.y*p.x*g.y-d.x*d.y*y.x*y.y*p.y*g.x+d.x*b.x*y.y*p.x*p.y*g.y+d.x*b.y*y.y*p.x*p.y*g.x+d.x*m.x*y.y*p.x*p.y*x.y+d.x*y.y*p.x*m.y*x.x*p.y-b.x*d.y*y.x*p.x*p.y*g.y-6*b.x*d.y*y.y*p.x*p.y*g.x-d.y*y.x*b.y*p.x*p.y*g.x-d.y*y.x*m.x*p.x*p.y*x.y-d.y*y.x*p.x*m.y*x.x*p.y-6*d.y*m.x*y.y*p.x*x.x*p.y-6*v.x*b.x*R*g.x-6*v.x*m.x*x.x*R-2*v.x*T*p.x*g.x+6*b.x*m.x*x.x*R+2*b.x*T*p.x*g.x+2*m.x*T*p.x*x.x+2*v.y*C*p.y*g.y-6*v.x*v.y*p.x*z*g.x+3*v.x*d.x*y.x*z*g.y-2*v.x*d.x*y.y*z*g.x-4*v.x*d.y*y.x*z*g.x+3*v.y*d.x*y.x*z*g.x+6*v.x*v.y*I*p.y*g.y+6*v.x*b.x*p.x*z*g.y-3*v.x*d.y*y.y*I*g.y+2*v.x*y.x*O*p.x*g.y+2*v.x*y.x*O*p.y*g.x+6*v.x*b.y*p.x*z*g.x+6*v.x*m.x*p.x*z*x.y+6*v.x*p.x*m.y*x.x*z+4*v.y*d.x*y.y*I*g.y+6*v.y*b.x*p.x*z*g.x+2*v.y*d.y*y.x*I*g.y-3*v.y*d.y*y.y*I*g.x+2*v.y*y.x*O*p.x*g.x+6*v.y*m.x*p.x*x.x*z-3*d.x*b.x*y.x*z*g.y+2*d.x*b.x*y.y*z*g.x+d.x*d.y*O*p.x*g.x-3*d.x*y.x*b.y*z*g.x-3*d.x*y.x*m.x*z*x.y-3*d.x*y.x*m.y*x.x*z+2*d.x*m.x*y.y*x.x*z+4*b.x*d.y*y.x*z*g.x+4*d.y*y.x*m.x*x.x*z-2*v.x*N*y.y*p.y*g.y-6*v.y*b.x*I*p.y*g.y-6*v.y*b.y*I*p.y*g.x-6*v.y*m.x*I*p.y*x.y-2*v.y*N*y.y*p.x*g.y-2*v.y*N*y.y*p.y*g.x-6*v.y*I*m.y*x.x*p.y-d.x*d.y*N*p.y*g.y-2*d.x*L*p.x*p.y*g.x+3*b.x*d.y*y.y*I*g.y-2*b.x*y.x*O*p.x*g.y-2*b.x*y.x*O*p.y*g.x-6*b.x*b.y*p.x*z*g.x-6*b.x*m.x*p.x*z*x.y-6*b.x*p.x*m.y*x.x*z+3*d.y*b.y*y.y*I*g.x+3*d.y*m.x*y.y*I*x.y+3*d.y*y.y*I*m.y*x.x-2*y.x*b.y*O*p.x*g.x-2*y.x*m.x*O*p.x*x.y-2*y.x*m.x*O*x.x*p.y-2*y.x*O*p.x*m.y*x.x-6*b.y*m.x*p.x*x.x*z-L*y.x*y.y*p.x*g.x+2*b.x*N*y.y*p.y*g.y+6*b.y*I*m.y*x.x*p.y+2*E*d.y*p.x*p.y*g.y+E*y.x*y.y*p.y*g.y+2*N*b.y*y.y*p.y*g.x+2*N*m.x*y.y*p.y*x.y+2*N*y.y*m.y*x.x*p.y+F*R+3*k*R*g.x-3*S*D*g.y+3*j*R*g.x+P*I*g.x-A*z*g.y-d.x*L*I*g.y+E*d.y*z*g.x-3*k*p.x*z*g.y+3*S*I*p.y*g.x-E*O*p.x*g.y+L*N*p.y*g.x-3*V*p.x*m.y*z-3*j*p.x*z*g.y+3*G*I*p.y*g.x+d.x*y.x*p.x*p.y*(6*b.y*g.y+6*m.y*x.y)+C*p.y*(-2*b.y*g.y-2*m.y*x.y)+v.y*D*(6*b.y*g.y+6*m.y*x.y)+d.y*y.x*I*(-2*b.y*g.y-2*m.y*x.y)+N*y.y*p.x*(2*b.y*g.y+2*m.y*x.y)+d.x*y.y*I*(-4*b.y*g.y-4*m.y*x.y)+v.x*I*p.y*(-6*b.y*g.y-6*m.y*x.y)+b.x*I*p.y*(6*b.y*g.y+6*m.y*x.y)+m.x*I*p.y*(6*b.y*x.y+3*U)+D*(-2*b.y*m.y*x.y-G*g.y-m.y*(2*b.y*x.y+U)-b.y*(2*b.y*g.y+2*m.y*x.y)),-v.x*d.x*y.y*p.x*p.y*x.y+v.x*d.y*y.x*p.x*p.y*x.y+6*v.x*d.y*y.y*p.x*x.x*p.y-6*v.y*d.x*y.x*p.x*p.y*x.y-v.y*d.x*y.y*p.x*x.x*p.y+v.y*d.y*y.x*p.x*x.x*p.y+d.x*d.y*y.x*y.y*p.x*x.y-d.x*d.y*y.x*y.y*x.x*p.y+d.x*b.x*y.y*p.x*p.y*x.y+d.x*b.y*y.y*p.x*x.x*p.y+d.x*m.x*y.y*p.x*m.y*p.y-b.x*d.y*y.x*p.x*p.y*x.y-6*b.x*d.y*y.y*p.x*x.x*p.y-d.y*y.x*b.y*p.x*x.x*p.y-d.y*y.x*m.x*p.x*m.y*p.y-6*v.x*b.x*x.x*R-2*v.x*T*p.x*x.x+2*b.x*T*p.x*x.x+2*v.y*C*p.y*x.y-6*v.x*v.y*p.x*x.x*z+3*v.x*d.x*y.x*z*x.y-2*v.x*d.x*y.y*x.x*z-4*v.x*d.y*y.x*x.x*z+3*v.y*d.x*y.x*x.x*z+6*v.x*v.y*I*p.y*x.y+6*v.x*b.x*p.x*z*x.y-3*v.x*d.y*y.y*I*x.y+2*v.x*y.x*O*p.x*x.y+2*v.x*y.x*O*x.x*p.y+6*v.x*b.y*p.x*x.x*z+6*v.x*m.x*p.x*m.y*z+4*v.y*d.x*y.y*I*x.y+6*v.y*b.x*p.x*x.x*z+2*v.y*d.y*y.x*I*x.y-3*v.y*d.y*y.y*I*x.x+2*v.y*y.x*O*p.x*x.x-3*d.x*b.x*y.x*z*x.y+2*d.x*b.x*y.y*x.x*z+d.x*d.y*O*p.x*x.x-3*d.x*y.x*b.y*x.x*z-3*d.x*y.x*m.x*m.y*z+4*b.x*d.y*y.x*x.x*z-2*v.x*N*y.y*p.y*x.y-6*v.y*b.x*I*p.y*x.y-6*v.y*b.y*I*x.x*p.y-6*v.y*m.x*I*m.y*p.y-2*v.y*N*y.y*p.x*x.y-2*v.y*N*y.y*x.x*p.y-d.x*d.y*N*p.y*x.y-2*d.x*L*p.x*x.x*p.y+3*b.x*d.y*y.y*I*x.y-2*b.x*y.x*O*p.x*x.y-2*b.x*y.x*O*x.x*p.y-6*b.x*b.y*p.x*x.x*z-6*b.x*m.x*p.x*m.y*z+3*d.y*b.y*y.y*I*x.x+3*d.y*m.x*y.y*I*m.y-2*y.x*b.y*O*p.x*x.x-2*y.x*m.x*O*p.x*m.y-L*y.x*y.y*p.x*x.x+2*b.x*N*y.y*p.y*x.y-3*d.y*V*y.y*p.x*p.y+6*b.y*m.x*I*m.y*p.y+2*E*d.y*p.x*p.y*x.y+E*y.x*y.y*p.y*x.y+2*N*b.y*y.y*x.x*p.y+2*N*m.x*y.y*m.y*p.y-3*v.x*V*R+3*b.x*V*R+3*k*x.x*R-3*S*D*x.y+3*j*x.x*R+V*T*p.x+P*I*x.x-A*z*x.y+3*v.y*V*p.x*z-d.x*L*I*x.y+d.x*V*y.y*z+2*d.y*y.x*V*z+E*d.y*x.x*z-y.x*V*O*p.y-3*b.y*V*p.x*z-3*k*p.x*z*x.y+3*S*I*x.x*p.y-E*O*p.x*x.y+L*N*x.x*p.y-3*j*p.x*z*x.y+3*G*I*x.x*p.y+N*y.y*p.x*(2*b.y*x.y+U)+d.x*y.x*p.x*p.y*(6*b.y*x.y+3*U)+C*p.y*(-2*b.y*x.y-U)+v.y*D*(6*b.y*x.y+3*U)+d.y*y.x*I*(-2*b.y*x.y-U)+d.x*y.y*I*(-4*b.y*x.y-2*U)+v.x*I*p.y*(-6*b.y*x.y-3*U)+b.x*I*p.y*(6*b.y*x.y+3*U)+D*(-2*b.y*U-G*x.y-b.y*(2*b.y*x.y+U)),-v.x*d.x*y.y*p.x*m.y*p.y+v.x*d.y*y.x*p.x*m.y*p.y+6*v.x*d.y*m.x*y.y*p.x*p.y-6*v.y*d.x*y.x*p.x*m.y*p.y-v.y*d.x*m.x*y.y*p.x*p.y+v.y*d.y*y.x*m.x*p.x*p.y-d.x*d.y*y.x*m.x*y.y*p.y+d.x*d.y*y.x*y.y*p.x*m.y+d.x*b.x*y.y*p.x*m.y*p.y+6*d.x*y.x*b.y*p.x*m.y*p.y+d.x*b.y*m.x*y.y*p.x*p.y-b.x*d.y*y.x*p.x*m.y*p.y-6*b.x*d.y*m.x*y.y*p.x*p.y-d.y*y.x*b.y*m.x*p.x*p.y-6*v.x*b.x*m.x*R-2*v.x*m.x*T*p.x+6*v.y*b.y*D*m.y+2*b.x*m.x*T*p.x+2*v.y*C*m.y*p.y-2*C*b.y*m.y*p.y-6*v.x*v.y*m.x*p.x*z+3*v.x*d.x*y.x*m.y*z-2*v.x*d.x*m.x*y.y*z-4*v.x*d.y*y.x*m.x*z+3*v.y*d.x*y.x*m.x*z+6*v.x*v.y*I*m.y*p.y+6*v.x*b.x*p.x*m.y*z-3*v.x*d.y*y.y*I*m.y+2*v.x*y.x*m.x*O*p.y+2*v.x*y.x*O*p.x*m.y+6*v.x*b.y*m.x*p.x*z+4*v.y*d.x*y.y*I*m.y+6*v.y*b.x*m.x*p.x*z+2*v.y*d.y*y.x*I*m.y-3*v.y*d.y*m.x*y.y*I+2*v.y*y.x*m.x*O*p.x-3*d.x*b.x*y.x*m.y*z+2*d.x*b.x*m.x*y.y*z+d.x*d.y*m.x*O*p.x-3*d.x*y.x*b.y*m.x*z+4*b.x*d.y*y.x*m.x*z-6*v.x*b.y*I*m.y*p.y-2*v.x*N*y.y*m.y*p.y-6*v.y*b.x*I*m.y*p.y-6*v.y*b.y*m.x*I*p.y-2*v.y*N*m.x*y.y*p.y-2*v.y*N*y.y*p.x*m.y-d.x*d.y*N*m.y*p.y-4*d.x*b.y*y.y*I*m.y-2*d.x*L*m.x*p.x*p.y+3*b.x*d.y*y.y*I*m.y-2*b.x*y.x*m.x*O*p.y-2*b.x*y.x*O*p.x*m.y-6*b.x*b.y*m.x*p.x*z-2*d.y*y.x*b.y*I*m.y+3*d.y*b.y*m.x*y.y*I-2*y.x*b.y*m.x*O*p.x-L*y.x*m.x*y.y*p.x+6*b.x*b.y*I*m.y*p.y+2*b.x*N*y.y*m.y*p.y+2*E*d.y*p.x*m.y*p.y+E*y.x*y.y*m.y*p.y+2*N*b.y*m.x*y.y*p.y+2*N*b.y*y.y*p.x*m.y+3*k*m.x*R-3*S*D*m.y+3*j*m.x*R+P*m.x*I-A*m.y*z-3*G*D*m.y-d.x*L*I*m.y+E*d.y*m.x*z-3*k*p.x*m.y*z+3*S*m.x*I*p.y-E*O*p.x*m.y+L*N*m.x*p.y-3*j*p.x*m.y*z+3*G*m.x*I*p.y,v.x*v.y*d.x*y.y*p.x*p.y-v.x*v.y*d.y*y.x*p.x*p.y+v.x*d.x*d.y*y.x*y.y*p.y-v.y*d.x*d.y*y.x*y.y*p.x-v.x*d.x*b.y*y.y*p.x*p.y+6*v.x*b.x*d.y*y.y*p.x*p.y+v.x*d.y*y.x*b.y*p.x*p.y-v.y*d.x*b.x*y.y*p.x*p.y-6*v.y*d.x*y.x*b.y*p.x*p.y+v.y*b.x*d.y*y.x*p.x*p.y-d.x*b.x*d.y*y.x*y.y*p.y+d.x*d.y*y.x*b.y*y.y*p.x+d.x*b.x*b.y*y.y*p.x*p.y-b.x*d.y*y.x*b.y*p.x*p.y-2*v.x*b.x*T*p.x+2*v.y*C*b.y*p.y-3*v.x*v.y*d.x*y.x*z-6*v.x*v.y*b.x*p.x*z+3*v.x*v.y*d.y*y.y*I-2*v.x*v.y*y.x*O*p.x-2*v.x*d.x*b.x*y.y*z-v.x*d.x*d.y*O*p.x+3*v.x*d.x*y.x*b.y*z-4*v.x*b.x*d.y*y.x*z+3*v.y*d.x*b.x*y.x*z+6*v.x*v.y*b.y*I*p.y+2*v.x*v.y*N*y.y*p.y+2*v.x*d.x*L*p.x*p.y+2*v.x*b.x*y.x*O*p.y+6*v.x*b.x*b.y*p.x*z-3*v.x*d.y*b.y*y.y*I+2*v.x*y.x*b.y*O*p.x+v.x*L*y.x*y.y*p.x+v.y*d.x*d.y*N*p.y+4*v.y*d.x*b.y*y.y*I-3*v.y*b.x*d.y*y.y*I+2*v.y*b.x*y.x*O*p.x+2*v.y*d.y*y.x*b.y*I+d.x*b.x*d.y*O*p.x-3*d.x*b.x*y.x*b.y*z-2*v.x*N*b.y*y.y*p.y-6*v.y*b.x*b.y*I*p.y-2*v.y*b.x*N*y.y*p.y-2*v.y*E*d.y*p.x*p.y-v.y*E*y.x*y.y*p.y-2*v.y*N*b.y*y.y*p.x-2*d.x*b.x*L*p.x*p.y-d.x*d.y*N*b.y*p.y+3*b.x*d.y*b.y*y.y*I-2*b.x*y.x*b.y*O*p.x-b.x*L*y.x*y.y*p.x+3*S*d.x*y.x*p.x*p.y+3*d.x*y.x*G*p.x*p.y+2*b.x*N*b.y*y.y*p.y-3*k*d.y*y.y*p.x*p.y+2*E*d.y*b.y*p.x*p.y+E*y.x*b.y*y.y*p.y-3*j*d.y*y.y*p.x*p.y-_*R+M*D+q*R-B*D-3*v.x*j*R-v.x*P*I+3*k*b.x*R+v.y*A*z+3*v.y*G*D+b.x*P*I+k*T*p.x-3*S*b.y*D-S*C*p.y+j*T*p.x-A*b.y*z-C*G*p.y-v.x*E*d.y*z+v.y*d.x*L*I-3*v.x*S*I*p.y-v.x*L*N*p.y+v.y*E*O*p.x-d.x*L*b.y*I+3*k*v.y*p.x*z+k*d.x*y.y*z+2*k*d.y*y.x*z-2*S*d.x*y.y*I-S*d.y*y.x*I+E*b.x*d.y*z-3*v.x*G*I*p.y+3*v.y*j*p.x*z+d.x*j*y.y*z-2*d.x*G*y.y*I+b.x*L*N*p.y-d.y*y.x*G*I-k*y.x*O*p.y-3*k*b.y*p.x*z+3*S*b.x*I*p.y+S*N*y.y*p.x-E*b.y*O*p.x+2*j*d.y*y.x*z+3*b.x*G*I*p.y-j*y.x*O*p.y-3*j*b.y*p.x*z+N*G*y.y*p.x).getRootsInInterval(0,1),Q=0;Q<J.length;Q++){var tt=J[Q],nt=new Polynomial(p.x,y.x,d.x,v.x-b.x-tt*m.x-tt*tt*x.x-tt*tt*tt*g.x).getRoots(),et=new Polynomial(p.y,y.y,d.y,v.y-b.y-tt*m.y-tt*tt*x.y-tt*tt*tt*g.y).getRoots();if(nt.length>0&&et.length>0){t:for(var rt=0;rt<nt.length;rt++){var it=nt[rt];if(0<=it&&it<=1)for(var ot=0;ot<et.length;ot++)if(Math.abs(it-et[ot])<1e-4){w.points.push(g.multiply(tt*tt*tt).add(x.multiply(tt*tt).add(m.multiply(tt).add(b))));break t}}}}return w.points.length>0&&(w.status="Intersection"),w},i.intersectBezier3Circle=function(t,n,e,r,o,a){return i.intersectBezier3Ellipse(t,n,e,r,o,a,a)},i.intersectBezier3Ellipse=function(t,n,e,r,o,a,s){var u,c,l,f,h,p,y,d,v=new i("No Intersection");u=t.multiply(-1),c=n.multiply(3),l=e.multiply(-3),f=u.add(c.add(l.add(r))),h=new Vector2D(f.x,f.y),u=t.multiply(3),c=n.multiply(-6),l=e.multiply(3),f=u.add(c.add(l)),p=new Vector2D(f.x,f.y),u=t.multiply(-3),c=n.multiply(3),l=u.add(c),y=new Vector2D(l.x,l.y),d=new Vector2D(t.x,t.y);for(var g=a*a,x=s*s,m=new Polynomial(h.x*h.x*x+h.y*h.y*g,2*(h.x*p.x*x+h.y*p.y*g),2*(h.x*y.x*x+h.y*y.y*g)+p.x*p.x*x+p.y*p.y*g,2*h.x*x*(d.x-o.x)+2*h.y*g*(d.y-o.y)+2*(p.x*y.x*x+p.y*y.y*g),2*p.x*x*(d.x-o.x)+2*p.y*g*(d.y-o.y)+y.x*y.x*x+y.y*y.y*g,2*y.x*x*(d.x-o.x)+2*y.y*g*(d.y-o.y),d.x*d.x*x-2*d.y*o.y*g-2*d.x*o.x*x+d.y*d.y*g+o.x*o.x*x+o.y*o.y*g-g*x).getRootsInInterval(0,1),b=0;b<m.length;b++){var w=m[b];v.points.push(h.multiply(w*w*w).add(p.multiply(w*w).add(y.multiply(w).add(d))))}return v.points.length>0&&(v.status="Intersection"),v},i.intersectBezier3Line=function(t,n,e,r,o,a){var s,u,c,l,f,h,p,y,d,v,g=o.min(a),x=o.max(a),m=new i("No Intersection");s=t.multiply(-1),u=n.multiply(3),c=e.multiply(-3),l=s.add(u.add(c.add(r))),f=new Vector2D(l.x,l.y),s=t.multiply(3),u=n.multiply(-6),c=e.multiply(3),l=s.add(u.add(c)),h=new Vector2D(l.x,l.y),s=t.multiply(-3),u=n.multiply(3),c=s.add(u),p=new Vector2D(c.x,c.y),y=new Vector2D(t.x,t.y),v=new Vector2D(o.y-a.y,a.x-o.x),d=o.x*a.y-a.x*o.y,roots=new Polynomial(v.dot(f),v.dot(h),v.dot(p),v.dot(y)+d).getRoots();for(var b=0;b<roots.length;b++){var w=roots[b];if(0<=w&&w<=1){var k=t.lerp(n,w),_=n.lerp(e,w),S=e.lerp(r,w),M=k.lerp(_,w),E=_.lerp(S,w),A=M.lerp(E,w);o.x==a.x?g.y<=A.y&&A.y<=x.y&&(m.status="Intersection",m.appendPoint(A)):o.y==a.y?g.x<=A.x&&A.x<=x.x&&(m.status="Intersection",m.appendPoint(A)):A.gte(g)&&A.lte(x)&&(m.status="Intersection",m.appendPoint(A))}}return m},i.intersectBezier3Polygon=function(t,n,e,r,o){for(var a=new i("No Intersection"),s=o.length,u=0;u<s;u++){var c=o[u],l=o[(u+1)%s],f=i.intersectBezier3Line(t,n,e,r,c,l);a.appendPoints(f.points)}return a.points.length>0&&(a.status="Intersection"),a},i.intersectBezier3Rectangle=function(t,n,e,o,a,s){var u=a.min(s),c=a.max(s),l=new r(c.x,u.y),f=new r(u.x,c.y),h=i.intersectBezier3Line(t,n,e,o,u,l),p=i.intersectBezier3Line(t,n,e,o,l,c),y=i.intersectBezier3Line(t,n,e,o,c,f),d=i.intersectBezier3Line(t,n,e,o,f,u),v=new i("No Intersection");return v.appendPoints(h.points),v.appendPoints(p.points),v.appendPoints(y.points),v.appendPoints(d.points),v.points.length>0&&(v.status="Intersection"),v},i.intersectCircleCircle=function(t,n,e,o){var a,s=n+o,u=Math.abs(n-o),c=t.distanceFrom(e);if(c>s)a=new i("Outside");else if(c<u)a=new i("Inside");else{a=new i("Intersection");var l=(n*n-o*o+c*c)/(2*c),f=Math.sqrt(n*n-l*l),h=t.lerp(e,l/c),p=f/c;a.points.push(new r(h.x-p*(e.y-t.y),h.y+p*(e.x-t.x))),a.points.push(new r(h.x+p*(e.y-t.y),h.y-p*(e.x-t.x)))}return a},i.intersectCircleEllipse=function(t,n,e,r,o){return i.intersectEllipseEllipse(t,n,n,e,r,o)},i.intersectCircleLine=function(t,n,e,r){var o,a=(r.x-e.x)*(r.x-e.x)+(r.y-e.y)*(r.y-e.y),s=2*((r.x-e.x)*(e.x-t.x)+(r.y-e.y)*(e.y-t.y)),u=s*s-4*a*(t.x*t.x+t.y*t.y+e.x*e.x+e.y*e.y-2*(t.x*e.x+t.y*e.y)-n*n);if(u<0)o=new i("Outside");else if(0==u)o=new i("Tangent");else{var c=Math.sqrt(u),l=(-s+c)/(2*a),f=(-s-c)/(2*a);(l<0||l>1)&&(f<0||f>1)?o=new i(l<0&&f<0||l>1&&f>1?"Outside":"Inside"):(o=new i("Intersection"),0<=l&&l<=1&&o.points.push(e.lerp(r,l)),0<=f&&f<=1&&o.points.push(e.lerp(r,f)))}return o},i.intersectCirclePolygon=function(t,n,e){for(var r,o=new i("No Intersection"),a=e.length,s=0;s<a;s++){var u=e[s],c=e[(s+1)%a];r=i.intersectCircleLine(t,n,u,c),o.appendPoints(r.points)}return o.points.length>0?o.status="Intersection":o.status=r.status,o},i.intersectCircleRectangle=function(t,n,e,o){var a=e.min(o),s=e.max(o),u=new r(s.x,a.y),c=new r(a.x,s.y),l=i.intersectCircleLine(t,n,a,u),f=i.intersectCircleLine(t,n,u,s),h=i.intersectCircleLine(t,n,s,c),p=i.intersectCircleLine(t,n,c,a),y=new i("No Intersection");return y.appendPoints(l.points),y.appendPoints(f.points),y.appendPoints(h.points),y.appendPoints(p.points),y.points.length>0?y.status="Intersection":y.status=l.status,y},i.intersectEllipseEllipse=function(t,n,e,o,a,s){for(var u=[e*e,0,n*n,-2*e*e*t.x,-2*n*n*t.y,e*e*t.x*t.x+n*n*t.y*t.y-n*n*e*e],c=[s*s,0,a*a,-2*s*s*o.x,-2*a*a*o.y,s*s*o.x*o.x+a*a*o.y*o.y-a*a*s*s],l=i.bezout(u,c).getRoots(),f=.001*(u[0]*u[0]+2*u[1]*u[1]+u[2]*u[2]),h=.001*(c[0]*c[0]+2*c[1]*c[1]+c[2]*c[2]),p=new i("No Intersection"),y=0;y<l.length;y++)for(var d=new Polynomial(u[0],u[3]+l[y]*u[1],u[5]+l[y]*(u[4]+l[y]*u[2])).getRoots(),v=0;v<d.length;v++){var g=(u[0]*d[v]+u[1]*l[y]+u[3])*d[v]+(u[2]*l[y]+u[4])*l[y]+u[5];Math.abs(g)<f&&(g=(c[0]*d[v]+c[1]*l[y]+c[3])*d[v]+(c[2]*l[y]+c[4])*l[y]+c[5],Math.abs(g)<h&&p.appendPoint(new r(d[v],l[y])))}return p.points.length>0&&(p.status="Intersection"),p},i.intersectEllipseLine=function(t,n,e,r,o){var a,s=new Vector2D(r.x,r.y),u=Vector2D.fromPoints(r,o),c=new Vector2D(t.x,t.y),l=s.subtract(c),f=new Vector2D(u.x/(n*n),u.y/(e*e)),h=new Vector2D(l.x/(n*n),l.y/(e*e)),p=u.dot(f),y=u.dot(h),d=y*y-p*(t=l.dot(h)-1);if(d<0)a=new i("Outside");else if(d>0){var v=Math.sqrt(d),g=(-y-v)/p,x=(-y+v)/p;(g<0||1<g)&&(x<0||1<x)?a=new i(g<0&&x<0||g>1&&x>1?"Outside":"Inside"):(a=new i("Intersection"),0<=g&&g<=1&&a.appendPoint(r.lerp(o,g)),0<=x&&x<=1&&a.appendPoint(r.lerp(o,x)))}else{var m=-y/p;0<=m&&m<=1?(a=new i("Intersection")).appendPoint(r.lerp(o,m)):a=new i("Outside")}return a},i.intersectEllipsePolygon=function(t,n,e,r){for(var o=new i("No Intersection"),a=r.length,s=0;s<a;s++){var u=r[s],c=r[(s+1)%a],l=i.intersectEllipseLine(t,n,e,u,c);o.appendPoints(l.points)}return o.points.length>0&&(o.status="Intersection"),o},i.intersectEllipseRectangle=function(t,n,e,o,a){var s=o.min(a),u=o.max(a),c=new r(u.x,s.y),l=new r(s.x,u.y),f=i.intersectEllipseLine(t,n,e,s,c),h=i.intersectEllipseLine(t,n,e,c,u),p=i.intersectEllipseLine(t,n,e,u,l),y=i.intersectEllipseLine(t,n,e,l,s),d=new i("No Intersection");return d.appendPoints(f.points),d.appendPoints(h.points),d.appendPoints(p.points),d.appendPoints(y.points),d.points.length>0&&(d.status="Intersection"),d},i.intersectLineLine=function(t,n,e,o){var a,s=(o.x-e.x)*(t.y-e.y)-(o.y-e.y)*(t.x-e.x),u=(n.x-t.x)*(t.y-e.y)-(n.y-t.y)*(t.x-e.x),c=(o.y-e.y)*(n.x-t.x)-(o.x-e.x)*(n.y-t.y);if(0!=c){var l=s/c,f=u/c;0<=l&&l<=1&&0<=f&&f<=1?(a=new i("Intersection")).points.push(new r(t.x+l*(n.x-t.x),t.y+l*(n.y-t.y))):a=new i("No Intersection")}else a=new i(0==s||0==u?"Coincident":"Parallel");return a},i.intersectLinePolygon=function(t,n,e){for(var r=new i("No Intersection"),o=e.length,a=0;a<o;a++){var s=e[a],u=e[(a+1)%o],c=i.intersectLineLine(t,n,s,u);r.appendPoints(c.points)}return r.points.length>0&&(r.status="Intersection"),r},i.intersectLineRectangle=function(t,n,e,o){var a=e.min(o),s=e.max(o),u=new r(s.x,a.y),c=new r(a.x,s.y),l=i.intersectLineLine(a,u,t,n),f=i.intersectLineLine(u,s,t,n),h=i.intersectLineLine(s,c,t,n),p=i.intersectLineLine(c,a,t,n),y=new i("No Intersection");return y.appendPoints(l.points),y.appendPoints(f.points),y.appendPoints(h.points),y.appendPoints(p.points),y.points.length>0&&(y.status="Intersection"),y},i.intersectPolygonPolygon=function(t,n){for(var e=new i("No Intersection"),r=t.length,o=0;o<r;o++){var a=t[o],s=t[(o+1)%r],u=i.intersectLinePolygon(a,s,n);e.appendPoints(u.points)}return e.points.length>0&&(e.status="Intersection"),e},i.intersectPolygonRectangle=function(t,n,e){var o=n.min(e),a=n.max(e),s=new r(a.x,o.y),u=new r(o.x,a.y),c=i.intersectLinePolygon(o,s,t),l=i.intersectLinePolygon(s,a,t),f=i.intersectLinePolygon(a,u,t),h=i.intersectLinePolygon(u,o,t),p=new i("No Intersection");return p.appendPoints(c.points),p.appendPoints(l.points),p.appendPoints(f.points),p.appendPoints(h.points),p.points.length>0&&(p.status="Intersection"),p},i.intersectRayRay=function(t,n,e,o){var a,s=(o.x-e.x)*(t.y-e.y)-(o.y-e.y)*(t.x-e.x),u=(n.x-t.x)*(t.y-e.y)-(n.y-t.y)*(t.x-e.x),c=(o.y-e.y)*(n.x-t.x)-(o.x-e.x)*(n.y-t.y);if(0!=c){var l=s/c;(a=new i("Intersection")).points.push(new r(t.x+l*(n.x-t.x),t.y+l*(n.y-t.y)))}else a=new i(0==s||0==u?"Coincident":"Parallel");return a},i.intersectRectangleRectangle=function(t,n,e,o){var a=t.min(n),s=t.max(n),u=new r(s.x,a.y),c=new r(a.x,s.y),l=i.intersectLineRectangle(a,u,e,o),f=i.intersectLineRectangle(u,s,e,o),h=i.intersectLineRectangle(s,c,e,o),p=i.intersectLineRectangle(c,a,e,o),y=new i("No Intersection");return y.appendPoints(l.points),y.appendPoints(f.points),y.appendPoints(h.points),y.appendPoints(p.points),y.points.length>0&&(y.status="Intersection"),y},i.bezout=function(t,n){var e=t[0]*n[1]-n[0]*t[1],r=t[0]*n[2]-n[0]*t[2],i=t[0]*n[3]-n[0]*t[3],o=t[0]*n[4]-n[0]*t[4],a=t[0]*n[5]-n[0]*t[5],s=t[1]*n[2]-n[1]*t[2],u=t[1]*n[4]-n[1]*t[4],c=t[1]*n[5]-n[1]*t[5],l=t[2]*n[3]-n[2]*t[3],f=t[3]*n[4]-n[3]*t[4],h=t[3]*n[5]-n[3]*t[5],p=c+f,y=u-l;return new Polynomial(e*s-r*r,e*y+i*s-2*r*o,e*p+i*y-o*o-2*r*a,e*h+i*p-2*o*a,i*h-a*a)},t.exports=i},function(t,n,e){t.exports=function(){"use strict";var t={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"},n=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(t){return[parseInt(t[1],10),parseInt(t[2],10),parseInt(t[3],10)]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(t){return[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(t){return[parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),parseInt(t[3]+t[3],16)]}}],e=function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,n){var e=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(e.push(a.value),!n||e.length!==n);r=!0);}catch(t){i=!0,o=t}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return e}(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")},r=function(){function t(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(n,e,r){return e&&t(n.prototype,e),r&&t(n,r),n}}(),i=function(){function i(r){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,i);var o=r;if(this.ok=!1,"string"==typeof o){"#"===o.charAt(0)&&(o=o.substr(1,6)),o=o.replace(/ /g,"").toLowerCase(),Object.prototype.hasOwnProperty.call(t,o)&&(o=t[o]);for(var a=0;a<n.length;a+=1){var s=n[a],u=s.re.exec(o);if(u){var c=s.process(u),l=e(c,3);this.r=l[0],this.g=l[1],this.b=l[2],this.ok=!0}}this.r<0||Number.isNaN(this.r)||void 0===this.r?this.r=0:this.r>255&&(this.r=255),this.g<0||Number.isNaN(this.g)||void 0===this.g?this.g=0:this.g>255&&(this.g=255),this.b<0||Number.isNaN(this.b)||void 0===this.b?this.b=0:this.b>255&&(this.b=255)}}return r(i,[{key:"isValid",value:function(){return this.ok}},{key:"rgb",value:function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"}},{key:"hex",value:function(){var t=this.r.toString(16),n=this.g.toString(16),e=this.b.toString(16);return 1===t.length&&(t="0"+t),1===n.length&&(n="0"+n),1===e.length&&(e="0"+e),"#"+t+n+e}},{key:"channels",value:function(){return{r:this.r,g:this.g,b:this.b}}}]),i}();return function(t){return new i(t)}}()},function(t,n,e){"use strict";t.exports=function(t){var n=[];return n.toString=function(){return this.map((function(n){var e=t(n);return n[2]?"@media ".concat(n[2]," {").concat(e,"}"):e})).join("")},n.i=function(t,e,r){"string"==typeof t&&(t=[[null,t,""]]);var i={};if(r)for(var o=0;o<this.length;o++){var a=this[o][0];null!=a&&(i[a]=!0)}for(var s=0;s<t.length;s++){var u=[].concat(t[s]);r&&i[u[0]]||(e&&(u[2]?u[2]="".concat(e," and ").concat(u[2]):u[2]=e),n.push(u))}},n}},function(t){t.exports=JSON.parse('{"a":"2.1.10"}')},function(t,n,e){var r,i,o,a;function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}a=function(){return function t(n,e,r){function i(a,s){if(!e[a]){if(!n[a]){if(o)return o(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var c=e[a]={exports:{}};n[a][0].call(c.exports,(function(t){return i(n[a][1][t]||t)}),c,c.exports,t,n,e,r)}return e[a].exports}for(var o=!1,a=0;a<r.length;a++)i(r[a]);return i}({1:[function(t,n,e){"use strict";function r(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0}),r(t("./src/adaptor")),r(t("./src/d3adaptor")),r(t("./src/descent")),r(t("./src/geom")),r(t("./src/gridrouter")),r(t("./src/handledisconnected")),r(t("./src/layout")),r(t("./src/layout3d")),r(t("./src/linklengths")),r(t("./src/powergraph")),r(t("./src/pqueue")),r(t("./src/rbtree")),r(t("./src/rectangle")),r(t("./src/shortestpaths")),r(t("./src/vpsc")),r(t("./src/batch"))},{"./src/adaptor":2,"./src/batch":3,"./src/d3adaptor":4,"./src/descent":7,"./src/geom":8,"./src/gridrouter":9,"./src/handledisconnected":10,"./src/layout":11,"./src/layout3d":12,"./src/linklengths":13,"./src/powergraph":14,"./src/pqueue":15,"./src/rbtree":16,"./src/rectangle":17,"./src/shortestpaths":18,"./src/vpsc":19}],2:[function(t,n,e){"use strict";var r,i=this&&this.__extends||(r=function(t,n){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(t,n)},function(t,n){function e(){this.constructor=t}r(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)});Object.defineProperty(e,"__esModule",{value:!0});var o=t("./layout"),a=function(t){function n(n){var e=t.call(this)||this,r=n;return r.trigger&&(e.trigger=r.trigger),r.kick&&(e.kick=r.kick),r.drag&&(e.drag=r.drag),r.on&&(e.on=r.on),e.dragstart=e.dragStart=o.Layout.dragStart,e.dragend=e.dragEnd=o.Layout.dragEnd,e}return i(n,t),n.prototype.trigger=function(t){},n.prototype.kick=function(){},n.prototype.drag=function(){},n.prototype.on=function(t,n){return this},n}(o.Layout);e.LayoutAdaptor=a,e.adaptor=function(t){return new a(t)}},{"./layout":11}],3:[function(t,n,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=t("./layout"),i=t("./gridrouter");e.gridify=function(t,n,e,r){return t.cola.start(0,0,0,10,!1),function(t,n,e,r){t.forEach((function(t){t.routerNode={name:t.name,bounds:t.bounds.inflate(-e)}})),n.forEach((function(n){n.routerNode={bounds:n.bounds.inflate(-r),children:(void 0!==n.groups?n.groups.map((function(n){return t.length+n.id})):[]).concat(void 0!==n.leaves?n.leaves.map((function(t){return t.index})):[])}}));var o=t.concat(n).map((function(t,n){return t.routerNode.id=n,t.routerNode}));return new i.GridRouter(o,{getChildren:function(t){return t.children},getBounds:function(t){return t.bounds}},e-r)}(t.cola.nodes(),t.cola.groups(),e,r).routeEdges(t.powerGraph.powerEdges,n,(function(t){return t.source.routerNode.id}),(function(t){return t.target.routerNode.id}))},e.powerGraphGridLayout=function(t,n,e){var i;t.nodes.forEach((function(t,n){return t.index=n})),(new r.Layout).avoidOverlaps(!1).nodes(t.nodes).links(t.links).powerGraphGroups((function(t){(i=t).groups.forEach((function(t){return t.padding=e}))}));var o=t.nodes.length,a=[],s=t.nodes.slice(0);return s.forEach((function(t,n){return t.index=n})),i.groups.forEach((function(t){var n=t.index=t.id+o;s.push(t),void 0!==t.leaves&&t.leaves.forEach((function(t){return a.push({source:n,target:t.index})})),void 0!==t.groups&&t.groups.forEach((function(t){return a.push({source:n,target:t.id+o})}))})),i.powerEdges.forEach((function(t){a.push({source:t.source.index,target:t.target.index})})),(new r.Layout).size(n).nodes(s).links(a).avoidOverlaps(!1).linkDistance(30).symmetricDiffLinkLengths(5).convergenceThreshold(1e-4).start(100,0,0,0,!1),{cola:(new r.Layout).convergenceThreshold(.001).size(n).avoidOverlaps(!0).nodes(t.nodes).links(t.links).groupCompactness(1e-4).linkDistance(30).symmetricDiffLinkLengths(5).powerGraphGroups((function(t){(i=t).groups.forEach((function(t){t.padding=e}))})).start(50,0,100,0,!1),powerGraph:i}}},{"./gridrouter":9,"./layout":11}],4:[function(t,n,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=t("./d3v3adaptor"),i=t("./d3v4adaptor");e.d3adaptor=function(t){return!t||function(t){return t.version&&null!==t.version.match(/^3\./)}(t)?new r.D3StyleLayoutAdaptor:new i.D3StyleLayoutAdaptor(t)}},{"./d3v3adaptor":5,"./d3v4adaptor":6}],5:[function(t,n,e){"use strict";var r,i=this&&this.__extends||(r=function(t,n){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(t,n)},function(t,n){function e(){this.constructor=t}r(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)});Object.defineProperty(e,"__esModule",{value:!0});var o=t("./layout"),a=function(t){function n(){var n=t.call(this)||this;n.event=d3.dispatch(o.EventType[o.EventType.start],o.EventType[o.EventType.tick],o.EventType[o.EventType.end]);var e=n;return n.drag=function(){if(!t)var t=d3.behavior.drag().origin(o.Layout.dragOrigin).on("dragstart.d3adaptor",o.Layout.dragStart).on("drag.d3adaptor",(function(t){o.Layout.drag(t,d3.event),e.resume()})).on("dragend.d3adaptor",o.Layout.dragEnd);if(!arguments.length)return t;this.call(t)},n}return i(n,t),n.prototype.trigger=function(t){var n={type:o.EventType[t.type],alpha:t.alpha,stress:t.stress};this.event[n.type](n)},n.prototype.kick=function(){var n=this;d3.timer((function(){return t.prototype.tick.call(n)}))},n.prototype.on=function(t,n){return"string"==typeof t?this.event.on(t,n):this.event.on(o.EventType[t],n),this},n}(o.Layout);e.D3StyleLayoutAdaptor=a,e.d3adaptor=function(){return new a}},{"./layout":11}],6:[function(t,n,e){"use strict";var r,i=this&&this.__extends||(r=function(t,n){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(t,n)},function(t,n){function e(){this.constructor=t}r(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)});Object.defineProperty(e,"__esModule",{value:!0});var o=t("./layout"),a=function(t){function n(n){var e=t.call(this)||this;e.d3Context=n,e.event=n.dispatch(o.EventType[o.EventType.start],o.EventType[o.EventType.tick],o.EventType[o.EventType.end]);var r=e;return e.drag=function(){if(!t)var t=n.drag().subject(o.Layout.dragOrigin).on("start.d3adaptor",o.Layout.dragStart).on("drag.d3adaptor",(function(t){o.Layout.drag(t,n.event),r.resume()})).on("end.d3adaptor",o.Layout.dragEnd);if(!arguments.length)return t;arguments[0].call(t)},e}return i(n,t),n.prototype.trigger=function(t){var n={type:o.EventType[t.type],alpha:t.alpha,stress:t.stress};this.event.call(n.type,n)},n.prototype.kick=function(){var n=this,e=this.d3Context.timer((function(){return t.prototype.tick.call(n)&&e.stop()}))},n.prototype.on=function(t,n){return"string"==typeof t?this.event.on(t,n):this.event.on(o.EventType[t],n),this},n}(o.Layout);e.D3StyleLayoutAdaptor=a},{"./layout":11}],7:[function(t,n,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(){this.locks={}}return t.prototype.add=function(t,n){this.locks[t]=n},t.prototype.clear=function(){this.locks={}},t.prototype.isEmpty=function(){for(var t in this.locks)return!1;return!0},t.prototype.apply=function(t){for(var n in this.locks)t(Number(n),this.locks[n])},t}();e.Locks=r;var i=function(){function t(t,n,e){void 0===e&&(e=null),this.D=n,this.G=e,this.threshold=1e-4,this.numGridSnapNodes=0,this.snapGridSize=100,this.snapStrength=1e3,this.scaleSnapByMaxH=!1,this.random=new o,this.project=null,this.x=t,this.k=t.length;var i=this.n=t[0].length;this.H=new Array(this.k),this.g=new Array(this.k),this.Hd=new Array(this.k),this.a=new Array(this.k),this.b=new Array(this.k),this.c=new Array(this.k),this.d=new Array(this.k),this.e=new Array(this.k),this.ia=new Array(this.k),this.ib=new Array(this.k),this.xtmp=new Array(this.k),this.locks=new r,this.minD=Number.MAX_VALUE;for(var a,s=i;s--;)for(a=i;--a>s;){var u=n[s][a];u>0&&u<this.minD&&(this.minD=u)}for(this.minD===Number.MAX_VALUE&&(this.minD=1),s=this.k;s--;){for(this.g[s]=new Array(i),this.H[s]=new Array(i),a=i;a--;)this.H[s][a]=new Array(i);this.Hd[s]=new Array(i),this.a[s]=new Array(i),this.b[s]=new Array(i),this.c[s]=new Array(i),this.d[s]=new Array(i),this.e[s]=new Array(i),this.ia[s]=new Array(i),this.ib[s]=new Array(i),this.xtmp[s]=new Array(i)}}return t.createSquareMatrix=function(t,n){for(var e=new Array(t),r=0;r<t;++r){e[r]=new Array(t);for(var i=0;i<t;++i)e[r][i]=n(r,i)}return e},t.prototype.offsetDir=function(){for(var t=this,n=new Array(this.k),e=0,r=0;r<this.k;++r){var i=n[r]=this.random.getNextBetween(.01,1)-.5;e+=i*i}return e=Math.sqrt(e),n.map((function(n){return n*(t.minD/e)}))},t.prototype.computeDerivatives=function(t){var n=this,e=this.n;if(!(e<1)){for(var r,i=new Array(this.k),o=new Array(this.k),a=new Array(this.k),s=0,u=0;u<e;++u){for(r=0;r<this.k;++r)a[r]=this.g[r][u]=0;for(var c=0;c<e;++c)if(u!==c){for(var l=e,f=0;l--;){for(f=0,r=0;r<this.k;++r){var h=i[r]=t[r][u]-t[r][c];f+=o[r]=h*h}if(f>1e-9)break;var p=this.offsetDir();for(r=0;r<this.k;++r)t[r][c]+=p[r]}var y=Math.sqrt(f),d=this.D[u][c],v=null!=this.G?this.G[u][c]:1;if(v>1&&y>d||!isFinite(d))for(r=0;r<this.k;++r)this.H[r][u][c]=0;else{v>1&&(v=1);var g=d*d,x=2*v*(y-d)/(g*y),m=f*y,b=2*-v/(g*m);for(isFinite(x)||console.log(x),r=0;r<this.k;++r)this.g[r][u]+=i[r]*x,a[r]-=this.H[r][u][c]=b*(2*m+d*(o[r]-f))}}for(r=0;r<this.k;++r)s=Math.max(s,this.H[r][u][u]=a[r])}for(var w=this.snapGridSize/2,k=this.snapGridSize,_=this.snapStrength/(w*w),S=this.numGridSnapNodes,M=0;M<S;++M)for(r=0;r<this.k;++r){var E=this.x[r][M],A=E/k,L=A%1,P=A-L,N=Math.abs(L)<=.5?E-P*k:E>0?E-(P+1)*k:E-(P-1)*k;-w<N&&N<=w&&(this.scaleSnapByMaxH?(this.g[r][M]+=s*_*N,this.H[r][M][M]+=s*_):(this.g[r][M]+=_*N,this.H[r][M][M]+=_))}this.locks.isEmpty()||this.locks.apply((function(e,i){for(r=0;r<n.k;++r)n.H[r][e][e]+=s,n.g[r][e]-=s*(i[r]-t[r][e])}))}},t.dotProd=function(t,n){for(var e=0,r=t.length;r--;)e+=t[r]*n[r];return e},t.rightMultiply=function(n,e,r){for(var i=n.length;i--;)r[i]=t.dotProd(n[i],e)},t.prototype.computeStepSize=function(n){for(var e=0,r=0,i=0;i<this.k;++i)e+=t.dotProd(this.g[i],n[i]),t.rightMultiply(this.H[i],n[i],this.Hd[i]),r+=t.dotProd(n[i],this.Hd[i]);return 0!==r&&isFinite(r)?1*e/r:0},t.prototype.reduceStress=function(){this.computeDerivatives(this.x);for(var t=this.computeStepSize(this.g),n=0;n<this.k;++n)this.takeDescentStep(this.x[n],this.g[n],t);return this.computeStress()},t.copy=function(t,n){for(var e=t.length,r=n[0].length,i=0;i<e;++i)for(var o=0;o<r;++o)n[i][o]=t[i][o]},t.prototype.stepAndProject=function(n,e,r,i){t.copy(n,e),this.takeDescentStep(e[0],r[0],i),this.project&&this.project[0](n[0],n[1],e[0]),this.takeDescentStep(e[1],r[1],i),this.project&&this.project[1](e[0],n[1],e[1]);for(var o=2;o<this.k;o++)this.takeDescentStep(e[o],r[o],i)},t.mApply=function(t,n,e){for(var r=t;r-- >0;)for(var i=n;i-- >0;)e(r,i)},t.prototype.matrixApply=function(n){t.mApply(this.k,this.n,n)},t.prototype.computeNextPosition=function(t,n){var e=this;this.computeDerivatives(t);var r=this.computeStepSize(this.g);if(this.stepAndProject(t,n,this.g,r),this.project){this.matrixApply((function(r,i){return e.e[r][i]=t[r][i]-n[r][i]}));var i=this.computeStepSize(this.e);i=Math.max(.2,Math.min(i,1)),this.stepAndProject(t,n,this.e,i)}},t.prototype.run=function(t){for(var n=Number.MAX_VALUE,e=!1;!e&&t-- >0;){var r=this.rungeKutta();e=Math.abs(n/r-1)<this.threshold,n=r}return n},t.prototype.rungeKutta=function(){var n=this;this.computeNextPosition(this.x,this.a),t.mid(this.x,this.a,this.ia),this.computeNextPosition(this.ia,this.b),t.mid(this.x,this.b,this.ib),this.computeNextPosition(this.ib,this.c),this.computeNextPosition(this.c,this.d);var e=0;return this.matrixApply((function(t,r){var i=(n.a[t][r]+2*n.b[t][r]+2*n.c[t][r]+n.d[t][r])/6,o=n.x[t][r]-i;e+=o*o,n.x[t][r]=i})),e},t.mid=function(n,e,r){t.mApply(n.length,n[0].length,(function(t,i){return r[t][i]=n[t][i]+(e[t][i]-n[t][i])/2}))},t.prototype.takeDescentStep=function(t,n,e){for(var r=0;r<this.n;++r)t[r]=t[r]-e*n[r]},t.prototype.computeStress=function(){for(var t=0,n=0,e=this.n-1;n<e;++n)for(var r=n+1,i=this.n;r<i;++r){for(var o=0,a=0;a<this.k;++a){var s=this.x[a][n]-this.x[a][r];o+=s*s}o=Math.sqrt(o);var u=this.D[n][r];if(isFinite(u)){var c=u-o;t+=c*c/(u*u)}}return t},t.zeroDistance=1e-10,t}();e.Descent=i;var o=function(){function t(t){void 0===t&&(t=1),this.seed=t,this.a=214013,this.c=2531011,this.m=2147483648,this.range=32767}return t.prototype.getNext=function(){return this.seed=(this.seed*this.a+this.c)%this.m,(this.seed>>16)/this.range},t.prototype.getNextBetween=function(t,n){return t+this.getNext()*(n-t)},t}();e.PseudoRandom=o},{}],8:[function(t,n,e){"use strict";var r,i=this&&this.__extends||(r=function(t,n){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(t,n)},function(t,n){function e(){this.constructor=t}r(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)});Object.defineProperty(e,"__esModule",{value:!0});var o=t("./rectangle"),a=function(){};e.Point=a;var s=function(t,n,e,r){this.x1=t,this.y1=n,this.x2=e,this.y2=r};e.LineSegment=s;var u=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n}(a);function c(t,n,e){return(n.x-t.x)*(e.y-t.y)-(e.x-t.x)*(n.y-t.y)}function l(t,n,e){return c(t,n,e)>0}function f(t,n,e){return c(t,n,e)<0}function h(t,n){var e,r,i,o,a=n.length-1;if(f(t,n[1],n[0])&&!l(t,n[a-1],n[0]))return 0;for(e=0,r=a;;){if(r-e==1)return l(t,n[e],n[r])?e:r;if((o=f(t,n[(i=Math.floor((e+r)/2))+1],n[i]))&&!l(t,n[i-1],n[i]))return i;l(t,n[e+1],n[e])?o||l(t,n[e],n[i])?r=i:e=i:o&&f(t,n[e],n[i])?r=i:e=i}}function p(t,n){var e,r,i,o,a=n.length-1;if(l(t,n[a-1],n[0])&&!f(t,n[1],n[0]))return 0;for(e=0,r=a;;){if(r-e==1)return f(t,n[e],n[r])?e:r;if(o=f(t,n[(i=Math.floor((e+r)/2))+1],n[i]),l(t,n[i-1],n[i])&&!o)return i;f(t,n[e+1],n[e])?o?f(t,n[e],n[i])?r=i:e=i:r=i:o?e=i:l(t,n[e],n[i])?r=i:e=i}}function y(t,n,e,r,i,o){var a,s;s=r(t[a=e(n[0],t)],n);for(var u=!1;!u;){for(u=!0;a===t.length-1&&(a=0),!i(n[s],t[a],t[a+1]);)++a;for(;0===s&&(s=n.length-1),!o(t[a],n[s],n[s-1]);)--s,u=!1}return{t1:a,t2:s}}function d(t,n){return y(t,n,h,p,l,f)}e.PolyPoint=u,e.isLeft=c,e.ConvexHull=function(t){var n,e=t.slice(0).sort((function(t,n){return t.x!==n.x?n.x-t.x:n.y-t.y})),r=t.length,i=e[0].x;for(n=1;n<r&&e[n].x===i;++n);var o=n-1,a=[];if(a.push(e[0]),o===r-1)e[o].y!==e[0].y&&a.push(e[o]);else{var s,u=r-1,l=e[r-1].x;for(n=r-2;n>=0&&e[n].x===l;n--);for(s=n+1,n=o;++n<=s;)if(!(c(e[0],e[s],e[n])>=0&&n<s)){for(;a.length>1&&!(c(a[a.length-2],a[a.length-1],e[n])>0);)a.length-=1;0!=n&&a.push(e[n])}u!=s&&a.push(e[u]);var f=a.length;for(n=s;--n>=o;)if(!(c(e[u],e[o],e[n])>=0&&n>o)){for(;a.length>f&&!(c(a[a.length-2],a[a.length-1],e[n])>0);)a.length-=1;0!=n&&a.push(e[n])}}return a},e.clockwiseRadialSweep=function(t,n,e){n.slice(0).sort((function(n,e){return Math.atan2(n.y-t.y,n.x-t.x)-Math.atan2(e.y-t.y,e.x-t.x)})).forEach(e)},e.tangent_PolyPolyC=y,e.LRtangent_PolyPolyC=function(t,n){var e=d(n,t);return{t1:e.t2,t2:e.t1}},e.RLtangent_PolyPolyC=d,e.LLtangent_PolyPolyC=function(t,n){return y(t,n,p,p,f,f)},e.RRtangent_PolyPolyC=function(t,n){return y(t,n,h,h,l,l)};var v=function(t,n){this.t1=t,this.t2=n};e.BiTangent=v;var g=function(){};e.BiTangents=g;var x=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n}(a);e.TVGPoint=x;var m=function(t,n,e,r){this.id=t,this.polyid=n,this.polyvertid=e,this.p=r,r.vv=this};e.VisibilityVertex=m;var b=function(){function t(t,n){this.source=t,this.target=n}return t.prototype.length=function(){var t=this.source.p.x-this.target.p.x,n=this.source.p.y-this.target.p.y;return Math.sqrt(t*t+n*n)},t}();e.VisibilityEdge=b;var w=function(){function t(t,n){if(this.P=t,this.V=[],this.E=[],n)this.V=n.V.slice(0),this.E=n.E.slice(0);else{for(var e=t.length,r=0;r<e;r++){for(var i=t[r],o=0;o<i.length;++o){var a=i[o],s=new m(this.V.length,r,o,a);this.V.push(s),o>0&&this.E.push(new b(i[o-1].vv,s))}i.length>1&&this.E.push(new b(i[0].vv,i[i.length-1].vv))}for(r=0;r<e-1;r++){var u=t[r];for(o=r+1;o<e;o++){var c=t[o],l=_(u,c);for(var f in l){var h=l[f],p=u[h.t1],y=c[h.t2];this.addEdgeIfVisible(p,y,r,o)}}}}}return t.prototype.addEdgeIfVisible=function(t,n,e,r){this.intersectsPolys(new s(t.x,t.y,n.x,n.y),e,r)||this.E.push(new b(t.vv,n.vv))},t.prototype.addPoint=function(t,n){var e,r,i,o=this.P.length;this.V.push(new m(this.V.length,o,0,t));for(var a=0;a<o;++a)if(a!==n){var s=this.P[a],u=(e=t,i=void 0,(i=(r=s).slice(0)).push(r[0]),{rtan:h(e,i),ltan:p(e,i)});this.addEdgeIfVisible(t,s[u.ltan],n,a),this.addEdgeIfVisible(t,s[u.rtan],n,a)}return t.vv},t.prototype.intersectsPolys=function(t,n,e){for(var r=0,i=this.P.length;r<i;++r)if(r!=n&&r!=e&&k(t,this.P[r]).length>0)return!0;return!1},t}();function k(t,n){for(var e=[],r=1,i=n.length;r<i;++r){var a=o.Rectangle.lineIntersection(t.x1,t.y1,t.x2,t.y2,n[r-1].x,n[r-1].y,n[r].x,n[r].y);a&&e.push(a)}return e}function _(t,n){for(var e=t.length-1,r=n.length-1,i=new g,o=0;o<=e;++o)for(var a=0;a<=r;++a){var s=t[0==o?e:o-1],u=t[o],l=t[o==e?0:o+1],f=n[0==a?r:a-1],h=n[a],p=n[a==r?0:a+1],y=c(s,u,h),d=c(u,f,h),x=c(u,h,p),m=c(f,h,u),b=c(h,s,u),w=c(h,u,l);y>=0&&d>=0&&x<0&&m>=0&&b>=0&&w<0?i.ll=new v(o,a):y<=0&&d<=0&&x>0&&m<=0&&b<=0&&w>0?i.rr=new v(o,a):y<=0&&d>0&&x<=0&&m>=0&&b<0&&w>=0?i.rl=new v(o,a):y>=0&&d<0&&x>=0&&m<=0&&b>0&&w<=0&&(i.lr=new v(o,a))}return i}function S(t,n){return!t.every((function(t){return!function(t,n){for(var e=1,r=n.length;e<r;++e)if(f(n[e-1],n[e],t))return!1;return!0}(t,n)}))}e.TangentVisibilityGraph=w,e.tangents=_,e.polysOverlap=function(t,n){if(S(t,n))return!0;if(S(n,t))return!0;for(var e=1,r=t.length;e<r;++e){var i=t[e],o=t[e-1];if(k(new s(o.x,o.y,i.x,i.y),n).length>0)return!0}return!1}},{"./rectangle":17}],9:[function(t,n,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=t("./rectangle"),i=t("./vpsc"),o=t("./shortestpaths"),a=function(t,n,e){this.id=t,this.rect=n,this.children=e,this.leaf=void 0===e||0===e.length};e.NodeWrapper=a;var s=function(t,n,e,r,i){void 0===r&&(r=null),void 0===i&&(i=null),this.id=t,this.x=n,this.y=e,this.node=r,this.line=i};e.Vert=s;var u=function(){function t(n,e){this.s=n,this.t=e;var r=t.findMatch(n,e),i=e.slice(0).reverse(),o=t.findMatch(n,i);r.length>=o.length?(this.length=r.length,this.si=r.si,this.ti=r.ti,this.reversed=!1):(this.length=o.length,this.si=o.si,this.ti=e.length-o.ti-o.length,this.reversed=!0)}return t.findMatch=function(t,n){for(var e=t.length,r=n.length,i={length:0,si:-1,ti:-1},o=new Array(e),a=0;a<e;a++){o[a]=new Array(r);for(var s=0;s<r;s++)if(t[a]===n[s]){var u=o[a][s]=0===a||0===s?1:o[a-1][s-1]+1;u>i.length&&(i.length=u,i.si=a-u+1,i.ti=s-u+1)}else o[a][s]=0}return i},t.prototype.getSequence=function(){return this.length>=0?this.s.slice(this.si,this.si+this.length):[]},t}();e.LongestCommonSubsequence=u;var c=function(){function t(t,n,e){var i=this;void 0===e&&(e=12),this.originalnodes=t,this.groupPadding=e,this.leaves=null,this.nodes=t.map((function(t,e){return new a(e,n.getBounds(t),n.getChildren(t))})),this.leaves=this.nodes.filter((function(t){return t.leaf})),this.groups=this.nodes.filter((function(t){return!t.leaf})),this.cols=this.getGridLines("x"),this.rows=this.getGridLines("y"),this.groups.forEach((function(t){return t.children.forEach((function(n){return i.nodes[n].parent=t}))})),this.root={children:[]},this.nodes.forEach((function(t){void 0===t.parent&&(t.parent=i.root,i.root.children.push(t.id)),t.ports=[]})),this.backToFront=this.nodes.slice(0),this.backToFront.sort((function(t,n){return i.getDepth(t)-i.getDepth(n)})),this.backToFront.slice(0).reverse().filter((function(t){return!t.leaf})).forEach((function(t){var n=r.Rectangle.empty();t.children.forEach((function(t){return n=n.union(i.nodes[t].rect)})),t.rect=n.inflate(i.groupPadding)}));var o=this.midPoints(this.cols.map((function(t){return t.pos}))),u=this.midPoints(this.rows.map((function(t){return t.pos}))),c=o[0],l=o[o.length-1],f=u[0],h=u[u.length-1],p=this.rows.map((function(t){return{x1:c,x2:l,y1:t.pos,y2:t.pos}})).concat(u.map((function(t){return{x1:c,x2:l,y1:t,y2:t}}))),y=this.cols.map((function(t){return{x1:t.pos,x2:t.pos,y1:f,y2:h}})).concat(o.map((function(t){return{x1:t,x2:t,y1:f,y2:h}}))),d=p.concat(y);d.forEach((function(t){return t.verts=[]})),this.verts=[],this.edges=[],p.forEach((function(t){return y.forEach((function(n){var e=new s(i.verts.length,n.x1,t.y1);t.verts.push(e),n.verts.push(e),i.verts.push(e);for(var r=i.backToFront.length;r-- >0;){var o=i.backToFront[r],a=o.rect,u=Math.abs(e.x-a.cx()),c=Math.abs(e.y-a.cy());if(u<a.width()/2&&c<a.height()/2){e.node=o;break}}}))})),d.forEach((function(t,n){i.nodes.forEach((function(n,e){n.rect.lineIntersections(t.x1,t.y1,t.x2,t.y2).forEach((function(e,r){var o=new s(i.verts.length,e.x,e.y,n,t);i.verts.push(o),t.verts.push(o),n.ports.push(o)}))}));var e=Math.abs(t.y1-t.y2)<.1,r=function(t,n){return e?n.x-t.x:n.y-t.y};t.verts.sort(r);for(var o=1;o<t.verts.length;o++){var a=t.verts[o-1],u=t.verts[o];a.node&&a.node===u.node&&a.node.leaf||i.edges.push({source:a.id,target:u.id,length:Math.abs(r(a,u))})}}))}return t.prototype.avg=function(t){return t.reduce((function(t,n){return t+n}))/t.length},t.prototype.getGridLines=function(t){for(var n=[],e=this.leaves.slice(0,this.leaves.length);e.length>0;){var r=e.filter((function(n){return n.rect["overlap"+t.toUpperCase()](e[0].rect)})),i={nodes:r,pos:this.avg(r.map((function(n){return n.rect["c"+t]()})))};n.push(i),i.nodes.forEach((function(t){return e.splice(e.indexOf(t),1)}))}return n.sort((function(t,n){return t.pos-n.pos})),n},t.prototype.getDepth=function(t){for(var n=0;t.parent!==this.root;)n++,t=t.parent;return n},t.prototype.midPoints=function(t){for(var n=t[1]-t[0],e=[t[0]-n/2],r=1;r<t.length;r++)e.push((t[r]+t[r-1])/2);return e.push(t[t.length-1]+n/2),e},t.prototype.findLineage=function(t){var n=[t];do{t=t.parent,n.push(t)}while(t!==this.root);return n.reverse()},t.prototype.findAncestorPathBetween=function(t,n){for(var e=this.findLineage(t),r=this.findLineage(n),i=0;e[i]===r[i];)i++;return{commonAncestor:e[i-1],lineages:e.slice(i).concat(r.slice(i))}},t.prototype.siblingObstacles=function(t,n){var e=this,r=this.findAncestorPathBetween(t,n),i={};r.lineages.forEach((function(t){return i[t.id]={}}));var o=r.commonAncestor.children.filter((function(t){return!(t in i)}));return r.lineages.filter((function(t){return t.parent!==r.commonAncestor})).forEach((function(t){return o=o.concat(t.parent.children.filter((function(n){return n!==t.id})))})),o.map((function(t){return e.nodes[t]}))},t.getSegmentSets=function(t,n,e){for(var r=[],i=0;i<t.length;i++)for(var o=t[i],a=0;a<o.length;a++){(f=o[a]).edgeid=i,f.i=a;var s=f[1][n]-f[0][n];Math.abs(s)<.1&&r.push(f)}r.sort((function(t,e){return t[0][n]-e[0][n]}));for(var u=[],c=null,l=0;l<r.length;l++){var f=r[l];(!c||Math.abs(f[0][n]-c.pos)>.1)&&(c={pos:f[0][n],segments:[]},u.push(c)),c.segments.push(f)}return u},t.nudgeSegs=function(t,n,e,r,o,a){var s=r.length;if(!(s<=1)){for(var u=r.map((function(n){return new i.Variable(n[0][t])})),c=[],l=0;l<s;l++)for(var f=0;f<s;f++)if(l!==f){var h=r[l],p=r[f],y=h.edgeid,d=p.edgeid,v=-1,g=-1;"x"==t?o(y,d)&&(h[0][n]<h[1][n]?(v=f,g=l):(v=l,g=f)):o(y,d)&&(h[0][n]<h[1][n]?(v=l,g=f):(v=f,g=l)),v>=0&&c.push(new i.Constraint(u[v],u[g],a))}new i.Solver(u,c).solve(),u.forEach((function(n,i){var o=r[i],a=n.position();o[0][t]=o[1][t]=a;var s=e[o.edgeid];o.i>0&&(s[o.i-1][1][t]=a),o.i<s.length-1&&(s[o.i+1][0][t]=a)}))}},t.nudgeSegments=function(n,e,r,i,o){for(var a=t.getSegmentSets(n,e,r),s=0;s<a.length;s++){for(var u=a[s],c=[],l=0;l<u.segments.length;l++){var f=u.segments[l];c.push({type:0,s:f,pos:Math.min(f[0][r],f[1][r])}),c.push({type:1,s:f,pos:Math.max(f[0][r],f[1][r])})}c.sort((function(t,n){return t.pos-n.pos+t.type-n.type}));var h=[],p=0;c.forEach((function(a){0===a.type?(h.push(a.s),p++):p--,0==p&&(t.nudgeSegs(e,r,n,h,i,o),h=[])}))}},t.prototype.routeEdges=function(n,e,r,i){var o=this,a=n.map((function(t){return o.route(r(t),i(t))})),s=t.orderEdges(a),u=a.map((function(n){return t.makeSegments(n)}));return t.nudgeSegments(u,"x","y",s,e),t.nudgeSegments(u,"y","x",s,e),t.unreverseEdges(u,a),u},t.unreverseEdges=function(t,n){t.forEach((function(t,e){n[e].reversed&&(t.reverse(),t.forEach((function(t){t.reverse()})))}))},t.angleBetween2Lines=function(t,n){var e=Math.atan2(t[0].y-t[1].y,t[0].x-t[1].x),r=Math.atan2(n[0].y-n[1].y,n[0].x-n[1].x),i=e-r;return(i>Math.PI||i<-Math.PI)&&(i=r-e),i},t.isLeft=function(t,n,e){return(n.x-t.x)*(e.y-t.y)-(n.y-t.y)*(e.x-t.x)<=0},t.getOrder=function(t){for(var n={},e=0;e<t.length;e++){var r=t[e];void 0===n[r.l]&&(n[r.l]={}),n[r.l][r.r]=!0}return function(t,e){return void 0!==n[t]&&n[t][e]}},t.orderEdges=function(n){for(var e=[],r=0;r<n.length-1;r++)for(var i=r+1;i<n.length;i++){var o,a,s,c=n[r],l=n[i],f=new u(c,l);0!==f.length&&(f.reversed&&(l.reverse(),l.reversed=!0,f=new u(c,l)),(f.si<=0||f.ti<=0)&&(f.si+f.length>=c.length||f.ti+f.length>=l.length)?e.push({l:r,r:i}):(f.si+f.length>=c.length||f.ti+f.length>=l.length?(o=c[f.si+1],s=c[f.si-1],a=l[f.ti-1]):(o=c[f.si+f.length-2],a=c[f.si+f.length],s=l[f.ti+f.length]),t.isLeft(o,a,s)?e.push({l:i,r:r}):e.push({l:r,r:i})))}return t.getOrder(e)},t.makeSegments=function(t){function n(t){return{x:t.x,y:t.y}}for(var e=function(t,n,e){return Math.abs((n.x-t.x)*(e.y-t.y)-(n.y-t.y)*(e.x-t.x))<.001},r=[],i=n(t[0]),o=1;o<t.length;o++){var a=n(t[o]),s=o<t.length-1?t[o+1]:null;s&&e(i,a,s)||(r.push([i,a]),i=a)}return r},t.prototype.route=function(t,n){var e=this,r=this.nodes[t],i=this.nodes[n];this.obstacles=this.siblingObstacles(r,i);var a={};this.obstacles.forEach((function(t){return a[t.id]=t})),this.passableEdges=this.edges.filter((function(t){var n=e.verts[t.source],r=e.verts[t.target];return!(n.node&&n.node.id in a||r.node&&r.node.id in a)}));for(var s=1;s<r.ports.length;s++){var u=r.ports[0].id,c=r.ports[s].id;this.passableEdges.push({source:u,target:c,length:0})}for(s=1;s<i.ports.length;s++)u=i.ports[0].id,c=i.ports[s].id,this.passableEdges.push({source:u,target:c,length:0});var l=new o.Calculator(this.verts.length,this.passableEdges,(function(t){return t.source}),(function(t){return t.target}),(function(t){return t.length})).PathFromNodeToNodeWithPrevCost(r.ports[0].id,i.ports[0].id,(function(t,n,o){var a=e.verts[t],s=e.verts[n],u=e.verts[o],c=Math.abs(u.x-a.x),l=Math.abs(u.y-a.y);return a.node===r&&a.node===s.node||s.node===i&&s.node===u.node?0:c>1&&l>1?1e3:0})).reverse().map((function(t){return e.verts[t]}));return l.push(this.nodes[i.id].ports[0]),l.filter((function(t,n){return!(n<l.length-1&&l[n+1].node===r&&t.node===r||n>0&&t.node===i&&l[n-1].node===i)}))},t.getRoutePath=function(n,e,r,i){var o,a,s,u={routepath:"M "+n[0][0].x+" "+n[0][0].y+" ",arrowpath:""};if(n.length>1)for(var c=0;c<n.length;c++){var l=(o=n[c])[1].x,f=o[1].y,h=l-o[0].x,p=f-o[0].y;if(c<n.length-1){Math.abs(h)>0?l-=h/Math.abs(h)*e:f-=p/Math.abs(p)*e,u.routepath+="L "+l+" "+f+" ";var y=n[c+1],d=y[0].x,v=y[0].y;h=y[1].x-d,p=y[1].y-v;var g,x,m=t.angleBetween2Lines(o,y)<0?1:0;Math.abs(h)>0?(g=d+h/Math.abs(h)*e,x=v):(g=d,x=v+p/Math.abs(p)*e);var b=Math.abs(g-l),w=Math.abs(x-f);u.routepath+="A "+b+" "+w+" 0 0 "+m+" "+g+" "+x+" "}else{var k=[l,f];Math.abs(h)>0?(a=[l-=h/Math.abs(h)*i,f+r],s=[l,f-r]):(a=[l+r,f-=p/Math.abs(p)*i],s=[l-r,f]),u.routepath+="L "+l+" "+f+" ",i>0&&(u.arrowpath="M "+k[0]+" "+k[1]+" L "+a[0]+" "+a[1]+" L "+s[0]+" "+s[1])}}else l=(o=n[0])[1].x,f=o[1].y,h=l-o[0].x,p=f-o[0].y,k=[l,f],Math.abs(h)>0?(a=[l-=h/Math.abs(h)*i,f+r],s=[l,f-r]):(a=[l+r,f-=p/Math.abs(p)*i],s=[l-r,f]),u.routepath+="L "+l+" "+f+" ",i>0&&(u.arrowpath="M "+k[0]+" "+k[1]+" L "+a[0]+" "+a[1]+" L "+s[0]+" "+s[1]);return u},t}();e.GridRouter=c},{"./rectangle":17,"./shortestpaths":18,"./vpsc":19}],10:[function(t,n,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=10,i=(1+Math.sqrt(5))/2,o=1e-4;e.applyPacking=function(t,n,e,a,s,u){void 0===s&&(s=1),void 0===u&&(u=!0);var c=n,l=e,f=(s=void 0!==s?s:1,a=void 0!==a?a:0,0),h=0,p=0,y=0,d=[];function v(t,n){d=[],f=0,h=0,y=0;for(var e=0;e<t.length;e++)g(t[e],n);return Math.abs(f/h-s)}function g(t,n){for(var e=void 0,i=0;i<d.length;i++)if(d[i].space_left>=t.height&&d[i].x+d[i].width+t.width+r-n<=o){e=d[i];break}d.push(t),void 0!==e?(t.x=e.x+e.width+r,t.y=e.bottom,t.space_left=t.height,t.bottom=t.y,e.space_left-=t.height+r,e.bottom+=t.height+r):(t.y=y,y+=t.height+r,t.x=0,t.bottom=t.y,t.space_left=t.height),t.y+t.height-h>-o&&(h=t.y+t.height-0),t.x+t.width-f>-o&&(f=t.x+t.width-0)}0!=t.length&&(function(t){t.forEach((function(t){var n,e,r,i,o;n=t,e=Number.MAX_VALUE,r=Number.MAX_VALUE,i=0,o=0,n.array.forEach((function(t){var n=void 0!==t.width?t.width:a,s=void 0!==t.height?t.height:a;n/=2,s/=2,i=Math.max(t.x+n,i),e=Math.min(t.x-n,e),o=Math.max(t.y+s,o),r=Math.min(t.y-s,r)})),n.width=i-e,n.height=o-r}))}(t),function(t,n){var e=Number.POSITIVE_INFINITY,a=0;t.sort((function(t,n){return n.height-t.height})),p=t.reduce((function(t,n){return t.width<n.width?t.width:n.width}));for(var s=g=p,u=x=function(t){var n=0;return t.forEach((function(t){return n+=t.width+r})),n}(t),c=0,l=Number.MAX_VALUE,f=Number.MAX_VALUE,h=-1,y=Number.MAX_VALUE,d=Number.MAX_VALUE;y>p||d>o;){if(1!=h){var g=u-(u-s)/i;l=v(t,g)}if(0!=h){var x=s+(u-s)/i;f=v(t,x)}if(y=Math.abs(g-x),d=Math.abs(l-f),l<e&&(e=l,a=g),f<e&&(e=f,a=x),l>f?(s=g,g=x,l=f,h=1):(u=x,x=g,f=l,h=0),c++>100)break}v(t,a)}(t),u&&function(t){t.forEach((function(t){var n={x:0,y:0};t.array.forEach((function(t){n.x+=t.x,n.y+=t.y})),n.x/=t.array.length,n.y/=t.array.length;var e=n.x-t.width/2,r=n.y-t.height/2,i=t.x-e+c/2-f/2,o=t.y-r+l/2-h/2;t.array.forEach((function(t){t.x+=i,t.y+=o}))}))}(t))},e.separateGraphs=function(t,n){for(var e={},r={},i=[],o=0,a=0;a<n.length;a++){var s=n[a],u=s.source,c=s.target;r[u.index]?r[u.index].push(c):r[u.index]=[c],r[c.index]?r[c.index].push(u):r[c.index]=[u]}for(a=0;a<t.length;a++){var l=t[a];e[l.index]||f(l,!0)}function f(t,n){if(void 0===e[t.index]){n&&(o++,i.push({array:[]})),e[t.index]=o,i[o-1].array.push(t);var a=r[t.index];if(a)for(var s=0;s<a.length;s++)f(a[s],!1)}}return i}},{}],11:[function(t,n,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,i=t("./powergraph"),o=t("./linklengths"),a=t("./descent"),s=t("./rectangle"),u=t("./shortestpaths"),c=t("./geom"),l=t("./handledisconnected");function f(t){return void 0!==t.leaves||void 0!==t.groups}!function(t){t[t.start=0]="start",t[t.tick=1]="tick",t[t.end=2]="end"}(r=e.EventType||(e.EventType={}));var h=function(){function t(){var n=this;this._canvasSize=[1,1],this._linkDistance=20,this._defaultNodeSize=10,this._linkLengthCalculator=null,this._linkType=null,this._avoidOverlaps=!1,this._handleDisconnected=!0,this._running=!1,this._nodes=[],this._groups=[],this._rootGroup=null,this._links=[],this._constraints=[],this._distanceMatrix=null,this._descent=null,this._directedLinkConstraints=null,this._threshold=.01,this._visibilityGraph=null,this._groupCompactness=1e-6,this.event=null,this.linkAccessor={getSourceIndex:t.getSourceIndex,getTargetIndex:t.getTargetIndex,setLength:t.setLinkLength,getType:function(t){return"function"==typeof n._linkType?n._linkType(t):0}}}return t.prototype.on=function(t,n){return this.event||(this.event={}),"string"==typeof t?this.event[r[t]]=n:this.event[t]=n,this},t.prototype.trigger=function(t){this.event&&void 0!==this.event[t.type]&&this.event[t.type](t)},t.prototype.kick=function(){for(;!this.tick(););},t.prototype.tick=function(){if(this._alpha<this._threshold)return this._running=!1,this.trigger({type:r.end,alpha:this._alpha=0,stress:this._lastStress}),!0;var t,n,e=this._nodes.length;for(this._links.length,this._descent.locks.clear(),n=0;n<e;++n)if((t=this._nodes[n]).fixed){void 0!==t.px&&void 0!==t.py||(t.px=t.x,t.py=t.y);var i=[t.px,t.py];this._descent.locks.add(n,i)}var o=this._descent.rungeKutta();return 0===o?this._alpha=0:void 0!==this._lastStress&&(this._alpha=o),this._lastStress=o,this.updateNodePositions(),this.trigger({type:r.tick,alpha:this._alpha,stress:this._lastStress}),!1},t.prototype.updateNodePositions=function(){for(var t,n=this._descent.x[0],e=this._descent.x[1],r=this._nodes.length;r--;)(t=this._nodes[r]).x=n[r],t.y=e[r]},t.prototype.nodes=function(t){if(!t){if(0===this._nodes.length&&this._links.length>0){var n=0;this._links.forEach((function(t){n=Math.max(n,t.source,t.target)})),this._nodes=new Array(++n);for(var e=0;e<n;++e)this._nodes[e]={}}return this._nodes}return this._nodes=t,this},t.prototype.groups=function(t){var n=this;return t?(this._groups=t,this._rootGroup={},this._groups.forEach((function(t){void 0===t.padding&&(t.padding=1),void 0!==t.leaves&&t.leaves.forEach((function(e,r){"number"==typeof e&&((t.leaves[r]=n._nodes[e]).parent=t)})),void 0!==t.groups&&t.groups.forEach((function(e,r){"number"==typeof e&&((t.groups[r]=n._groups[e]).parent=t)}))})),this._rootGroup.leaves=this._nodes.filter((function(t){return void 0===t.parent})),this._rootGroup.groups=this._groups.filter((function(t){return void 0===t.parent})),this):this._groups},t.prototype.powerGraphGroups=function(t){var n=i.getGroups(this._nodes,this._links,this.linkAccessor,this._rootGroup);return this.groups(n.groups),t(n),this},t.prototype.avoidOverlaps=function(t){return arguments.length?(this._avoidOverlaps=t,this):this._avoidOverlaps},t.prototype.handleDisconnected=function(t){return arguments.length?(this._handleDisconnected=t,this):this._handleDisconnected},t.prototype.flowLayout=function(t,n){return arguments.length||(t="y"),this._directedLinkConstraints={axis:t,getMinSeparation:"number"==typeof n?function(){return n}:n},this},t.prototype.links=function(t){return arguments.length?(this._links=t,this):this._links},t.prototype.constraints=function(t){return arguments.length?(this._constraints=t,this):this._constraints},t.prototype.distanceMatrix=function(t){return arguments.length?(this._distanceMatrix=t,this):this._distanceMatrix},t.prototype.size=function(t){return t?(this._canvasSize=t,this):this._canvasSize},t.prototype.defaultNodeSize=function(t){return t?(this._defaultNodeSize=t,this):this._defaultNodeSize},t.prototype.groupCompactness=function(t){return t?(this._groupCompactness=t,this):this._groupCompactness},t.prototype.linkDistance=function(t){return t?(this._linkDistance="function"==typeof t?t:+t,this._linkLengthCalculator=null,this):this._linkDistance},t.prototype.linkType=function(t){return this._linkType=t,this},t.prototype.convergenceThreshold=function(t){return t?(this._threshold="function"==typeof t?t:+t,this):this._threshold},t.prototype.alpha=function(t){return arguments.length?(t=+t,this._alpha?this._alpha=t>0?t:0:t>0&&(this._running||(this._running=!0,this.trigger({type:r.start,alpha:this._alpha=t}),this.kick())),this):this._alpha},t.prototype.getLinkLength=function(t){return"function"==typeof this._linkDistance?+this._linkDistance(t):this._linkDistance},t.setLinkLength=function(t,n){t.length=n},t.prototype.getLinkType=function(t){return"function"==typeof this._linkType?this._linkType(t):0},t.prototype.symmetricDiffLinkLengths=function(t,n){var e=this;return void 0===n&&(n=1),this.linkDistance((function(n){return t*n.length})),this._linkLengthCalculator=function(){return o.symmetricDiffLinkLengths(e._links,e.linkAccessor,n)},this},t.prototype.jaccardLinkLengths=function(t,n){var e=this;return void 0===n&&(n=1),this.linkDistance((function(n){return t*n.length})),this._linkLengthCalculator=function(){return o.jaccardLinkLengths(e._links,e.linkAccessor,n)},this},t.prototype.start=function(n,e,r,i,c,l){var f=this;void 0===n&&(n=0),void 0===e&&(e=0),void 0===r&&(r=0),void 0===i&&(i=0),void 0===c&&(c=!0),void 0===l&&(l=!0);var h,p=this.nodes().length,y=p+2*this._groups.length,d=(this._links.length,this._canvasSize[0]),v=this._canvasSize[1],g=new Array(y),x=new Array(y),m=null,b=this._avoidOverlaps;this._nodes.forEach((function(t,n){t.index=n,void 0===t.x&&(t.x=d/2,t.y=v/2),g[n]=t.x,x[n]=t.y})),this._linkLengthCalculator&&this._linkLengthCalculator(),this._distanceMatrix?h=this._distanceMatrix:(h=new u.Calculator(y,this._links,t.getSourceIndex,t.getTargetIndex,(function(t){return f.getLinkLength(t)})).DistanceMatrix(),m=a.Descent.createSquareMatrix(y,(function(){return 2})),this._links.forEach((function(t){"number"==typeof t.source&&(t.source=f._nodes[t.source]),"number"==typeof t.target&&(t.target=f._nodes[t.target])})),this._links.forEach((function(n){var e=t.getSourceIndex(n),r=t.getTargetIndex(n);m[e][r]=m[r][e]=n.weight||1})));var w=a.Descent.createSquareMatrix(y,(function(t,n){return h[t][n]}));if(this._rootGroup&&void 0!==this._rootGroup.groups){var k=p;this._groups.forEach((function(t){!function(t,n,e,r){m[t][n]=m[n][t]=e,w[t][n]=w[n][t]=r}(k,k+1,f._groupCompactness,.1),void 0===t.bounds?(g[k]=d/2,x[k++]=v/2,g[k]=d/2,x[k++]=v/2):(g[k]=t.bounds.x,x[k++]=t.bounds.y,g[k]=t.bounds.X,x[k++]=t.bounds.Y)}))}else this._rootGroup={leaves:this._nodes,groups:[]};var _=this._constraints||[];for(this._directedLinkConstraints&&(this.linkAccessor.getMinSeparation=this._directedLinkConstraints.getMinSeparation,_=_.concat(o.generateDirectedEdgeConstraints(p,this._links,this._directedLinkConstraints.axis,this.linkAccessor))),this.avoidOverlaps(!1),this._descent=new a.Descent([g,x],w),this._descent.locks.clear(),k=0;k<p;++k){var S=this._nodes[k];if(S.fixed){S.px=S.x,S.py=S.y;var M=[S.x,S.y];this._descent.locks.add(k,M)}}if(this._descent.threshold=this._threshold,this.initialLayout(n,g,x),_.length>0&&(this._descent.project=new s.Projection(this._nodes,this._groups,this._rootGroup,_).projectFunctions()),this._descent.run(e),this.separateOverlappingComponents(d,v,l),this.avoidOverlaps(b),b&&(this._nodes.forEach((function(t,n){t.x=g[n],t.y=x[n]})),this._descent.project=new s.Projection(this._nodes,this._groups,this._rootGroup,_,!0).projectFunctions(),this._nodes.forEach((function(t,n){g[n]=t.x,x[n]=t.y}))),this._descent.G=m,this._descent.run(r),i){this._descent.snapStrength=1e3,this._descent.snapGridSize=this._nodes[0].width,this._descent.numGridSnapNodes=p,this._descent.scaleSnapByMaxH=p!=y;var E=a.Descent.createSquareMatrix(y,(function(t,n){return t>=p||n>=p?m[t][n]:0}));this._descent.G=E,this._descent.run(i)}return this.updateNodePositions(),this.separateOverlappingComponents(d,v,l),c?this.resume():this},t.prototype.initialLayout=function(n,e,r){if(this._groups.length>0&&n>0){var i=this._nodes.length,o=this._links.map((function(t){return{source:t.source.index,target:t.target.index}})),a=this._nodes.map((function(t){return{index:t.index}}));this._groups.forEach((function(t,n){a.push({index:t.index=i+n})})),this._groups.forEach((function(t,n){void 0!==t.leaves&&t.leaves.forEach((function(n){return o.push({source:t.index,target:n.index})})),void 0!==t.groups&&t.groups.forEach((function(n){return o.push({source:t.index,target:n.index})}))})),(new t).size(this.size()).nodes(a).links(o).avoidOverlaps(!1).linkDistance(this.linkDistance()).symmetricDiffLinkLengths(5).convergenceThreshold(1e-4).start(n,0,0,0,!1),this._nodes.forEach((function(t){e[t.index]=a[t.index].x,r[t.index]=a[t.index].y}))}else this._descent.run(n)},t.prototype.separateOverlappingComponents=function(t,n,e){var r=this;if(void 0===e&&(e=!0),!this._distanceMatrix&&this._handleDisconnected){var i=this._descent.x[0],o=this._descent.x[1];this._nodes.forEach((function(t,n){t.x=i[n],t.y=o[n]}));var a=l.separateGraphs(this._nodes,this._links);l.applyPacking(a,t,n,this._defaultNodeSize,n/t,e),this._nodes.forEach((function(t,n){r._descent.x[0][n]=t.x,r._descent.x[1][n]=t.y,t.bounds&&(t.bounds.setXCentre(t.x),t.bounds.setYCentre(t.y))}))}},t.prototype.resume=function(){return this.alpha(.1)},t.prototype.stop=function(){return this.alpha(0)},t.prototype.prepareEdgeRouting=function(t){void 0===t&&(t=0),this._visibilityGraph=new c.TangentVisibilityGraph(this._nodes.map((function(n){return n.bounds.inflate(-t).vertices()})))},t.prototype.routeEdge=function(t,n,e){void 0===n&&(n=5);var r=[],i=new c.TangentVisibilityGraph(this._visibilityGraph.P,{V:this._visibilityGraph.V,E:this._visibilityGraph.E}),o={x:t.source.x,y:t.source.y},a={x:t.target.x,y:t.target.y},l=i.addPoint(o,t.source.index),f=i.addPoint(a,t.target.index);i.addEdgeIfVisible(o,a,t.source.index,t.target.index),void 0!==e&&e(i);var h=new u.Calculator(i.V.length,i.E,(function(t){return t.source.id}),(function(t){return t.target.id}),(function(t){return t.length()})).PathFromNodeToNode(l.id,f.id);if(1===h.length||h.length===i.V.length){var p=s.makeEdgeBetween(t.source.innerBounds,t.target.innerBounds,n);r=[p.sourceIntersection,p.arrowStart]}else{for(var y=h.length-2,d=i.V[h[y]].p,v=i.V[h[0]].p,g=(r=[t.source.innerBounds.rayIntersection(d.x,d.y)],y);g>=0;--g)r.push(i.V[h[g]].p);r.push(s.makeEdgeTo(v,t.target.innerBounds,n))}return r},t.getSourceIndex=function(t){return"number"==typeof t.source?t.source:t.source.index},t.getTargetIndex=function(t){return"number"==typeof t.target?t.target:t.target.index},t.linkId=function(n){return t.getSourceIndex(n)+"-"+t.getTargetIndex(n)},t.dragStart=function(n){f(n)?t.storeOffset(n,t.dragOrigin(n)):(t.stopNode(n),n.fixed|=2)},t.stopNode=function(t){t.px=t.x,t.py=t.y},t.storeOffset=function(n,e){void 0!==n.leaves&&n.leaves.forEach((function(n){n.fixed|=2,t.stopNode(n),n._dragGroupOffsetX=n.x-e.x,n._dragGroupOffsetY=n.y-e.y})),void 0!==n.groups&&n.groups.forEach((function(n){return t.storeOffset(n,e)}))},t.dragOrigin=function(t){return f(t)?{x:t.bounds.cx(),y:t.bounds.cy()}:t},t.drag=function(n,e){f(n)?(void 0!==n.leaves&&n.leaves.forEach((function(t){n.bounds.setXCentre(e.x),n.bounds.setYCentre(e.y),t.px=t._dragGroupOffsetX+e.x,t.py=t._dragGroupOffsetY+e.y})),void 0!==n.groups&&n.groups.forEach((function(n){return t.drag(n,e)}))):(n.px=e.x,n.py=e.y)},t.dragEnd=function(n){f(n)?(void 0!==n.leaves&&n.leaves.forEach((function(n){t.dragEnd(n),delete n._dragGroupOffsetX,delete n._dragGroupOffsetY})),void 0!==n.groups&&n.groups.forEach(t.dragEnd)):n.fixed&=-7},t.mouseOver=function(t){t.fixed|=4,t.px=t.x,t.py=t.y},t.mouseOut=function(t){t.fixed&=-5},t}();e.Layout=h},{"./descent":7,"./geom":8,"./handledisconnected":10,"./linklengths":13,"./powergraph":14,"./rectangle":17,"./shortestpaths":18}],12:[function(t,n,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=t("./shortestpaths"),i=t("./descent"),o=t("./rectangle"),a=t("./linklengths"),s=function(){function t(t,n){this.source=t,this.target=n}return t.prototype.actualLength=function(t){var n=this;return Math.sqrt(t.reduce((function(t,e){var r=e[n.target]-e[n.source];return t+r*r}),0))},t}();e.Link3D=s;var u=function(t,n,e){void 0===t&&(t=0),void 0===n&&(n=0),void 0===e&&(e=0),this.x=t,this.y=n,this.z=e};e.Node3D=u;var c=function(){function t(n,e,r){var i=this;void 0===r&&(r=1),this.nodes=n,this.links=e,this.idealLinkLength=r,this.constraints=null,this.useJaccardLinkLengths=!0,this.result=new Array(t.k);for(var o=0;o<t.k;++o)this.result[o]=new Array(n.length);n.forEach((function(n,e){for(var r=0,o=t.dims;r<o.length;r++){var a=o[r];void 0===n[a]&&(n[a]=Math.random())}i.result[0][e]=n.x,i.result[1][e]=n.y,i.result[2][e]=n.z}))}return t.prototype.linkLength=function(t){return t.actualLength(this.result)},t.prototype.start=function(t){var n=this;void 0===t&&(t=100);var e=this.nodes.length,s=new l;this.useJaccardLinkLengths&&a.jaccardLinkLengths(this.links,s,1.5),this.links.forEach((function(t){return t.length*=n.idealLinkLength}));var u=new r.Calculator(e,this.links,(function(t){return t.source}),(function(t){return t.target}),(function(t){return t.length})).DistanceMatrix(),c=i.Descent.createSquareMatrix(e,(function(t,n){return u[t][n]})),f=i.Descent.createSquareMatrix(e,(function(){return 2}));this.links.forEach((function(t){var n=t.source,e=t.target;return f[n][e]=f[e][n]=1})),this.descent=new i.Descent(this.result,c),this.descent.threshold=.001,this.descent.G=f,this.constraints&&(this.descent.project=new o.Projection(this.nodes,null,null,this.constraints).projectFunctions());for(var h=0;h<this.nodes.length;h++){var p=this.nodes[h];p.fixed&&this.descent.locks.add(h,[p.x,p.y,p.z])}return this.descent.run(t),this},t.prototype.tick=function(){this.descent.locks.clear();for(var t=0;t<this.nodes.length;t++){var n=this.nodes[t];n.fixed&&this.descent.locks.add(t,[n.x,n.y,n.z])}return this.descent.rungeKutta()},t.dims=["x","y","z"],t.k=t.dims.length,t}();e.Layout3D=c;var l=function(){function t(){}return t.prototype.getSourceIndex=function(t){return t.source},t.prototype.getTargetIndex=function(t){return t.target},t.prototype.getLength=function(t){return t.length},t.prototype.setLength=function(t,n){t.length=n},t}()},{"./descent":7,"./linklengths":13,"./rectangle":17,"./shortestpaths":18}],13:[function(t,n,e){"use strict";function r(t,n){var e={};for(var r in t)e[r]={};for(var r in n)e[r]={};return Object.keys(e).length}function i(t,n){var e=0;for(var r in t)void 0!==n[r]&&++e;return e}function o(t,n,e,r){var i=function(t,n){var e={},r=function(t,n){void 0===e[t]&&(e[t]={}),e[t][n]={}};return t.forEach((function(t){var e=n.getSourceIndex(t),i=n.getTargetIndex(t);r(e,i),r(i,e)})),e}(t,r);t.forEach((function(t){var o=i[r.getSourceIndex(t)],a=i[r.getTargetIndex(t)];r.setLength(t,1+n*e(o,a))}))}function a(t,n,e){var r=[],i=0,o=[],a=[];function s(t){t.index=t.lowlink=i++,o.push(t),t.onStack=!0;for(var n=0,e=t.out;n<e.length;n++){var r=e[n];void 0===r.index?(s(r),t.lowlink=Math.min(t.lowlink,r.lowlink)):r.onStack&&(t.lowlink=Math.min(t.lowlink,r.index))}if(t.lowlink===t.index){for(var u=[];o.length&&((r=o.pop()).onStack=!1,u.push(r),r!==t););a.push(u.map((function(t){return t.id})))}}for(var u=0;u<t;u++)r.push({id:u,out:[]});for(var c=0,l=n;c<l.length;c++){var f=l[c],h=r[e.getSourceIndex(f)],p=r[e.getTargetIndex(f)];h.out.push(p)}for(var y=0,d=r;y<d.length;y++){var v=d[y];void 0===v.index&&s(v)}return a}Object.defineProperty(e,"__esModule",{value:!0}),e.symmetricDiffLinkLengths=function(t,n,e){void 0===e&&(e=1),o(t,e,(function(t,n){return Math.sqrt(r(t,n)-i(t,n))}),n)},e.jaccardLinkLengths=function(t,n,e){void 0===e&&(e=1),o(t,e,(function(t,n){return Math.min(Object.keys(t).length,Object.keys(n).length)<1.1?0:i(t,n)/r(t,n)}),n)},e.generateDirectedEdgeConstraints=function(t,n,e,r){var i=a(t,n,r),o={};i.forEach((function(t,n){return t.forEach((function(t){return o[t]=n}))}));var s=[];return n.forEach((function(t){var n=r.getSourceIndex(t),i=r.getTargetIndex(t);o[n]!==o[i]&&s.push({axis:e,left:n,right:i,gap:r.getMinSeparation(t)})})),s},e.stronglyConnectedComponents=a},{}],14:[function(t,n,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(t,n,e){this.source=t,this.target=n,this.type=e};e.PowerEdge=r;var i=function(){function t(t,n,e,r){var i=this;if(this.linkAccessor=e,this.modules=new Array(t),this.roots=[],r)this.initModulesFromGroup(r);else{this.roots.push(new s);for(var a=0;a<t;++a)this.roots[0].add(this.modules[a]=new o(a))}this.R=n.length,n.forEach((function(t){var n=i.modules[e.getSourceIndex(t)],r=i.modules[e.getTargetIndex(t)],o=e.getType(t);n.outgoing.add(o,r),r.incoming.add(o,n)}))}return t.prototype.initModulesFromGroup=function(t){var n=new s;this.roots.push(n);for(var e=0;e<t.leaves.length;++e){var r=t.leaves[e],i=new o(r.id);this.modules[r.id]=i,n.add(i)}if(t.groups)for(var a=0;a<t.groups.length;++a){var c=t.groups[a],l={};for(var f in c)"leaves"!==f&&"groups"!==f&&c.hasOwnProperty(f)&&(l[f]=c[f]);n.add(new o(-1-a,new u,new u,this.initModulesFromGroup(c),l))}return n},t.prototype.merge=function(t,n,e){void 0===e&&(e=0);var r=t.incoming.intersection(n.incoming),i=t.outgoing.intersection(n.outgoing),a=new s;a.add(t),a.add(n);var u=new o(this.modules.length,i,r,a);this.modules.push(u);var c=function(e,r,i){e.forAll((function(e,o){e.forAll((function(e){var a=e[r];a.add(o,u),a.remove(o,t),a.remove(o,n),t[i].remove(o,e),n[i].remove(o,e)}))}))};return c(i,"incoming","outgoing"),c(r,"outgoing","incoming"),this.R-=r.count()+i.count(),this.roots[e].remove(t),this.roots[e].remove(n),this.roots[e].add(u),u},t.prototype.rootMerges=function(t){void 0===t&&(t=0);for(var n=this.roots[t].modules(),e=n.length,r=new Array(e*(e-1)),i=0,o=0,a=e-1;o<a;++o)for(var s=o+1;s<e;++s){var u=n[o],c=n[s];r[i]={id:i,nEdges:this.nEdges(u,c),a:u,b:c},i++}return r},t.prototype.greedyMerge=function(){for(var t=0;t<this.roots.length;++t)if(!(this.roots[t].modules().length<2)){var n=this.rootMerges(t).sort((function(t,n){return t.nEdges==n.nEdges?t.id-n.id:t.nEdges-n.nEdges}))[0];if(!(n.nEdges>=this.R))return this.merge(n.a,n.b,t),!0}},t.prototype.nEdges=function(t,n){var e=t.incoming.intersection(n.incoming),r=t.outgoing.intersection(n.outgoing);return this.R-e.count()-r.count()},t.prototype.getGroupHierarchy=function(t){var n=this,e=[];return function t(n,e,r){n.forAll((function(n){if(n.isLeaf())e.leaves||(e.leaves=[]),e.leaves.push(n.id);else{var i=e;if(n.gid=r.length,!n.isIsland()||n.isPredefined()){if(i={id:n.gid},n.isPredefined())for(var o in n.definition)i[o]=n.definition[o];e.groups||(e.groups=[]),e.groups.push(n.gid),r.push(i)}t(n.children,i,r)}}))}(this.roots[0],{},e),this.allEdges().forEach((function(i){var o=n.modules[i.source],a=n.modules[i.target];t.push(new r(void 0===o.gid?i.source:e[o.gid],void 0===a.gid?i.target:e[a.gid],i.type))})),e},t.prototype.allEdges=function(){var n=[];return t.getEdges(this.roots[0],n),n},t.getEdges=function(n,e){n.forAll((function(n){n.getEdges(e),t.getEdges(n.children,e)}))},t}();e.Configuration=i;var o=function(){function t(t,n,e,r,i){void 0===n&&(n=new u),void 0===e&&(e=new u),void 0===r&&(r=new s),this.id=t,this.outgoing=n,this.incoming=e,this.children=r,this.definition=i}return t.prototype.getEdges=function(t){var n=this;this.outgoing.forAll((function(e,i){e.forAll((function(e){t.push(new r(n.id,e.id,i))}))}))},t.prototype.isLeaf=function(){return 0===this.children.count()},t.prototype.isIsland=function(){return 0===this.outgoing.count()&&0===this.incoming.count()},t.prototype.isPredefined=function(){return void 0!==this.definition},t}();function a(t,n){var e={};for(var r in t)r in n&&(e[r]=t[r]);return e}e.Module=o;var s=function(){function t(){this.table={}}return t.prototype.count=function(){return Object.keys(this.table).length},t.prototype.intersection=function(n){var e=new t;return e.table=a(this.table,n.table),e},t.prototype.intersectionCount=function(t){return this.intersection(t).count()},t.prototype.contains=function(t){return t in this.table},t.prototype.add=function(t){this.table[t.id]=t},t.prototype.remove=function(t){delete this.table[t.id]},t.prototype.forAll=function(t){for(var n in this.table)t(this.table[n])},t.prototype.modules=function(){var t=[];return this.forAll((function(n){n.isPredefined()||t.push(n)})),t},t}();e.ModuleSet=s;var u=function(){function t(){this.sets={},this.n=0}return t.prototype.count=function(){return this.n},t.prototype.contains=function(t){var n=!1;return this.forAllModules((function(e){n||e.id!=t||(n=!0)})),n},t.prototype.add=function(t,n){(t in this.sets?this.sets[t]:this.sets[t]=new s).add(n),++this.n},t.prototype.remove=function(t,n){var e=this.sets[t];e.remove(n),0===e.count()&&delete this.sets[t],--this.n},t.prototype.forAll=function(t){for(var n in this.sets)t(this.sets[n],Number(n))},t.prototype.forAllModules=function(t){this.forAll((function(n,e){return n.forAll(t)}))},t.prototype.intersection=function(n){var e=new t;return this.forAll((function(t,r){if(r in n.sets){var i=t.intersection(n.sets[r]),o=i.count();o>0&&(e.sets[r]=i,e.n+=o)}})),e},t}();e.LinkSets=u,e.getGroups=function(t,n,e,r){for(var o=t.length,a=new i(o,n,e,r);a.greedyMerge(););var s=[],u=a.getGroupHierarchy(s);return s.forEach((function(n){var e=function(e){var r=n[e];"number"==typeof r&&(n[e]=t[r])};e("source"),e("target")})),{groups:u,powerEdges:s}}},{}],15:[function(t,n,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t){this.elem=t,this.subheaps=[]}return t.prototype.toString=function(t){for(var n="",e=!1,r=0;r<this.subheaps.length;++r){var i=this.subheaps[r];i.elem?(e&&(n+=","),n+=i.toString(t),e=!0):e=!1}return""!==n&&(n="("+n+")"),(this.elem?t(this.elem):"")+n},t.prototype.forEach=function(t){this.empty()||(t(this.elem,this),this.subheaps.forEach((function(n){return n.forEach(t)})))},t.prototype.count=function(){return this.empty()?0:1+this.subheaps.reduce((function(t,n){return t+n.count()}),0)},t.prototype.min=function(){return this.elem},t.prototype.empty=function(){return null==this.elem},t.prototype.contains=function(t){if(this===t)return!0;for(var n=0;n<this.subheaps.length;n++)if(this.subheaps[n].contains(t))return!0;return!1},t.prototype.isHeap=function(t){var n=this;return this.subheaps.every((function(e){return t(n.elem,e.elem)&&e.isHeap(t)}))},t.prototype.insert=function(n,e){return this.merge(new t(n),e)},t.prototype.merge=function(t,n){return this.empty()?t:t.empty()?this:n(this.elem,t.elem)?(this.subheaps.push(t),this):(t.subheaps.push(this),t)},t.prototype.removeMin=function(t){return this.empty()?null:this.mergePairs(t)},t.prototype.mergePairs=function(n){if(0==this.subheaps.length)return new t(null);if(1==this.subheaps.length)return this.subheaps[0];var e=this.subheaps.pop().merge(this.subheaps.pop(),n),r=this.mergePairs(n);return e.merge(r,n)},t.prototype.decreaseKey=function(n,e,r,i){var o=n.removeMin(i);n.elem=o.elem,n.subheaps=o.subheaps,null!==r&&null!==o.elem&&r(n.elem,n);var a=new t(e);return null!==r&&r(e,a),this.merge(a,i)},t}();e.PairingHeap=r;var i=function(){function t(t){this.lessThan=t}return t.prototype.top=function(){return this.empty()?null:this.root.elem},t.prototype.push=function(){for(var t,n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];for(var i,o=0;i=n[o];++o)t=new r(i),this.root=this.empty()?t:this.root.merge(t,this.lessThan);return t},t.prototype.empty=function(){return!this.root||!this.root.elem},t.prototype.isHeap=function(){return this.root.isHeap(this.lessThan)},t.prototype.forEach=function(t){this.root.forEach(t)},t.prototype.pop=function(){if(this.empty())return null;var t=this.root.min();return this.root=this.root.removeMin(this.lessThan),t},t.prototype.reduceKey=function(t,n,e){void 0===e&&(e=null),this.root=this.root.decreaseKey(t,n,e,this.lessThan)},t.prototype.toString=function(t){return this.root.toString(t)},t.prototype.count=function(){return this.root.count()},t}();e.PriorityQueue=i},{}],16:[function(t,n,e){"use strict";var r,i=this&&this.__extends||(r=function(t,n){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(t,n)},function(t,n){function e(){this.constructor=t}r(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)});Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(){this.findIter=function(t){for(var n=this._root,e=this.iterator();null!==n;){var r=this._comparator(t,n.data);if(0===r)return e._cursor=n,e;e._ancestors.push(n),n=n.get_child(r>0)}return null}}return t.prototype.clear=function(){this._root=null,this.size=0},t.prototype.find=function(t){for(var n=this._root;null!==n;){var e=this._comparator(t,n.data);if(0===e)return n.data;n=n.get_child(e>0)}return null},t.prototype.lowerBound=function(t){return this._bound(t,this._comparator)},t.prototype.upperBound=function(t){var n=this._comparator;return this._bound(t,(function(t,e){return n(e,t)}))},t.prototype.min=function(){var t=this._root;if(null===t)return null;for(;null!==t.left;)t=t.left;return t.data},t.prototype.max=function(){var t=this._root;if(null===t)return null;for(;null!==t.right;)t=t.right;return t.data},t.prototype.iterator=function(){return new a(this)},t.prototype.each=function(t){for(var n,e=this.iterator();null!==(n=e.next());)t(n)},t.prototype.reach=function(t){for(var n,e=this.iterator();null!==(n=e.prev());)t(n)},t.prototype._bound=function(t,n){for(var e=this._root,r=this.iterator();null!==e;){var i=this._comparator(t,e.data);if(0===i)return r._cursor=e,r;r._ancestors.push(e),e=e.get_child(i>0)}for(var o=r._ancestors.length-1;o>=0;--o)if(n(t,(e=r._ancestors[o]).data)>0)return r._cursor=e,r._ancestors.length=o,r;return r._ancestors.length=0,r},t}();e.TreeBase=o;var a=function(){function t(t){this._tree=t,this._ancestors=[],this._cursor=null}return t.prototype.data=function(){return null!==this._cursor?this._cursor.data:null},t.prototype.next=function(){if(null===this._cursor){var t=this._tree._root;null!==t&&this._minNode(t)}else{var n;if(null===this._cursor.right)do{if(n=this._cursor,!this._ancestors.length){this._cursor=null;break}this._cursor=this._ancestors.pop()}while(this._cursor.right===n);else this._ancestors.push(this._cursor),this._minNode(this._cursor.right)}return null!==this._cursor?this._cursor.data:null},t.prototype.prev=function(){if(null===this._cursor){var t=this._tree._root;null!==t&&this._maxNode(t)}else{var n;if(null===this._cursor.left)do{if(n=this._cursor,!this._ancestors.length){this._cursor=null;break}this._cursor=this._ancestors.pop()}while(this._cursor.left===n);else this._ancestors.push(this._cursor),this._maxNode(this._cursor.left)}return null!==this._cursor?this._cursor.data:null},t.prototype._minNode=function(t){for(;null!==t.left;)this._ancestors.push(t),t=t.left;this._cursor=t},t.prototype._maxNode=function(t){for(;null!==t.right;)this._ancestors.push(t),t=t.right;this._cursor=t},t}();e.Iterator=a;var s=function(){function t(t){this.data=t,this.left=null,this.right=null,this.red=!0}return t.prototype.get_child=function(t){return t?this.right:this.left},t.prototype.set_child=function(t,n){t?this.right=n:this.left=n},t}(),u=function(t){function n(n){var e=t.call(this)||this;return e._root=null,e._comparator=n,e.size=0,e}return i(n,t),n.prototype.insert=function(t){var e=!1;if(null===this._root)this._root=new s(t),e=!0,this.size++;else{var r=new s(void 0),i=!1,o=!1,a=null,u=r,c=null,l=this._root;for(u.right=this._root;;){if(null===l?(l=new s(t),c.set_child(i,l),e=!0,this.size++):n.is_red(l.left)&&n.is_red(l.right)&&(l.red=!0,l.left.red=!1,l.right.red=!1),n.is_red(l)&&n.is_red(c)){var f=u.right===a;l===c.get_child(o)?u.set_child(f,n.single_rotate(a,!o)):u.set_child(f,n.double_rotate(a,!o))}var h=this._comparator(l.data,t);if(0===h)break;o=i,i=h<0,null!==a&&(u=a),a=c,c=l,l=l.get_child(i)}this._root=r.right}return this._root.red=!1,e},n.prototype.remove=function(t){if(null===this._root)return!1;var e=new s(void 0),r=e;r.right=this._root;for(var i=null,o=null,a=null,u=!0;null!==r.get_child(u);){var c=u;o=i,i=r,r=r.get_child(u);var l=this._comparator(t,r.data);if(u=l>0,0===l&&(a=r),!n.is_red(r)&&!n.is_red(r.get_child(u)))if(n.is_red(r.get_child(!u))){var f=n.single_rotate(r,u);i.set_child(c,f),i=f}else if(!n.is_red(r.get_child(!u))){var h=i.get_child(!c);if(null!==h)if(n.is_red(h.get_child(!c))||n.is_red(h.get_child(c))){var p=o.right===i;n.is_red(h.get_child(c))?o.set_child(p,n.double_rotate(i,c)):n.is_red(h.get_child(!c))&&o.set_child(p,n.single_rotate(i,c));var y=o.get_child(p);y.red=!0,r.red=!0,y.left.red=!1,y.right.red=!1}else i.red=!1,h.red=!0,r.red=!0}}return null!==a&&(a.data=r.data,i.set_child(i.right===r,r.get_child(null===r.left)),this.size--),this._root=e.right,null!==this._root&&(this._root.red=!1),null!==a},n.is_red=function(t){return null!==t&&t.red},n.single_rotate=function(t,n){var e=t.get_child(!n);return t.set_child(!n,e.get_child(n)),e.set_child(n,t),t.red=!0,e.red=!1,e},n.double_rotate=function(t,e){return t.set_child(!e,n.single_rotate(t.get_child(!e),!e)),n.single_rotate(t,e)},n}(o);e.RBTree=u},{}],17:[function(t,n,e){"use strict";var r,i=this&&this.__extends||(r=function(t,n){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(t,n)},function(t,n){function e(){this.constructor=t}r(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)});Object.defineProperty(e,"__esModule",{value:!0});var o=t("./vpsc"),a=t("./rbtree");function s(t){return t.bounds=void 0!==t.leaves?t.leaves.reduce((function(t,n){return n.bounds.union(t)}),u.empty()):u.empty(),void 0!==t.groups&&(t.bounds=t.groups.reduce((function(t,n){return s(n).union(t)}),t.bounds)),t.bounds=t.bounds.inflate(t.padding),t.bounds}e.computeGroupBounds=s;var u=function(){function t(t,n,e,r){this.x=t,this.X=n,this.y=e,this.Y=r}return t.empty=function(){return new t(Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY)},t.prototype.cx=function(){return(this.x+this.X)/2},t.prototype.cy=function(){return(this.y+this.Y)/2},t.prototype.overlapX=function(t){var n=this.cx(),e=t.cx();return n<=e&&t.x<this.X?this.X-t.x:e<=n&&this.x<t.X?t.X-this.x:0},t.prototype.overlapY=function(t){var n=this.cy(),e=t.cy();return n<=e&&t.y<this.Y?this.Y-t.y:e<=n&&this.y<t.Y?t.Y-this.y:0},t.prototype.setXCentre=function(t){var n=t-this.cx();this.x+=n,this.X+=n},t.prototype.setYCentre=function(t){var n=t-this.cy();this.y+=n,this.Y+=n},t.prototype.width=function(){return this.X-this.x},t.prototype.height=function(){return this.Y-this.y},t.prototype.union=function(n){return new t(Math.min(this.x,n.x),Math.max(this.X,n.X),Math.min(this.y,n.y),Math.max(this.Y,n.Y))},t.prototype.lineIntersections=function(n,e,r,i){for(var o=[[this.x,this.y,this.X,this.y],[this.X,this.y,this.X,this.Y],[this.X,this.Y,this.x,this.Y],[this.x,this.Y,this.x,this.y]],a=[],s=0;s<4;++s){var u=t.lineIntersection(n,e,r,i,o[s][0],o[s][1],o[s][2],o[s][3]);null!==u&&a.push({x:u.x,y:u.y})}return a},t.prototype.rayIntersection=function(t,n){var e=this.lineIntersections(this.cx(),this.cy(),t,n);return e.length>0?e[0]:null},t.prototype.vertices=function(){return[{x:this.x,y:this.y},{x:this.X,y:this.y},{x:this.X,y:this.Y},{x:this.x,y:this.Y}]},t.lineIntersection=function(t,n,e,r,i,o,a,s){var u=e-t,c=a-i,l=r-n,f=s-o,h=f*u-c*l;if(0==h)return null;var p=t-i,y=n-o,d=(c*y-f*p)/h,v=(u*y-l*p)/h;return d>=0&&d<=1&&v>=0&&v<=1?{x:t+d*u,y:n+d*l}:null},t.prototype.inflate=function(n){return new t(this.x-n,this.X+n,this.y-n,this.Y+n)},t}();e.Rectangle=u,e.makeEdgeBetween=function(t,n,e){var r=t.rayIntersection(n.cx(),n.cy())||{x:t.cx(),y:t.cy()},i=n.rayIntersection(t.cx(),t.cy())||{x:n.cx(),y:n.cy()},o=i.x-r.x,a=i.y-r.y,s=Math.sqrt(o*o+a*a),u=s-e;return{sourceIntersection:r,targetIntersection:i,arrowStart:{x:r.x+u*o/s,y:r.y+u*a/s}}},e.makeEdgeTo=function(t,n,e){var r=n.rayIntersection(t.x,t.y);r||(r={x:n.cx(),y:n.cy()});var i=r.x-t.x,o=r.y-t.y,a=Math.sqrt(i*i+o*o);return{x:r.x-e*i/a,y:r.y-e*o/a}};var c=function(t,n,e){this.v=t,this.r=n,this.pos=e,this.prev=h(),this.next=h()},l=function(t,n,e){this.isOpen=t,this.v=n,this.pos=e};function f(t,n){return t.pos>n.pos?1:t.pos<n.pos||t.isOpen?-1:n.isOpen?1:0}function h(){return new a.RBTree((function(t,n){return t.pos-n.pos}))}var p={getCentre:function(t){return t.cx()},getOpen:function(t){return t.y},getClose:function(t){return t.Y},getSize:function(t){return t.width()},makeRect:function(t,n,e,r){return new u(e-r/2,e+r/2,t,n)},findNeighbours:function(t,n){var e=function(e,r){for(var i,o=n.findIter(t);null!==(i=o[e]());){var a=i.r.overlapX(t.r);if((a<=0||a<=i.r.overlapY(t.r))&&(t[e].insert(i),i[r].insert(t)),a<=0)break}};e("next","prev"),e("prev","next")}},y={getCentre:function(t){return t.cy()},getOpen:function(t){return t.x},getClose:function(t){return t.X},getSize:function(t){return t.height()},makeRect:function(t,n,e,r){return new u(t,n,e-r/2,e+r/2)},findNeighbours:function(t,n){var e=function(e,r){var i=n.findIter(t)[e]();null!==i&&i.r.overlapX(t.r)>0&&(t[e].insert(i),i[r].insert(t))};e("next","prev"),e("prev","next")}};function d(t,n,e,r){void 0===r&&(r=!1);var i=t.padding,o=void 0!==t.groups?t.groups.length:0,a=void 0!==t.leaves?t.leaves.length:0,s=o?t.groups.reduce((function(t,r){return t.concat(d(r,n,e,!0))}),[]):[],u=(r?2:0)+a+o,c=new Array(u),l=new Array(u),f=0,h=function(t,n){l[f]=t,c[f++]=n};if(r){var p=t.bounds,y=n.getCentre(p),g=n.getSize(p)/2,x=n.getOpen(p),m=n.getClose(p),b=y-g+i/2,w=y+g-i/2;t.minVar.desiredPosition=b,h(n.makeRect(x,m,b,i),t.minVar),t.maxVar.desiredPosition=w,h(n.makeRect(x,m,w,i),t.maxVar)}a&&t.leaves.forEach((function(t){return h(t.bounds,t.variable)})),o&&t.groups.forEach((function(t){var e=t.bounds;h(n.makeRect(n.getOpen(e),n.getClose(e),n.getCentre(e),n.getSize(e)),t.minVar)}));var k=v(l,c,n,e);return o&&(c.forEach((function(t){t.cOut=[],t.cIn=[]})),k.forEach((function(t){t.left.cOut.push(t),t.right.cIn.push(t)})),t.groups.forEach((function(t){var e=(t.padding-n.getSize(t.bounds))/2;t.minVar.cIn.forEach((function(t){return t.gap+=e})),t.minVar.cOut.forEach((function(n){n.left=t.maxVar,n.gap+=e}))}))),s.concat(k)}function v(t,n,e,r){var i,a=t.length,s=2*a;console.assert(n.length>=a);var u=new Array(s);for(i=0;i<a;++i){var p=t[i],y=new c(n[i],p,e.getCentre(p));u[i]=new l(!0,y,e.getOpen(p)),u[i+a]=new l(!1,y,e.getClose(p))}u.sort(f);var d=new Array,v=h();for(i=0;i<s;++i){var g=u[i];if(y=g.v,g.isOpen)v.insert(y),e.findNeighbours(y,v);else{v.remove(y);var x=function(t,n){var i=(e.getSize(t.r)+e.getSize(n.r))/2+r;d.push(new o.Constraint(t.v,n.v,i))},m=function(t,n,e){for(var r,i=y[t].iterator();null!==(r=i[t]());)e(r,y),r[n].remove(y)};m("prev","next",(function(t,n){return x(t,n)})),m("next","prev",(function(t,n){return x(n,t)}))}}return console.assert(0===v.size),d}function g(t,n){return v(t,n,p,1e-6)}function x(t,n){return v(t,n,y,1e-6)}function m(t){return d(t,p,1e-6)}function b(t){return d(t,y,1e-6)}e.generateXConstraints=g,e.generateYConstraints=x,e.generateXGroupConstraints=m,e.generateYGroupConstraints=b,e.removeOverlaps=function(t){var n=t.map((function(t){return new o.Variable(t.cx())})),e=g(t,n),r=new o.Solver(n,e);r.solve(),n.forEach((function(n,e){return t[e].setXCentre(n.position())})),n=t.map((function(t){return new o.Variable(t.cy())})),e=x(t,n),(r=new o.Solver(n,e)).solve(),n.forEach((function(n,e){return t[e].setYCentre(n.position())}))};var w=function(t){function n(n,e){var r=t.call(this,0,e)||this;return r.index=n,r}return i(n,t),n}(o.Variable);e.IndexedVariable=w;var k=function(){function t(t,n,e,r,i){var o=this;if(void 0===e&&(e=null),void 0===r&&(r=null),void 0===i&&(i=!1),this.nodes=t,this.groups=n,this.rootGroup=e,this.avoidOverlaps=i,this.variables=t.map((function(t,n){return t.variable=new w(n,1)})),r&&this.createConstraints(r),i&&e&&void 0!==e.groups){t.forEach((function(t){if(t.width&&t.height){var n=t.width/2,e=t.height/2;t.bounds=new u(t.x-n,t.x+n,t.y-e,t.y+e)}else t.bounds=new u(t.x,t.x,t.y,t.y)})),s(e);var a=t.length;n.forEach((function(t){o.variables[a]=t.minVar=new w(a++,void 0!==t.stiffness?t.stiffness:.01),o.variables[a]=t.maxVar=new w(a++,void 0!==t.stiffness?t.stiffness:.01)}))}}return t.prototype.createSeparation=function(t){return new o.Constraint(this.nodes[t.left].variable,this.nodes[t.right].variable,t.gap,void 0!==t.equality&&t.equality)},t.prototype.makeFeasible=function(t){var n=this;if(this.avoidOverlaps){var e="x",r="width";"x"===t.axis&&(e="y",r="height");var i=t.offsets.map((function(t){return n.nodes[t.node]})).sort((function(t,n){return t[e]-n[e]})),o=null;i.forEach((function(t){if(o){var n=o[e]+o[r];n>t[e]&&(t[e]=n)}o=t}))}},t.prototype.createAlignment=function(t){var n=this,e=this.nodes[t.offsets[0].node].variable;this.makeFeasible(t);var r="x"===t.axis?this.xConstraints:this.yConstraints;t.offsets.slice(1).forEach((function(t){var i=n.nodes[t.node].variable;r.push(new o.Constraint(e,i,t.offset,!0))}))},t.prototype.createConstraints=function(t){var n=this,e=function(t){return void 0===t.type||"separation"===t.type};this.xConstraints=t.filter((function(t){return"x"===t.axis&&e(t)})).map((function(t){return n.createSeparation(t)})),this.yConstraints=t.filter((function(t){return"y"===t.axis&&e(t)})).map((function(t){return n.createSeparation(t)})),t.filter((function(t){return"alignment"===t.type})).forEach((function(t){return n.createAlignment(t)}))},t.prototype.setupVariablesAndBounds=function(t,n,e,r){this.nodes.forEach((function(i,o){i.fixed?(i.variable.weight=i.fixedWeight?i.fixedWeight:1e3,e[o]=r(i)):i.variable.weight=1;var a=(i.width||0)/2,s=(i.height||0)/2,c=t[o],l=n[o];i.bounds=new u(c-a,c+a,l-s,l+s)}))},t.prototype.xProject=function(t,n,e){(this.rootGroup||this.avoidOverlaps||this.xConstraints)&&this.project(t,n,t,e,(function(t){return t.px}),this.xConstraints,m,(function(t){return t.bounds.setXCentre(e[t.variable.index]=t.variable.position())}),(function(t){var n=e[t.minVar.index]=t.minVar.position(),r=e[t.maxVar.index]=t.maxVar.position(),i=t.padding/2;t.bounds.x=n-i,t.bounds.X=r+i}))},t.prototype.yProject=function(t,n,e){(this.rootGroup||this.yConstraints)&&this.project(t,n,n,e,(function(t){return t.py}),this.yConstraints,b,(function(t){return t.bounds.setYCentre(e[t.variable.index]=t.variable.position())}),(function(t){var n=e[t.minVar.index]=t.minVar.position(),r=e[t.maxVar.index]=t.maxVar.position(),i=t.padding/2;t.bounds.y=n-i,t.bounds.Y=r+i}))},t.prototype.projectFunctions=function(){var t=this;return[function(n,e,r){return t.xProject(n,e,r)},function(n,e,r){return t.yProject(n,e,r)}]},t.prototype.project=function(t,n,e,r,i,o,a,u,c){this.setupVariablesAndBounds(t,n,r,i),this.rootGroup&&this.avoidOverlaps&&(s(this.rootGroup),o=o.concat(a(this.rootGroup))),this.solve(this.variables,o,e,r),this.nodes.forEach(u),this.rootGroup&&this.avoidOverlaps&&(this.groups.forEach(c),s(this.rootGroup))},t.prototype.solve=function(t,n,e,r){var i=new o.Solver(t,n);i.setStartingPositions(e),i.setDesiredPositions(r),i.solve()},t}();e.Projection=k},{"./rbtree":16,"./vpsc":19}],18:[function(t,n,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=t("./pqueue"),i=function(t,n){this.id=t,this.distance=n},o=function(t){this.id=t,this.neighbours=[]},a=function(t,n,e){this.node=t,this.prev=n,this.d=e},s=function(){function t(t,n,e,r,a){this.n=t,this.es=n,this.neighbours=new Array(this.n);for(var s=this.n;s--;)this.neighbours[s]=new o(s);for(s=this.es.length;s--;){var u=this.es[s],c=e(u),l=r(u),f=a(u);this.neighbours[c].neighbours.push(new i(l,f)),this.neighbours[l].neighbours.push(new i(c,f))}}return t.prototype.DistanceMatrix=function(){for(var t=new Array(this.n),n=0;n<this.n;++n)t[n]=this.dijkstraNeighbours(n);return t},t.prototype.DistancesFromNode=function(t){return this.dijkstraNeighbours(t)},t.prototype.PathFromNodeToNode=function(t,n){return this.dijkstraNeighbours(t,n)},t.prototype.PathFromNodeToNodeWithPrevCost=function(t,n,e){var i=new r.PriorityQueue((function(t,n){return t.d<=n.d})),o=this.neighbours[t],s=new a(o,null,0),u={};for(i.push(s);!i.empty()&&(o=(s=i.pop()).node).id!==n;)for(var c=o.neighbours.length;c--;){var l=o.neighbours[c],f=this.neighbours[l.id];if(!s.prev||f.id!==s.prev.node.id){var h=f.id+","+o.id;if(!(h in u&&u[h]<=s.d)){var p=s.prev?e(s.prev.node.id,o.id,f.id):0,y=s.d+l.distance+p;u[h]=y,i.push(new a(f,s,y))}}}for(var d=[];s.prev;)s=s.prev,d.push(s.node.id);return d},t.prototype.dijkstraNeighbours=function(t,n){void 0===n&&(n=-1);for(var e=new r.PriorityQueue((function(t,n){return t.d<=n.d})),i=this.neighbours.length,o=new Array(i);i--;){var a=this.neighbours[i];a.d=i===t?0:Number.POSITIVE_INFINITY,a.q=e.push(a)}for(;!e.empty();){var s=e.pop();if(o[s.id]=s.d,s.id===n){for(var u=[],c=s;void 0!==c.prev;)u.push(c.prev.id),c=c.prev;return u}for(i=s.neighbours.length;i--;){var l=s.neighbours[i],f=(c=this.neighbours[l.id],s.d+l.distance);s.d!==Number.MAX_VALUE&&c.d>f&&(c.d=f,c.prev=s,e.reduceKey(c.q,c,(function(t,n){return t.q=n})))}}return o},t}();e.Calculator=s},{"./pqueue":15}],19:[function(t,n,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t){this.scale=t,this.AB=0,this.AD=0,this.A2=0}return t.prototype.addVariable=function(t){var n=this.scale/t.scale,e=t.offset/t.scale,r=t.weight;this.AB+=r*n*e,this.AD+=r*n*t.desiredPosition,this.A2+=r*n*n},t.prototype.getPosn=function(){return(this.AD-this.AB)/this.A2},t}();e.PositionStats=r;var i=function(){function t(t,n,e,r){void 0===r&&(r=!1),this.left=t,this.right=n,this.gap=e,this.equality=r,this.active=!1,this.unsatisfiable=!1,this.left=t,this.right=n,this.gap=e,this.equality=r}return t.prototype.slack=function(){return this.unsatisfiable?Number.MAX_VALUE:this.right.scale*this.right.position()-this.gap-this.left.scale*this.left.position()},t}();e.Constraint=i;var o=function(){function t(t,n,e){void 0===n&&(n=1),void 0===e&&(e=1),this.desiredPosition=t,this.weight=n,this.scale=e,this.offset=0}return t.prototype.dfdv=function(){return 2*this.weight*(this.position()-this.desiredPosition)},t.prototype.position=function(){return(this.block.ps.scale*this.block.posn+this.offset)/this.scale},t.prototype.visitNeighbours=function(t,n){var e=function(e,r){return e.active&&t!==r&&n(e,r)};this.cOut.forEach((function(t){return e(t,t.right)})),this.cIn.forEach((function(t){return e(t,t.left)}))},t}();e.Variable=o;var a=function(){function t(t){this.vars=[],t.offset=0,this.ps=new r(t.scale),this.addVariable(t)}return t.prototype.addVariable=function(t){t.block=this,this.vars.push(t),this.ps.addVariable(t),this.posn=this.ps.getPosn()},t.prototype.updateWeightedPosition=function(){this.ps.AB=this.ps.AD=this.ps.A2=0;for(var t=0,n=this.vars.length;t<n;++t)this.ps.addVariable(this.vars[t]);this.posn=this.ps.getPosn()},t.prototype.compute_lm=function(t,n,e){var r=this,i=t.dfdv();return t.visitNeighbours(n,(function(n,o){var a=r.compute_lm(o,t,e);o===n.right?(i+=a*n.left.scale,n.lm=a):(i+=a*n.right.scale,n.lm=-a),e(n)})),i/t.scale},t.prototype.populateSplitBlock=function(t,n){var e=this;t.visitNeighbours(n,(function(n,r){r.offset=t.offset+(r===n.right?n.gap:-n.gap),e.addVariable(r),e.populateSplitBlock(r,t)}))},t.prototype.traverse=function(t,n,e,r){var i=this;void 0===e&&(e=this.vars[0]),void 0===r&&(r=null),e.visitNeighbours(r,(function(r,o){n.push(t(r)),i.traverse(t,n,o,e)}))},t.prototype.findMinLM=function(){var t=null;return this.compute_lm(this.vars[0],null,(function(n){!n.equality&&(null===t||n.lm<t.lm)&&(t=n)})),t},t.prototype.findMinLMBetween=function(t,n){this.compute_lm(t,null,(function(){}));var e=null;return this.findPath(t,null,n,(function(t,n){!t.equality&&t.right===n&&(null===e||t.lm<e.lm)&&(e=t)})),e},t.prototype.findPath=function(t,n,e,r){var i=this,o=!1;return t.visitNeighbours(n,(function(n,a){o||a!==e&&!i.findPath(a,t,e,r)||(o=!0,r(n,a))})),o},t.prototype.isActiveDirectedPathBetween=function(t,n){if(t===n)return!0;for(var e=t.cOut.length;e--;){var r=t.cOut[e];if(r.active&&this.isActiveDirectedPathBetween(r.right,n))return!0}return!1},t.split=function(n){return n.active=!1,[t.createSplitBlock(n.left),t.createSplitBlock(n.right)]},t.createSplitBlock=function(n){var e=new t(n);return e.populateSplitBlock(n,null),e},t.prototype.splitBetween=function(n,e){var r=this.findMinLMBetween(n,e);if(null!==r){var i=t.split(r);return{constraint:r,lb:i[0],rb:i[1]}}return null},t.prototype.mergeAcross=function(t,n,e){n.active=!0;for(var r=0,i=t.vars.length;r<i;++r){var o=t.vars[r];o.offset+=e,this.addVariable(o)}this.posn=this.ps.getPosn()},t.prototype.cost=function(){for(var t=0,n=this.vars.length;n--;){var e=this.vars[n],r=e.position()-e.desiredPosition;t+=r*r*e.weight}return t},t}();e.Block=a;var s=function(){function t(t){this.vs=t;var n=t.length;for(this.list=new Array(n);n--;){var e=new a(t[n]);this.list[n]=e,e.blockInd=n}}return t.prototype.cost=function(){for(var t=0,n=this.list.length;n--;)t+=this.list[n].cost();return t},t.prototype.insert=function(t){t.blockInd=this.list.length,this.list.push(t)},t.prototype.remove=function(t){var n=this.list.length-1,e=this.list[n];this.list.length=n,t!==e&&(this.list[t.blockInd]=e,e.blockInd=t.blockInd)},t.prototype.merge=function(t){var n=t.left.block,e=t.right.block,r=t.right.offset-t.left.offset-t.gap;n.vars.length<e.vars.length?(e.mergeAcross(n,t,r),this.remove(n)):(n.mergeAcross(e,t,-r),this.remove(e))},t.prototype.forEach=function(t){this.list.forEach(t)},t.prototype.updateBlockPositions=function(){this.list.forEach((function(t){return t.updateWeightedPosition()}))},t.prototype.split=function(t){var n=this;this.updateBlockPositions(),this.list.forEach((function(e){var r=e.findMinLM();null!==r&&r.lm<u.LAGRANGIAN_TOLERANCE&&(e=r.left.block,a.split(r).forEach((function(t){return n.insert(t)})),n.remove(e),t.push(r))}))},t}();e.Blocks=s;var u=function(){function t(t,n){this.vs=t,this.cs=n,this.vs=t,t.forEach((function(t){t.cIn=[],t.cOut=[]})),this.cs=n,n.forEach((function(t){t.left.cOut.push(t),t.right.cIn.push(t)})),this.inactive=n.map((function(t){return t.active=!1,t})),this.bs=null}return t.prototype.cost=function(){return this.bs.cost()},t.prototype.setStartingPositions=function(t){this.inactive=this.cs.map((function(t){return t.active=!1,t})),this.bs=new s(this.vs),this.bs.forEach((function(n,e){return n.posn=t[e]}))},t.prototype.setDesiredPositions=function(t){this.vs.forEach((function(n,e){return n.desiredPosition=t[e]}))},t.prototype.mostViolated=function(){for(var n=Number.MAX_VALUE,e=null,r=this.inactive,i=r.length,o=i,a=0;a<i;++a){var s=r[a];if(!s.unsatisfiable){var u=s.slack();if((s.equality||u<n)&&(n=u,e=s,o=a,s.equality))break}}return o!==i&&(n<t.ZERO_UPPERBOUND&&!e.active||e.equality)&&(r[o]=r[i-1],r.length=i-1),e},t.prototype.satisfy=function(){null==this.bs&&(this.bs=new s(this.vs)),this.bs.split(this.inactive);for(var n=null;(n=this.mostViolated())&&(n.equality||n.slack()<t.ZERO_UPPERBOUND&&!n.active);){var e=n.left.block;if(e!==n.right.block)this.bs.merge(n);else{if(e.isActiveDirectedPathBetween(n.right,n.left)){n.unsatisfiable=!0;continue}var r=e.splitBetween(n.left,n.right);if(null===r){n.unsatisfiable=!0;continue}this.bs.insert(r.lb),this.bs.insert(r.rb),this.bs.remove(e),this.inactive.push(r.constraint),n.slack()>=0?this.inactive.push(n):this.bs.merge(n)}}},t.prototype.solve=function(){this.satisfy();for(var t=Number.MAX_VALUE,n=this.bs.cost();Math.abs(t-n)>1e-4;)this.satisfy(),t=n,n=this.bs.cost();return n},t.LAGRANGIAN_TOLERANCE=-1e-4,t.ZERO_UPPERBOUND=-1e-10,t}();e.Solver=u,e.removeOverlapInOneDimension=function(t,n,e){for(var r=t.map((function(t){return new o(t.desiredCenter)})),a=[],s=t.length,c=0;c<s-1;c++){var l=t[c],f=t[c+1];a.push(new i(r[c],r[c+1],(l.size+f.size)/2))}var h=r[0],p=r[s-1],y=t[0].size/2,d=t[s-1].size/2,v=null,g=null;return n&&(v=new o(n,1e3*h.weight),r.push(v),a.push(new i(v,h,y))),e&&(g=new o(e,1e3*p.weight),r.push(g),a.push(new i(p,g,d))),new u(r,a).solve(),{newCenters:r.slice(0,t.length).map((function(t){return t.position()})),lowerBound:v?v.position():h.position()-y,upperBound:g?g.position():p.position()+d}}},{}]},{},[1])(1)},"object"===s(n)&&void 0!==t?t.exports=a():(i=[],void 0===(o="function"==typeof(r=a)?r.apply(n,i):r)||(t.exports=o))},function(t,n,e){var r=e(8),i=e(9);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[t.i,i,""]]);var o={insert:"head",singleton:!1};r(i,o);t.exports=i.locals||{}},function(t,n,e){"use strict";var r,i=function(){return void 0===r&&(r=Boolean(window&&document&&document.all&&!window.atob)),r},o=function(){var t={};return function(n){if(void 0===t[n]){var e=document.querySelector(n);if(window.HTMLIFrameElement&&e instanceof window.HTMLIFrameElement)try{e=e.contentDocument.head}catch(t){e=null}t[n]=e}return t[n]}}(),a=[];function s(t){for(var n=-1,e=0;e<a.length;e++)if(a[e].identifier===t){n=e;break}return n}function u(t,n){for(var e={},r=[],i=0;i<t.length;i++){var o=t[i],u=n.base?o[0]+n.base:o[0],c=e[u]||0,l="".concat(u," ").concat(c);e[u]=c+1;var f=s(l),h={css:o[1],media:o[2],sourceMap:o[3]};-1!==f?(a[f].references++,a[f].updater(h)):a.push({identifier:l,updater:v(h,n),references:1}),r.push(l)}return r}function c(t){var n=document.createElement("style"),r=t.attributes||{};if(void 0===r.nonce){var i=e.nc;i&&(r.nonce=i)}if(Object.keys(r).forEach((function(t){n.setAttribute(t,r[t])})),"function"==typeof t.insert)t.insert(n);else{var a=o(t.insert||"head");if(!a)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");a.appendChild(n)}return n}var l,f=(l=[],function(t,n){return l[t]=n,l.filter(Boolean).join("\n")});function h(t,n,e,r){var i=e?"":r.media?"@media ".concat(r.media," {").concat(r.css,"}"):r.css;if(t.styleSheet)t.styleSheet.cssText=f(n,i);else{var o=document.createTextNode(i),a=t.childNodes;a[n]&&t.removeChild(a[n]),a.length?t.insertBefore(o,a[n]):t.appendChild(o)}}function p(t,n,e){var r=e.css,i=e.media,o=e.sourceMap;if(i?t.setAttribute("media",i):t.removeAttribute("media"),o&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),t.styleSheet)t.styleSheet.cssText=r;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(r))}}var y=null,d=0;function v(t,n){var e,r,i;if(n.singleton){var o=d++;e=y||(y=c(n)),r=h.bind(null,e,o,!1),i=h.bind(null,e,o,!0)}else e=c(n),r=p.bind(null,e,n),i=function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)};return r(t),function(n){if(n){if(n.css===t.css&&n.media===t.media&&n.sourceMap===t.sourceMap)return;r(t=n)}else i()}}t.exports=function(t,n){(n=n||{}).singleton||"boolean"==typeof n.singleton||(n.singleton=i());var e=u(t=t||[],n);return function(t){if(t=t||[],"[object Array]"===Object.prototype.toString.call(t)){for(var r=0;r<e.length;r++){var i=s(e[r]);a[i].references--}for(var o=u(t,n),c=0;c<e.length;c++){var l=s(e[c]);0===a[l].references&&(a[l].updater(),a.splice(l,1))}e=o}}}},function(t,n,e){"use strict";e.r(n);var r=e(4),i=e.n(r)()((function(t){return t[1]}));i.push([t.i,"/*you need this to stop horrible looking flickering of text as you drag*/\nsvg {\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n}\n\n.highlight {\n    stroke: #ffff99;\n}\n\n.link {\n    stroke-linecap: round;\n    stroke: black;\n}\n\n.certain-link {\n    opacity: 0.6;\n    stroke-opacity: 0.6;\n}\n\n.uncertain-link {\n    opacity: 0.2;\n    stroke-opacity: 0.6;\n}\n\n.link-line {\n    stroke-width: 1;\n}\n\n.link-highlight {\n    stroke-width: 10;\n    stroke-opacity: 0;\n}\n\n.complex-outline {\n    stroke: white;\n    stroke-linejoin: round;\n    stroke-width: 7;\n}\n\n.linked-complex {\n    stroke: black;\n    stroke-linejoin: round;\n    stroke-width: 1;\n}\n\n.feature-link {\n    fill: black;\n}\n\n.protein {\n    cursor: crosshair;\n}\n\n/*todo - seperate out outline*/\n.label {\n    font-size: 10pt;\n    /*font-weight: bold;*/\n\n    /*color: #fff;*/\n    /*text-shadow: white 0px 0px 1px;*/\n    -webkit-font-smoothing: antialiased;\n\n    /*text-shadow: #fff 0px 0px 1px,   #fff 0px 0px 1px,   #fff 0px 0px 1px,*/\n    /*#fff 0px 0px 1px,   #fff 0px 0px 1px,   #fff 0px 0px 1px;*/\n\n    text-shadow: -1px -1px 0 white,\n    1px -1px 0 white,\n    -1px 1px 0 white,\n    1px 1px 0 white;\n    /*-2px -1px 0 white,*/\n    /* 2px -1px 0 white,*/\n    /* -2px 1px 0 white,*/\n    /* 2px 1px 0 white;*/\n    fill: black;\n    text-anchor: end;\n}\n\n.scale-label {\n    text-anchor: middle;\n    pointer-events: none;\n}\n\n.tooltip {\n    text-anchor: start;\n}\n\n.outline {\n    stroke: black;\n    stroke-width: 1;\n    stroke-opacity: 1;\n    fill: white;\n    fill-opacity: 1;\n}\n\n.participant-highlight {\n    stroke-width: 5;\n    fill: none;\n}\n\n/*for protein bar scale*/\n.tick {\n    stroke: black;\n    pointer-events: none;\n}\n\n.sequence {\n    font-family: 'Courier New', monospace;\n    font-size: 10px;\n    text-anchor: middle;\n    pointer-events: none;\n\n    /*text-shadow: -2px -2px 0 white,*/\n    /*2px -2px 0 white,*/\n    /*-2px 2px 0 white,*/\n    /*2px 2px 0 white;*/\n\n}\n\n\n.sequence-outline {\n    font-family: 'Courier New', monospace;\n    font-size: 10px;\n    text-anchor: middle;\n    pointer-events: none;\n\n    stroke-width:4px;\n    stroke:white;\n\n    /*text-shadow: -2px -2px 0 white,*/\n    /*2px -2px 0 white,*/\n    /*-2px 2px 0 white,*/\n    /*2px 2px 0 white;*/\n\n}\n\n.custom-menu-margin {\n    padding: 20px;\n    display: none;\n    z-index: 10000;\n    position: absolute;\n}\n\n.custom-menu {\n    overflow: hidden;\n    border: 1px solid #CCC;\n    white-space: nowrap;\n    background: #FFF;\n    color: #333;\n    list-style: none;\n    padding: 0;\n    margin: 0;\n    pointer-events: all;\n}\n\n.custom-menu li {\n    padding: 8px 12px;\n    cursor: pointer;\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n}\n\n.custom-menu li:hover {\n    background-color: #DEF;\n}\n\n.bar-scale {\n    display: inline;\n    padding-left: 10px;\n}\n\n.tooltip-background {\n    fill-opacity: 0.6;\n    stroke-opacity: 1;\n    stroke-width: 1;\n}\n\n.tooltip-sub-background {\n    fill: white;\n    stroke: white;\n    opacity: 1;\n    stroke-width: 1;\n}\n\n@media only screen and (max-width: 1140px) {\n    .label {\n        text-shadow: none;\n    }\n}\n",""]),n.default=i},function(t,n,e){"use strict";e.r(n),e.d(n,"App",(function(){return zn}));e(7);var r=e(5),i=e(0),o=function(t){for(var n=t.length/6|0,e=new Array(n),r=0;r<n;)e[r]="#"+t.slice(6*r,6*++r);return e},a=o("b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc"),s=o("4e79a7f28e2ce1575976b7b259a14fedc949af7aa1ff9da79c755fbab0ab"),u=e(6),c=e(3),l={capture:function(t){return t.map((function(t){return l.makeSVGDoc(t)}))},getAllSVGElements:function(){var t=[].slice.apply(document.getElementsByTagName("iframe")),n=[document];t.forEach((function(t){try{n.push(t.contentDocument||t.contentWindow.document)}catch(n){console.log("Protected cross-domain IFrame",t)}}));var e=[];return n.forEach((function(t){var n=[].slice.apply(t.getElementsByTagName("svg"));e.push.apply(e,n)})),e},makeSVGDoc:function(t){var n=t.cloneNode(!0),e=n.ownerDocument||document;l.pruneInvisibleSubtrees(n,t);for(var r=l.usedStyles(t,!0,!0),i=l.parentChain(t,r),o=function(t,n,e,r){t.appendChild(n),Object.keys(r).forEach((function(i){var o=n.getAttribute(i)||n.style[i]||l.getComputedStyleCssText(e,i);if(null!=o){t.setAttribute(i,o);var a=r[i];a.replace?n.setAttribute(i,a.replace):a.delete&&n.removeAttribute(i)}}))},a={width:{replace:"100%"},height:{replace:"100%"},xmlns:{delete:!0}},s=!1,u=0;u<i.length;u++){var c=i[u],f=e.createElementNS("http://www.w3.org/2000/svg","svg"),h=!0;Object.keys(c).forEach((function(t){c[t]&&(f.setAttribute(t,c[t]),h=!1)})),h||(o(f,n,t,a),n=f,s=!0)}null==t.parentNode||s||(o(f=e.createElementNS("http://www.w3.org/2000/svg","svg"),n,t,a),n=f,s=!0);s&&n.setAttribute("style",l.getComputedStyleCssText(t)),n.setAttribute("version","1.1"),n.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns","http://www.w3.org/2000/svg"),n.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink");var p=e.createElement("style");p.setAttribute("type","text/css");var y=e.createTextNode(r.join("\n"));return p.appendChild(y),n.insertBefore(p,n.firstChild),n},getComputedStyleCssText:function(t,n){var e=window.getComputedStyle(t);if(n)return e[n];if(""!=e.cssText)return e.cssText;for(var r="",i=0;i<e.length;i++){var o=e[i];r+=o+": "+e.getPropertyValue(o)+"; "}return r},doPruneInvisible:!0,pruneConditionSets:[{display:"none"},{visibility:"hidden"},{opacity:"0"},{"fill-opacity":"0","stroke-opacity":"0"},{"fill-opacity":"0",stroke:"none"},{fill:"none","stroke-opacity":"0"}],pruneInvisibleSubtrees:function(t,n){if(l.doPruneInvisible){var e=window.getComputedStyle(n),r=!1;if(l.pruneConditionSets.forEach((function(t){if(!r){var i=!0;Object.keys(t).forEach((function(r){var o=t[r],a=e[r],s=n.getAttribute(r);a===o||!a&&s===o||(i=!1)})),r=i}})),r&&t.parentNode)t.parentNode.removeChild(t);else{var i=t.children,o=n.children;if(i&&i.length)for(var a=i.length;--a>=0;)l.pruneInvisibleSubtrees(i[a],o[a])}}},parentChain:function(t,n){for(var e=t.ownerDocument||document,r=[];t.parentNode!==e&&null!==t.parentNode;)t=t.parentNode,r.push({id:t.id,class:t.getAttribute("class")||""});return r.forEach((function(t){var e={id:!1,class:!1},r=t.class.split(" ").filter((function(t){return t.length>0}));n.forEach((function(n){for(var i=0;i<r.length;i++)if(n.indexOf("."+r[i])>=0){e.class=!0;break}t.id&&n.indexOf("#"+t.id)>=0&&(e.id=!0)})),Object.keys(e).forEach((function(n){e[n]||(t[n]=void 0)}))})),r},usedStyles:function(t,n,e){for(var r,i=[],o=(t.ownerDocument||document).styleSheets,a=0;a<o.length;a++){try{if(null==o[a].cssRules)continue}catch(t){continue}for(var s=0;s<o[a].cssRules.length;s++){r=o[a].cssRules[s];var u=!1;try{n&&(u=t.querySelectorAll(r.selectorText).length>0),n&&!e||(u|=t.matches(r.selectorText))}catch(t){console.warn("CSS selector error: "+r.selectorText+". Often angular issue.",t)}u&&i.push(r.cssText)}}return i},makeXMLStr:function(t,n){var e=t.serializeToString(n);return e=e.split('xmlns="http://www.w3.org/1999/xhtml"').join("")}};function f(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var h=function(){function t(n,e){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.description=n.trim(),this.seqDatum=e}var n,e,r;return n=t,(e=[{key:"toString",value:function(){return this.description+" ["+(this.seqDatum?this.seqDatum.toString():this.seqDatum.begin+" - "+this.seqDatum.end)+"]"}}])&&f(n.prototype,e),r&&f(n,r),t}();function p(t,n,e){return e=e/360*Math.PI*2,[Math.cos(e)*(t[0]-n[0])-Math.sin(e)*(t[1]-n[1])+n[0],Math.sin(e)*(t[0]-n[0])+Math.cos(e)*(t[1]-n[1])+n[1]]}var y="http://www.w3.org/2000/svg";function d(t,n){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=function(t,n){if(!t)return;if("string"==typeof t)return v(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return v(t,n)}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==e.return||e.return()}finally{if(s)throw o}}}}function v(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function g(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var x=function(){function t(){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t)}var n,e,r;return n=t,(e=[{key:"width",get:function(){return this.expanded?this.size*this.stickZoom+45+this.labelSVG.getComputedTextLength():2*this.getSymbolRadius()+15+this.labelSVG.getComputedTextLength()}},{key:"height",get:function(){return 40}},{key:"labelY",get:function(){return-5}},{key:"init",value:function(t,n,e,r){this.id=t,this.app=n,this.json=e,this.name=r,this.expanded=!1,this.postAnimExpanded=!1,this.annotationSets=new Map,this.naryLinks=new Map,this.binaryLinks=new Map,this.sequenceLinks=new Map}},{key:"initLabel",value:function(){this.labelSVG=document.createElementNS(y,"text"),this.labelSVG.setAttribute("x","0"),this.labelSVG.setAttribute("y","10"),this.labelSVG.classList.add("label"),this.name?this.labelText=this.name:this.labelText=this.id,this.labelText.length>25&&(this.labelText=this.labelText.substr(0,16)+"..."),this.labelText=this.name,this.labelTextNode=document.createTextNode(this.labelText),this.labelSVG.appendChild(this.labelTextNode),this.labelSVG.setAttribute("transform","translate( -"+this.getSymbolRadius()+" "+this.labelY+")"),this.upperGroup.appendChild(this.labelSVG)}},{key:"initOutline",value:function(){this.outline.classList.add("outline"),this.upperGroup.appendChild(this.outline)}},{key:"initListeners",value:function(){var t=this;this.upperGroup.onmousedown=function(n){t.mouseDown(n)},this.upperGroup.onmouseenter=function(n){t.mouseOver(n)},this.upperGroup.onmouseleave=function(n){t.mouseOut(n)},this.upperGroup.ontouchstart=function(n){t.touchStart(n)}}},{key:"addStoichiometryLabel",value:function(t){this.labelSVG&&(this.labelSVG.childNodes[0].data=this.labelSVG.childNodes[0].data+" ["+t+"]")}},{key:"mouseDown",value:function(t){return this.app.preventDefaultsAndStopPropagation(t),this.app.d3cola.stop(),this.app.dragElement=this,this.app.dragStart=t,!1}},{key:"touchStart",value:function(t){return this.app.preventDefaultsAndStopPropagation(t),this.app.d3cola.stop(),this.app.dragElement=this,this.app.dragStart=t,!1}},{key:"mouseOver",value:function(t){return this.app.preventDefaultsAndStopPropagation(t),this.showHighlight(!0),this.app.notifyHoverListeners([this.json]),!1}},{key:"mouseOut",value:function(t){return this.app.preventDefaultsAndStopPropagation(t),this.showHighlight(!1),this.app.hideTooltip(),this.app.notifyHoverListeners([]),!1}},{key:"getSymbolRadius",value:function(){return 15}},{key:"showHighlight",value:function(){}},{key:"getPosition",value:function(){return[this.ix,this.iy]}},{key:"setPosition",value:function(t,n){this.px=this.ix,this.py=this.iy;var e=this.width/2-this.getSymbolRadius();this.expanded&&(e-=this.size/2*this.stickZoom),this.ix=t+e,this.iy=n,this.upperGroup.setAttribute("transform","translate("+this.ix+" "+this.iy+")")}},{key:"changePosition",value:function(t,n){this.px=this.ix,this.py=this.iy,this.ix-=t,this.iy-=n,this.upperGroup.setAttribute("transform","translate("+this.ix+" "+this.iy+")")}},{key:"getAggregateSelfLinkPath",value:function(){var t=this.getSymbolRadius()+7,n=m(t,70),e=m(t,20),r=m(t,85),i=m(t,5);return"M 0,0 Q "+r.x+","+-r.y+" "+n.x+","+-n.y+" A "+t+" "+t+" 0 0 1 "+e.x+","+-e.y+" Q "+i.x+","+-i.y+" 0,0"}},{key:"checkLinks",value:function(){function t(t){var n,e=d(t.values());try{for(e.s();!(n=e.n()).done;)n.value.check()}catch(t){e.e(t)}finally{e.f()}}t(this.binaryLinks),t(this.sequenceLinks),this.selfLink&&this.selfLink.check()}},{key:"setAllLinkCoordinates",value:function(){var t,n=d(this.naryLinks.values());try{for(n.s();!(t=n.n()).done;)t.value.setLinkCoordinates()}catch(t){n.e(t)}finally{n.f()}var e,r=d(this.binaryLinks.values());try{for(r.s();!(e=r.n()).done;)e.value.setLinkCoordinates()}catch(t){r.e(t)}finally{r.f()}this.selfLink&&this.selfLink.setLinkCoordinates();var i,o=d(this.sequenceLinks.values());try{for(o.s();!(i=o.n()).done;)i.value.setLinkCoordinates()}catch(t){o.e(t)}finally{o.f()}}}])&&g(n.prototype,e),r&&g(n,r),t}();function m(t,n){var e=n/360*Math.PI*2;return{x:t*Math.cos(e),y:t*Math.sin(e)}}function b(t){return(b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function w(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,n){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==e)return;var r,i,o=[],a=!0,s=!1;try{for(e=e.call(t);!(a=(r=e.next()).done)&&(o.push(r.value),!n||o.length!==n);a=!0);}catch(t){s=!0,i=t}finally{try{a||null==e.return||e.return()}finally{if(s)throw i}}return o}(t,n)||_(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function k(t,n){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=_(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==e.return||e.return()}finally{if(s)throw o}}}}function _(t,n){if(t){if("string"==typeof t)return S(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?S(t,n):void 0}}function S(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function M(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function E(t,n){return(E=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t})(t,n)}function A(t){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var e,r=P(t);if(n){var i=P(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return L(this,e)}}function L(t,n){return!n||"object"!==b(n)&&"function"!=typeof n?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):n}function P(t){return(P=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var N=function(t){!function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),n&&E(t,n)}(a,t);var n,e,r,o=A(a);function a(){var t;return function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,a),(t=o.call(this)).nTermFeatures=[],t.cTermFeatures=[],t}return n=a,(e=[{key:"getSymbolRadius",value:function(){return 15}},{key:"showHighlight",value:function(t){this.highlight.setAttribute("stroke-opacity",t?"1":"0")}},{key:"setStickScale",value:function(t,n){var e=this.stickZoom,r=this.ix-n.x,i=this.iy-n.y,o=r*t/e-r,a=i*t/e-i;0!==this.rotation&&180!==this.rotation||(a=0);var s=this.ix+o,u=this.iy+a;this.stickZoom=t,this.scale(),this.setPosition(s,u),this.setAllLinkCoordinates()}},{key:"scale",value:function(){var t=this.size*this.stickZoom;if(this.expanded){var n=i.transform(this.labelSVG.getAttribute("transform")),e=this.app.svgElement.createSVGMatrix().rotate(n.rotate).translate(-(this.size/2*this.stickZoom+(this.nTermFeatures.length>0?25:10)),this.labelY);this.labelSVG.transform.baseVal.initialize(this.app.svgElement.createSVGTransformFromMatrix(e)),this.updateAnnotationRectanglesNoTransition(),i.select(this.background).attr("width",t).attr("x",this.getResXWithStickZoom(.5)),i.select(this.outline).attr("width",t).attr("x",this.getResXWithStickZoom(.5)),i.select(this.highlight).attr("width",t+5).attr("x",this.getResXWithStickZoom(.5)-2.5),this.setScaleGroup()}}},{key:"setScaleGroup",value:function(){this.upperGroup.appendChild(this.ticks),this.ticks.textContent="",this.scaleLabels=[];for(var t=-1,n=this.getResXWithStickZoom(this.size),e=1;e<=this.size;e++){if(1===e||e%100==0&&200*this.stickZoom>a.minXDist||e%10==0&&20*this.stickZoom>a.minXDist){var r=this.getResXWithStickZoom(e);(this.stickZoom>=8||1!==e)&&c(this,r),0==(t=(t+1)%2)&&r+a.minXDist<n&&u(this,e,r)}if(this.stickZoom>=8){var i=document.createElementNS(y,"g");i.setAttribute("transform","translate("+this.getResXWithStickZoom(e)+" 0)");var o=document.createElementNS(y,"text");o.classList.add("label","sequence"),o.setAttribute("x","0"),o.setAttribute("y","3"),o.appendChild(document.createTextNode(this.sequence[e-1]));var s=document.createElementNS(y,"text");s.classList.add("label","sequence-outline"),s.setAttribute("x","0"),s.setAttribute("y","3"),s.appendChild(document.createTextNode(this.sequence[e-1])),i.appendChild(s),this.scaleLabels.push(s),i.appendChild(o),this.scaleLabels.push(o),this.ticks.appendChild(i)}}function u(t,n,e){var r=document.createElementNS(y,"g");r.setAttribute("transform","translate("+e+" 0)");var i=document.createElementNS(y,"text");i.classList.add("label","scale-label"),i.setAttribute("x","0"),i.setAttribute("y",a.STICKHEIGHT+4),i.appendChild(document.createTextNode(n)),r.appendChild(i),t.scaleLabels.push(i),t.ticks.appendChild(r)}function c(t,n){var e=document.createElementNS(y,"line");e.classList.add("tick"),e.setAttribute("x1",n),e.setAttribute("y1","5"),e.setAttribute("x2",n),e.setAttribute("y2","10"),t.ticks.appendChild(e)}u(this,this.size,n),this.stickZoom>=8&&c(this,n)}},{key:"setExpanded",value:function(t,n){!0!==this.busy&&(t?this.toStick(!0):this.toCircle(!0,n))}},{key:"toCircle",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=arguments.length>1?arguments[1]:void 0,e=t?a.transitionTime:0;this.postAnimExpanded=!1,this.busy=!0;var r=this.getSymbolRadius();i.select(this.background).transition().attr("x",-r).attr("y",-r).attr("width",2*r).attr("height",2*r).attr("rx",r).attr("ry",r).duration(e),i.select(this.outline).transition().attr("x",-r).attr("y",-r).attr("width",2*r).attr("height",2*r).attr("rx",r).attr("ry",r).duration(e),i.select(this.highlight).transition().attr("width",2*r+5).attr("height",2*r+5).attr("x",-r-2.5).attr("y",-r-2.5).attr("rx",r+2.5).attr("ry",r+2.5).duration(e);var o=i.interpolate(this.stickZoom,0),s=i.transform(this.labelSVG.getAttribute("transform")),u=s.translate[0],c=i.interpolate(u,-(r+5)),l=null,f=null;null!=n&&(l=i.interpolate(this.ix,n.x),f=i.interpolate(this.iy,n.y));var h=this;i.select(this.ticks).transition().attr("opacity",0).duration(e/4).each("end",(function(){i.select(this).selectAll("*").remove()}));var p=this.stickZoom,y=this.rotation,d=i.ease("cubic-in-out");if(t){var v,g=k(this.annotationSets);try{for(g.s();!(v=g.n()).done;){var x=w(v.value,2),m=x[0],b=x[1];if(!0===this.app.annotationSetsShown.get(m)){var _,S=k(b);try{for(S.s();!(_=S.n()).done;){var M=_.value;if(M.fuzzyStart){var E=M.fuzzyStart;i.select(E).transition().attr("d",this.getAnnotationPieSlicePath(M.seqDatum.uncertainBegin,M.seqDatum.begin,M,!1)).duration(e)}if(M.certain){var A=M.certain;i.select(A).transition().attr("d",this.getAnnotationPieSlicePath(M.seqDatum.begin,M.seqDatum.end,M,!1)).duration(e)}if(M.fuzzyEnd){var L=M.fuzzyEnd;i.select(L).transition().attr("d",this.getAnnotationPieSlicePath(M.seqDatum.end,M.seqDatum.uncertainEnd,M,!1)).duration(e)}}}catch(t){S.e(t)}finally{S.f()}}}}catch(t){g.e(t)}finally{g.f()}i.timer((function(t){return P(t/e)}))}else P(1);function P(t){var n=i.transform(h.labelSVG.getAttribute("transform")),e=h.app.svgElement.createSVGMatrix().rotate(n.rotate).translate(c(d(t)),h.labelY);if(h.labelSVG.transform.baseVal.initialize(h.app.svgElement.createSVGTransformFromMatrix(e)),null!==l&&h.setPosition(l(d(t)),f(d(t))),h.stickZoom=o(d(t)),h.setAllLinkCoordinates(),1===t){h.expanded=!1,h.checkLinks();var r,a=k(h.annotationSets);try{for(a.s();!(r=a.n()).done;){var s=w(r.value,2),u=s[0],v=s[1];if(!0===h.app.annotationSetsShown.get(u)){var g,x=k(v);try{for(x.s();!(g=x.n()).done;){var m=g.value;if(m.fuzzyStart){var b=m.fuzzyStart;i.select(b).attr("d",h.getAnnotationPieSlicePath(m.seqDatum.uncertainBegin,m.seqDatum.begin,m))}if(m.certain){var _=m.certain;i.select(_).attr("d",h.getAnnotationPieSlicePath(m.seqDatum.begin,m.seqDatum.end,m))}if(m.fuzzyEnd){var S=m.fuzzyEnd;i.select(S).attr("d",h.getAnnotationPieSlicePath(m.seqDatum.end,m.seqDatum.uncertainEnd,m))}}}catch(t){x.e(t)}finally{x.f()}}}}catch(t){a.e(t)}finally{a.f()}return h.stickZoom=p,h.rotation=y,h.busy=!1,!0}return!!(t>1||isNaN(t))&&P(1)}}},{key:"toCircleNoTransition",value:function(){this.toCircle(!1)}},{key:"toStick",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=t?a.transitionTime:0;this.busy=!0,this.expanded=!0,this.postAnimExpanded=!0;var e=this.size*this.stickZoom,r=this.getSymbolRadius(),o=i.interpolate(2*r,e),s=i.interpolate(0,this.stickZoom),u=i.interpolate(-(r+5),-(this.size/2*this.stickZoom+(this.nTermFeatures.length>0?25:10))),c=this.stickZoom;this.stickZoom=0,this.checkLinks(),this.stickZoom=c,i.select(this.background).transition().attr("height",a.STICKHEIGHT).attr("y",-a.STICKHEIGHT/2).attr("rx",0).attr("ry",0).duration(n),i.select(this.outline).transition().attr("height",a.STICKHEIGHT).attr("y",-a.STICKHEIGHT/2).attr("rx",0).attr("ry",0).duration(n),i.select(this.highlight).transition().attr("width",e+5).attr("height",a.STICKHEIGHT+5).attr("x",this.getResXWithStickZoom(.5)-2.5).attr("y",-a.STICKHEIGHT/2-2.5).attr("rx",0).attr("ry",0).duration(n);var l=this,f=i.ease("cubic-in-out");if(t){var h,p=k(this.annotationSets);try{for(p.s();!(h=p.n()).done;){var y=w(h.value,2),d=y[0],v=y[1];if(!0===this.app.annotationSetsShown.get(d)){var g,x=k(v);try{for(x.s();!(g=x.n()).done;){var m=g.value;if(m.fuzzyStart){var b=m.fuzzyStart;b.setAttribute("d",this.getAnnotationPieSlicePath(m.seqDatum.uncertainBegin,m.seqDatum.begin,m,!1)),i.select(b).transition().attr("d",this.getAnnotationRectPath(m.seqDatum.uncertainBegin,m.seqDatum.begin,m)).duration(a.transitionTime)}if(m.certain){var _=m.certain,S=m.seqDatum.begin,M=m.seqDatum.end;m.seqDatum.uncertainBegin&&(S+=1),m.seqDatum.uncertainEnd&&(M-=1),_.setAttribute("d",this.getAnnotationPieSlicePath(S,M,m,!1)),i.select(_).transition().attr("d",this.getAnnotationRectPath(S,M,m)).duration(a.transitionTime)}if(m.fuzzyEnd){var E=m.fuzzyEnd;E.setAttribute("d",this.getAnnotationPieSlicePath(m.seqDatum.end,m.seqDatum.uncertainEnd,m,!1)),i.select(E).transition().attr("d",this.getAnnotationRectPath(m.seqDatum.end,m.seqDatum.uncertainEnd,m)).duration(a.transitionTime)}}}catch(t){x.e(t)}finally{x.f()}}}}catch(t){p.e(t)}finally{p.f()}i.timer((function(t){return A(t/n)}))}else A(1);function A(t){var n=i.transform(l.labelSVG.getAttribute("transform")),e=l.app.svgElement.createSVGMatrix().rotate(n.rotate).translate(u(f(t)),l.labelY);l.labelSVG.transform.baseVal.initialize(l.app.svgElement.createSVGTransformFromMatrix(e));var r=o(f(t));return i.select(l.highlight).attr("width",r).attr("x",-r/2+.5*l.stickZoom),i.select(l.outline).attr("width",r).attr("x",-r/2+.5*l.stickZoom),i.select(l.background).attr("width",r).attr("x",-r/2+.5*l.stickZoom),l.stickZoom=s(f(t)),l.setAllLinkCoordinates(),1===t?(l.updateAnnotationRectanglesNoTransition(),l.busy=!1,!0):!!(t>1||isNaN(t))&&A(1)}i.select(this.ticks).attr("opacity",0),this.setScaleGroup(),i.select(this.ticks).transition().attr("opacity",1).delay(.8*n).duration(n/2)}},{key:"toStickNoTransition",value:function(){this.toStick(!1)}},{key:"updateAnnotationRectanglesNoTransition",value:function(){var t,n=k(this.annotationSets);try{for(n.s();!(t=n.n()).done;){var e=w(t.value,2),r=e[0],o=e[1];if(!0===this.app.annotationSetsShown.get(r)){var a,s=k(o);try{for(s.s();!(a=s.n()).done;){var u=a.value;if(u.fuzzyStart){var c=u.fuzzyStart;i.select(c).attr("d",this.getAnnotationRectPath(u.seqDatum.uncertainBegin,u.seqDatum.begin,u))}if(u.certain){var l=u.seqDatum.begin,f=u.seqDatum.end;u.seqDatum.uncertainBegin&&(l+=1),u.seqDatum.uncertainEnd&&(f-=1),u.certain.setAttribute("d",this.getAnnotationRectPath(l,f,u))}if(u.fuzzyEnd){var h=u.fuzzyEnd;i.select(h).attr("d",this.getAnnotationRectPath(u.seqDatum.end,u.seqDatum.uncertainEnd,u))}}}catch(t){s.e(t)}finally{s.f()}}}}catch(t){n.e(t)}finally{n.f()}}},{key:"getResXWithStickZoom",value:function(t){return"n-n"===t?-this.size/2*this.stickZoom-20:"c-c"===t?this.size/2*this.stickZoom+20:(t-this.size/2)*this.stickZoom}},{key:"getResidueCoordinates",value:function(t,n){void 0===t&&console.error("ERROR: residue number is undefined");var e,r=this.getResXWithStickZoom(1*t);if(0!==r){var i=Math.abs(r),o=Math.acos(r/i),a=this.rotation/360*Math.PI*2;r=i*Math.cos(a+o),e=i*Math.sin(a+o),void 0!==n&&(r+=n*Math.cos(a+Math.PI/2),e+=n*Math.sin(a+Math.PI/2))}else e=n;return[r+=this.ix,e+=this.iy]}},{key:"clearPositionalFeatures",value:function(){this.annotations=[],this.annotationTypes=[],this.annotationsSvgGroup.textContent="",this.nTermFeatures=[],this.cTermFeatures=[]}},{key:"updatePositionalFeatures",value:function(){var t=this,n=function(n){var e=n.target.correspondingUseElement?n.target.correspondingUseElement:n.target;t.app.preventDefaultsAndStopPropagation(n),t.app.setTooltip(e.name,e.getAttribute("fill")),t.showHighlight(!0)},e=-1,r=[];function i(t,n){var e,r=k(t);try{for(r.s();!(e=r.n()).done;)if(e.value.seqDatum.overlaps(n.seqDatum))return!0}catch(t){r.e(t)}finally{r.f()}return!1}var o,a=k(this.annotationSets);try{for(a.s();!(o=a.n()).done;){var s=w(o.value,2),u=s[0],c=s[1];if(!0===this.app.annotationSetsShown.get(u)){c&&c.length>0&&(r[++e]=[]);var l,f=new Set,h=k(Array.from(c.values()).sort((function(t,n){var e=t.description,r=n.description;return e<r?-1:e>r?1:0})));try{for(h.s();!(l=h.n()).done;){var p=l.value;if(!f.has(p.toString()))if(f.add(p.toString()),"n-n"===p.seqDatum.sequenceDatumString||"c-c"===p.seqDatum.sequenceDatumString)"n-n"===p.seqDatum.sequenceDatumString?(p.rung=this.nTermFeatures.length,this.nTermFeatures.push(p)):(p.rung=this.cTermFeatures.length,this.cTermFeatures.push(p));else{var d=r[e];i(d,p)&&(r[++e]=[],d=r[e]),p.rung=e,d.push(p)}}}catch(t){h.e(t)}finally{h.f()}}}}catch(t){a.e(t)}finally{a.f()}this.rungCount=e+1;var v,g=k(this.annotationSets);try{for(g.s();!(v=g.n()).done;){var x=w(v.value,2),m=x[0],b=x[1];if(!0===this.app.annotationSetsShown.get(m)){var _,S=new Set,M=k(b.values());try{for(M.s();!(_=M.n()).done;){var E=_.value;if(!S.has(E.toString())){S.add(E.toString());var A=E.toString();if(E.seqDatum.uncertainBegin&&(E.fuzzyStart=document.createElementNS(y,"path"),this.expanded?E.fuzzyStart.setAttribute("d",this.getAnnotationRectPath(E.seqDatum.uncertainBegin,E.seqDatum.begin,E)):E.fuzzyStart.setAttribute("d",this.getAnnotationPieSlicePath(E.seqDatum.uncertainBegin,E.seqDatum.begin,E)),E.fuzzyStart.setAttribute("stroke-width","1"),E.fuzzyStart.name=A,E.fuzzyStart.onmouseover=n,this.annotationsSvgGroup.appendChild(E.fuzzyStart)),E.seqDatum.begin&&E.seqDatum.end){E.certain=document.createElementNS(y,"path");var L=E.seqDatum.begin,P=E.seqDatum.end;E.seqDatum.uncertainBegin&&(L+=1),E.seqDatum.uncertainEnd&&(P-=1),this.expanded?E.certain.setAttribute("d",this.getAnnotationRectPath(L,P,E)):E.certain.setAttribute("d",this.getAnnotationPieSlicePath(L,P,E)),E.certain.setAttribute("stroke-width","1"),E.certain.name=A,E.certain.onmouseover=n,this.annotationsSvgGroup.appendChild(E.certain)}E.seqDatum.uncertainEnd&&(E.fuzzyEnd=document.createElementNS(y,"path"),this.expanded?E.fuzzyEnd.setAttribute("d",this.getAnnotationRectPath(E.seqDatum.end,E.seqDatum.uncertainEnd,E)):E.fuzzyEnd.setAttribute("d",this.getAnnotationPieSlicePath(E.seqDatum.end,E.seqDatum.uncertainEnd,E)),E.fuzzyEnd.setAttribute("stroke-width","1"),E.fuzzyEnd.name=A,E.fuzzyEnd.onmouseover=n,this.annotationsSvgGroup.appendChild(E.fuzzyEnd))}}}catch(t){M.e(t)}finally{M.f()}}}}catch(t){g.e(t)}finally{g.f()}this.scale()}},{key:"getAnnotationPieSlicePath",value:function(t,n,e){var r,i,o,s,u,c=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],l=this.getSymbolRadius(),f=e.rung;-1===f?(i=0,r=l):r=(i=f*(o=l/this.rungCount))+o,"n-n"===t?(s=-20,u=0):"c-c"===n?(s=0,u=20):(s=(t-1)/this.size*360,u=(n-1)/this.size*360);var h=0;(u-s>180||u===s)&&(h=1);var y=p([0,i],[0,0],s-180),d=p([0,r],[0,0],s-180),v=p([0,r],[0,0],u-180),g=p([0,i],[0,0],u-180),x="M"+y[0]+","+y[1]+" L"+d[0]+","+d[1];if(c)x+=" A"+r+","+r+" 0 "+h+" 1 "+v[0]+","+v[1];else for(var m=0;m<=a.stepsInArc;m++){var b=s+(u-s)/a.stepsInArc*m,w=p([0,r],[0,0],b-180);x+=" L"+w[0]+","+w[1]}if(c)x+=" L"+g[0]+","+g[1],x+=" A"+i+","+i+" 0 "+h+" 0 "+y[0]+","+y[1];else for(var k=a.stepsInArc;k>=0;k--){var _=s+(u-s)/a.stepsInArc*k,S=p([0,i],[0,0],_-180);x+=" L"+S[0]+","+S[1]}return x+=" Z"}},{key:"getAnnotationRectPath",value:function(t,n,e){var r,i,o;"n-n"===t?(r=this.getResXWithStickZoom(.5)-20,i=20,o=a.STICKHEIGHT/this.nTermFeatures.length):"c-c"===n?(r=this.getResXWithStickZoom(this.size+.5),i=20,o=a.STICKHEIGHT/this.cTermFeatures.length):(r=this.getResXWithStickZoom(t-.5),i=(n-t+1)*this.stickZoom,o=a.STICKHEIGHT/this.rungCount);for(var s=-a.STICKHEIGHT/2+e.rung*o,u=s+o,c="M"+r+","+u+" L"+r+","+s,l=0;l<=a.stepsInArc;l++)c+=" L "+(r+i*(l/a.stepsInArc))+","+s;for(var f=a.stepsInArc;f>=0;f--)c+=" L "+(r+i*(f/a.stepsInArc))+","+u;return c+=" Z"}}])&&M(n.prototype,e),r&&M(n,r),a}(x);function C(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}N.STICKHEIGHT=20,N.MAXSIZE=0,N.transitionTime=650,N.minXDist=30,N.stepsInArc=5;var O=function(){function t(n,e){function r(t){return parseInt(t)?parseInt(t):t}if(function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.participant=n,this.sequenceDatumString=e.trim(),"?-?"===this.sequenceDatumString)this.end=1,this.uncertainEnd=n.size?n.size:1;else if("n-n"===this.sequenceDatumString)this.uncertainBegin="n-n";else if("c-c"===this.sequenceDatumString)this.uncertainEnd="c-c";else{var i,o=e.indexOf("-"),a=e.substring(0,o),s=e.substring(o+1);-1===a.indexOf(".")?this.begin=r(a):(i=a.indexOf("."),this.uncertainBegin=r(a.substring(0,i)),this.begin=r(a.substring(i+2))),-1===s.indexOf(".")?this.end=r(s):(i=s.indexOf("."),this.end=r(s.substring(0,i)),this.uncertainEnd=r(s.substring(i+2))),"n"===this.begin&&(this.uncertainBegin=1,this.begin=r(this.end),this.end=null),"c"===this.end&&(this.uncertainEnd=n.size,this.end=r(this.begin),this.begin=null),a.indexOf("<")>-1&&(this.uncertainBegin=0,this.begin=r(a.substring(1,a.length))),s.indexOf(">")>-1&&(this.end=r(s.substring(1,a.length)),this.uncertainEnd=n.size),a.indexOf(">")>-1&&s.indexOf("<")>-1&&(this.uncertainBegin=r(a.substring(1,a.length)),this.begin=r(s.substring(1,a.length)),this.end=null)}}var n,e,r;return n=t,(e=[{key:"toString",value:function(){return this.sequenceDatumString}},{key:"overlaps",value:function(t){if(this.participant===t.participant){var n=this.uncertainBegin||this.begin||this.end||this.uncertainEnd,e=this.uncertainEnd||this.end||this.begin||this.uncertainBegin,r=t.uncertainBegin||t.begin||t.end;if(n<=(t.uncertainEnd||t.end||t.begin)&&r<=e)return!0}return!1}}])&&C(n.prototype,e),r&&C(n,r),t}();function T(t){return(T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function I(t,n){return(I=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t})(t,n)}function D(t){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var e,r=j(t);if(n){var i=j(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return z(this,e)}}function z(t,n){return!n||"object"!==T(n)&&"function"!=typeof n?R(t):n}function R(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function j(t){return(j=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var q=function(t){!function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),n&&I(t,n)}(e,t);var n=D(e);function e(t,r,i,o,a){var s;!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e),(s=n.call(this)).init(t,r,i,o),s.type="protein",s.upperGroup=document.createElementNS(y,"g"),s.rotation=0,s.stickZoom=1,s.highlight=document.createElementNS(y,"rect"),s.highlight.classList.add("highlight","participant-highlight"),s.upperGroup.appendChild(s.highlight),s.background=document.createElementNS(y,"rect"),s.background.setAttribute("fill","#FFFFFF"),s.upperGroup.appendChild(s.background),s.initLabel(),s.ticks=document.createElementNS(y,"g"),s.annotationsSvgGroup=document.createElementNS(y,"g"),s.annotationsSvgGroup.setAttribute("opacity","1"),s.upperGroup.appendChild(s.annotationsSvgGroup),s.outline=document.createElementNS(y,"rect"),s.outline.setAttribute("stroke","black"),s.outline.setAttribute("stroke-width","1"),s.outline.setAttribute("fill","none"),s.upperGroup.appendChild(s.outline),s.scaleLabels=[];var u=s.getSymbolRadius();s.outline.setAttribute("x",-u),s.outline.setAttribute("y",-u),s.outline.setAttribute("width",2*u),s.outline.setAttribute("height",2*u),s.outline.setAttribute("rx",u),s.outline.setAttribute("ry",u),s.background.setAttribute("x",-u),s.background.setAttribute("y",-u),s.background.setAttribute("width",2*u),s.background.setAttribute("height",2*u),s.background.setAttribute("rx",u),s.background.setAttribute("ry",u),s.highlight.setAttribute("width",2*u+5),s.highlight.setAttribute("height",2*u+5),s.highlight.setAttribute("x",-u-2.5),s.highlight.setAttribute("y",-u-2.5),s.highlight.setAttribute("rx",u+2.5),s.highlight.setAttribute("ry",u+2.5),s.highlight.setAttribute("stroke-opacity","0"),s.labelSVG.setAttribute("transform","translate("+-(u+5)+",-5)"),s.initListeners();var c=R(s);return Object.defineProperty(R(s),"height",{get:function(){return c.expanded?120:40}}),s.showHighlight(!1),a||(a="SEQUENCEMISSING"),s.sequence=a.replace(/[^A-Z]/g,""),s.size=s.sequence.length,s.annotationSets.set("Interactor",[new h(s.json.label,new O(null,"1-"+s.size))]),s}return e}(N);function G(t){return(G="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function B(t,n){return(B=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t})(t,n)}function V(t){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var e,r=U(t);if(n){var i=U(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return F(this,e)}}function F(t,n){return!n||"object"!==G(n)&&"function"!=typeof n?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):n}function U(t){return(U=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var H=function(t){!function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),n&&B(t,n)}(e,t);var n=V(e);function e(t,r,i,o){var a;!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e),(a=n.call(this)).init(t,r,i,o),a.upperGroup=document.createElementNS(y,"g"),a.initLabel();return a.outline=document.createElementNS(y,"polygon"),a.outline.setAttribute("points","0, -10  8.66,5 -8.66,5"),a.initOutline(),a.initListeners(),a}return e}(x);function X(t){return(X="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Y(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Z(t,n){return(Z=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t})(t,n)}function W(t){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var e,r=$(t);if(n){var i=$(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return K(this,e)}}function K(t,n){return!n||"object"!==X(n)&&"function"!=typeof n?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):n}function $(t){return($=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var J=function(t){!function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),n&&Z(t,n)}(o,t);var n,e,r,i=W(o);function o(t,n,e,r){var a;return function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,o),(a=i.call(this)).init(t,n,e,r),a.upperGroup=document.createElementNS(y,"g"),a.initLabel(),a.outline=document.createElementNS(y,"rect"),a.outline.setAttribute("x","-16"),a.outline.setAttribute("y","-8"),a.outline.setAttribute("width","32"),a.outline.setAttribute("height","16"),a.outline.setAttribute("rx","6"),a.outline.setAttribute("ry","6"),a.initOutline(),a.initListeners(),a}return n=o,(e=[{key:"getSymbolRadius",value:function(){return 21}}])&&Y(n.prototype,e),r&&Y(n,r),o}(x);function Q(t){return(Q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function tt(t,n){return(tt=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t})(t,n)}function nt(t){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var e,r=rt(t);if(n){var i=rt(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return et(this,e)}}function et(t,n){return!n||"object"!==Q(n)&&"function"!=typeof n?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):n}function rt(t){return(rt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var it=function(t){!function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),n&&tt(t,n)}(e,t);var n=nt(e);function e(t,r,i,o){var a;!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e),(a=n.call(this)).init(t,r,i,o),a.upperGroup=document.createElementNS(y,"g"),a.initLabel();return a.outline=document.createElementNS(y,"polygon"),a.outline.setAttribute("points","0, -5  10, -10 0, 10 -10, -10"),a.initOutline(),a.initListeners(),a}return e}(x);function ot(t){return(ot="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function at(t,n){return(at=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t})(t,n)}function st(t){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var e,r=ct(t);if(n){var i=ct(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return ut(this,e)}}function ut(t,n){return!n||"object"!==ot(n)&&"function"!=typeof n?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):n}function ct(t){return(ct=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var lt=function(t){!function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),n&&at(t,n)}(e,t);var n=st(e);function e(t,r,i,o){var a;!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e),(a=n.call(this)).init(t,r,i,o),a.upperGroup=document.createElementNS(y,"g"),a.initLabel();return a.outline=document.createElementNS(y,"polygon"),a.outline.setAttribute("points","0, -10  10, 0 0, 10 -10, 0"),a.initOutline(),a.initListeners(),a}return e}(x),ft=e(1),ht=e(2);function pt(t){return(pt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function yt(t,n){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=function(t,n){if(!t)return;if("string"==typeof t)return dt(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return dt(t,n)}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==e.return||e.return()}finally{if(s)throw o}}}}function dt(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function vt(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function gt(t,n){return(gt=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t})(t,n)}function xt(t){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var e,r=bt(t);if(n){var i=bt(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return mt(this,e)}}function mt(t,n){return!n||"object"!==pt(n)&&"function"!=typeof n?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):n}function bt(t){return(bt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var wt=function(t){!function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),n&&gt(t,n)}(o,t);var n,e,r,i=xt(o);function o(t,n){var e;return function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,o),(e=i.call(this)).init(t,n),e.type="complex",e.padding=28,e}return n=o,(e=[{key:"initLink",value:function(t){this.naryLink=t,this.naryLink.path.classList.add("complex-outline")}},{key:"setLinked",value:function(){this.naryLink.path2.classList.add("linked-complex")}},{key:"getPosition",value:function(t){var n=this.naryLink.mapped;n||(this.naryLink.setLinkCoordinates(),n=this.naryLink.mapped);for(var e=n.length,r=0,i=0,o=0;o<e;o++)r+=n[o][0],i+=n[o][1];var a=[r/e,i/e];if(t){var s,u=[],c=yt(this.naryLink.hull);try{for(c.s();!(s=c.n()).done;){var l=s.value;u.push(new ft(l[0],l[1]))}}catch(t){c.e(t)}finally{c.f()}var f=new ft(a[0],a[1]),h=new ft(t[0],t[1]),p=ht.intersectLinePolygon(f,h,u);if(p.points[0])return[p.points[0].x,p.points[0].y];this.setLinked()}return a}},{key:"setPosition",value:function(){console.error("bad - called setPosition on ",this)}},{key:"changePosition",value:function(t,n){var e,r=yt(this.naryLink.participants);try{for(r.s();!(e=r.n()).done;)e.value.changePosition(t,n)}catch(t){r.e(t)}finally{r.f()}}},{key:"getResidueCoordinates",value:function(){return this.getPosition()}}])&&vt(n.prototype,e),r&&vt(n,r),o}(x);function kt(t){return(kt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _t(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function St(t,n){return(St=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t})(t,n)}function Mt(t){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var e,r=At(t);if(n){var i=At(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return Et(this,e)}}function Et(t,n){return!n||"object"!==kt(n)&&"function"!=typeof n?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):n}function At(t){return(At=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Lt=function(t){!function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),n&&St(t,n)}(o,t);var n,e,r,i=Mt(o);function o(t,n,e,r){var a;!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,o),(a=i.call(this)).init(t,n,r,e),a.upperGroup=document.createElementNS(y,"g"),a.initLabel();return a.outline=document.createElementNS(y,"polygon"),a.outline.setAttribute("points","15,0 8,-13 -7,-13 -15,0 -8,13 7,13"),a.initOutline(),a.initListeners(),a}return n=o,(e=[{key:"getSymbolRadius",value:function(){return 20}}])&&_t(n.prototype,e),r&&_t(n,r),o}(x);function Pt(t){return(Pt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Nt(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ct(t,n){return(Ct=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t})(t,n)}function Ot(t){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var e,r=It(t);if(n){var i=It(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return Tt(this,e)}}function Tt(t,n){return!n||"object"!==Pt(n)&&"function"!=typeof n?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):n}function It(t){return(It=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Dt=function(t){!function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),n&&Ct(t,n)}(o,t);var n,e,r,i=Ot(o);function o(t,n,e,r){var a;return function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,o),(a=i.call(this)).init(t,n,e,r),a.upperGroup=document.createElementNS(y,"g"),a.initLabel(),a.outline=document.createElementNS(y,"rect"),a.outline.setAttribute("x","-20"),a.outline.setAttribute("y","-10"),a.outline.setAttribute("width","40"),a.outline.setAttribute("height","20"),a.outline.setAttribute("rx","5"),a.outline.setAttribute("ry","5"),a.outline.setAttribute("stroke","black"),a.outline.setAttribute("stroke-width","4"),a.outline.setAttribute("stroke-opacity","1"),a.outline.setAttribute("fill-opacity","1"),a.outline.setAttribute("fill","#ffffff"),a.upperGroup.appendChild(a.outline),a.upperLine=document.createElementNS(y,"rect"),a.upperLine.setAttribute("x","-20"),a.upperLine.setAttribute("y","-10"),a.upperLine.setAttribute("width","40"),a.upperLine.setAttribute("height","20"),a.upperLine.setAttribute("rx","5"),a.upperLine.setAttribute("ry","5"),a.upperLine.setAttribute("stroke","white"),a.upperLine.setAttribute("stroke-width","2"),a.upperLine.setAttribute("stroke-opacity","1"),a.upperLine.setAttribute("fill","none"),a.upperGroup.appendChild(a.upperLine),a.initListeners(),a}return n=o,(e=[{key:"getSymbolRadius",value:function(){return 25}}])&&Nt(n.prototype,e),r&&Nt(n,r),o}(x);function zt(t,n){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=function(t,n){if(!t)return;if("string"==typeof t)return Rt(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Rt(t,n)}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==e.return||e.return()}finally{if(s)throw o}}}}function Rt(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function jt(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var qt=function(){function t(){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t)}var n,e,r;return n=t,(e=[{key:"highlightParticipants",value:function(t){var n,e=zt(this.participants);try{for(e.s();!(n=e.n()).done;)n.value.showHighlight(t)}catch(t){e.e(t)}finally{e.f()}}},{key:"initSVG",value:function(){this.line.classList.add("link","link-line"),this.highlightLine.classList.add("link","highlight","link-highlight");var t=this;this.line.onmousedown=function(n){t.mouseDown(n)},this.line.onmouseover=function(n){t.mouseOver(n)},this.line.onmouseout=function(n){t.mouseOut(n)},this.highlightLine.onmousedown=function(n){t.mouseDown(n)},this.highlightLine.onmouseover=function(n){t.mouseOver(n)},this.highlightLine.onmouseout=function(n){t.mouseOut(n)}}},{key:"mouseDown",value:function(t){return this.app.preventDefaultsAndStopPropagation(t),this.app.d3cola.stop(),this.app.dragElement=this,this.app.dragStart=t,!1}},{key:"mouseOver",value:function(t){return this.app.preventDefaultsAndStopPropagation(t),this.app.setTooltip(this.getToolTip(),this.color),!1}},{key:"getToolTip",value:function(){return this.id}},{key:"mouseOut",value:function(t){return this.app.preventDefaultsAndStopPropagation(t),this.app.hideTooltip(),!1}},{key:"touchStart",value:function(t){return this.app.preventDefaultsAndStopPropagation(t),this.app.d3cola.stop(),this.app.dragElement=this,this.app.dragStart=t,!1}},{key:"hide",value:function(){this.highlightLine.remove(),this.line.remove()}}])&&jt(n.prototype,e),r&&jt(n,r),t}();function Gt(t){return(Gt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Bt(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Vt(t,n){return(Vt=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t})(t,n)}function Ft(t){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var e,r=Ht(t);if(n){var i=Ht(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return Ut(this,e)}}function Ut(t,n){return!n||"object"!==Gt(n)&&"function"!=typeof n?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):n}function Ht(t){return(Ht=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Xt=function(t){!function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),n&&Vt(t,n)}(a,t);var n,e,r,o=Ft(a);function a(t,n){var e;return function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,a),(e=o.call(this)).id=t,e.participants=[],e.sequenceLinks=new Map,e.binaryLinks=new Map,e.unaryLinks=new Map,e.app=n,e.initSVG(),e}return n=a,(e=[{key:"initSVG",value:function(){this.path=document.createElementNS(y,"path"),this.color=a.naryColors(this.id),this.path.setAttribute("fill",this.color);var t=this;this.path.onmousedown=function(n){t.mouseDown(n)},this.path.onmouseover=function(n){t.mouseOver(n)},this.path.onmouseout=function(n){t.mouseOut(n)},this.path.ontouchstart=function(n){t.touchStart(n)},this.path2=document.createElementNS(y,"path"),this.path2.setAttribute("fill","none"),this.path2.onmousedown=function(n){t.mouseDown(n)},this.path2.onmouseover=function(n){t.mouseOver(n)},this.path2.onmouseout=function(n){t.mouseOut(n)},this.path2.ontouchstart=function(n){t.touchStart(n)}}},{key:"showHighlight",value:function(t){this.highlightParticipants(t)}},{key:"check",value:function(){return this.show(),!0}},{key:"show",value:function(){this.app.naryLinks.appendChild(this.path),this.app.naryLinks.appendChild(this.path2)}},{key:"setLinkCoordinates",value:function(t){var n=this;this.mapped=this.orbitNodes(this.getMappedCoordinates());var e,r,o=(e=this.mapped,r=i.geom.hull(e),n.hull=r,"M"+r.join("L")+"Z");o&&(this.path.setAttribute("d",o),this.path2.setAttribute("d",o)),this.complex&&!t&&this.complex.setAllLinkCoordinates()}},{key:"getMappedCoordinates",value:function(){for(var t=this.participants,n=[],e=t.length,r=0;r<e;r++){var i=t[r];if("complex"===i.type)n=n.concat(this.orbitNodes(i.naryLink.getMappedCoordinates(),20));else if(i.expanded){var o=i.getResidueCoordinates(0),a=i.getResidueCoordinates(i.size);isNaN(o[0])||isNaN(o[1])||isNaN(a[0])||isNaN(a[1])?n.push(i.getPosition()):(n.push(o),n.push(a))}else n.push(i.getPosition())}return n}},{key:"orbitNodes",value:function(t){for(var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20,e=[],r=t.length,i=0;i<r;i++)for(var o=t[i],s=0;s<n;s++){var u=360/n*s,c=[o[0]+a.orbitRadius,o[1]];e.push(p(c,o,u))}return e}}])&&Bt(n.prototype,e),r&&Bt(n,r),a}(qt);function Yt(t){return(Yt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Zt(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Wt(t,n){return(Wt=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t})(t,n)}function Kt(t){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var e,r=Jt(t);if(n){var i=Jt(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return $t(this,e)}}function $t(t,n){return!n||"object"!==Yt(n)&&"function"!=typeof n?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):n}function Jt(t){return(Jt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}Xt.orbitRadius=28;var Qt=function(t){!function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),n&&Wt(t,n)}(o,t);var n,e,r,i=Kt(o);function o(t,n,e,r){var a;return function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,o),(a=i.call(this)).init(t,n,e,r),a}return n=o,(e=[{key:"init",value:function(t,n,e,r){this.id=t,this.app=r,this.fromSequenceData=n,this.toSequenceData=e,this.participants=[this.fromSequenceData[0].participant,this.toSequenceData[0].participant],this.glyph=document.createElementNS(y,"path"),this.uncertainGlyph=document.createElementNS(y,"path"),this.glyph.classList.add("link","feature-link","certain-link"),this.uncertainGlyph.classList.add("link","feature-link","uncertain-link");var i=this;this.uncertainGlyph.onmousedown=function(t){i.mouseDown(t)},this.uncertainGlyph.onmouseover=function(t){i.mouseOver(t)},this.uncertainGlyph.onmouseout=function(t){i.mouseOut(t)},this.glyph.onmousedown=function(t){i.mouseDown(t)},this.glyph.onmouseover=function(t){i.mouseOver(t)},this.glyph.onmouseout=function(t){i.mouseOut(t)}}},{key:"check",value:function(){return!0===this.anyParticipantIsBar()?(this.show(),!0):(this.hide(),!1)}},{key:"anyParticipantIsBar",value:function(){for(var t=this.participants.length,n=0;n<t;n++)if(this.participants[n].expanded)return!0;return!1}},{key:"show",value:function(){this.setLinkCoordinates();var t=this.app.res_resLinks;this.participants[0]===this.participants[1]&&(t=this.app.selfRes_resLinks),t.appendChild(this.glyph),t.appendChild(this.uncertainGlyph)}},{key:"hide",value:function(){this.glyph.remove(),this.uncertainGlyph.remove()}},{key:"setLinkCoordinates",value:function(){function t(t){return!isNaN(parseFloat(t))&&isFinite(t)}function n(t,n,e,r,i,o,a){var s,u;return i.expanded?(s=i.getResidueCoordinates(e,o),u=i.getResidueCoordinates(r,o)):u=s=i.getPosition(a)," Q"+n[0]+","+n[1]+" "+s[0]+","+s[1]+" L"+u[0]+","+u[1]+" Q"+n[0]+","+n[1]+" "+t[0]+","+t[1]}function e(t,n){for(var e=null,r=null,i=t.length,o=0;o<i;o++){var a=t[o];if(!isNaN(parseFloat(a.begin))&&isFinite(a.begin)){var s=1*a.begin;(null===e||s<e)&&(e=s)}if(!isNaN(parseFloat(a.uncertainBegin))&&isFinite(a.uncertainBegin)){var u=1*a.uncertainBegin;(null===e||u<e)&&(e=u)}if(!isNaN(parseFloat(a.end))&&isFinite(a.end)){var c=1*a.end;(null===r||c>r)&&(r=c)}if(!isNaN(parseFloat(a.uncertainEnd))&&isFinite(a.uncertainEnd)){var l=1*a.uncertainEnd;(null===r||l>r)&&(r=l)}}return n.getResidueCoordinates((e+r)/2,0)}var r,i,o=this.fromSequenceData[0].participant,a=this.toSequenceData[0].participant;o.expanded&&(r=e(this.fromSequenceData,o)),a.expanded&&(i=e(this.toSequenceData,a)),o.expanded||(r=o.getPosition(i)),a.expanded||(i=a.getPosition(r));var s=r,u=i,c=r[0]-i[0],l=r[1]-i[1],f=Math.atan2(l,c)/(2*Math.PI)*360;f<0&&(f+=360);var h=f-o.rotation;h<0&&(h+=360);var p=10;h<180&&(p=-10);var y=o.rotation/360*Math.PI*2;h>180&&(y-=Math.PI),(h=f-a.rotation)<0&&(h+=360);var d=10;h>180&&(d=-10);var v=a.rotation/360*Math.PI*2;h<180&&(v-=Math.PI);var g=[r[0]+30*Math.sin(y)*this.app.z,r[1]-30*Math.cos(y)*this.app.z];o.expanded||(g=r);var x=[i[0]+30*Math.sin(v)*this.app.z,i[1]-30*Math.cos(v)*this.app.z];a.expanded||(x=i);for(var m,b=[(g[0]+x[0])/2,(g[1]+x[1])/2],w=this.fromSequenceData.length,k=this.toSequenceData.length,_="M"+b[0]+","+b[1],S="M"+b[0]+","+b[1],M=0;M<w;M++)(t((m=this.fromSequenceData[M]).begin)&&t(m.end)||"protein"!==o.type)&&(_+=n(b,g,m.begin,m.end,o,p,u)),t(m.uncertainBegin)&&(S+=n(b,g,m.uncertainBegin,m.begin,o,p,u)),t(m.uncertainEnd)&&(S+=n(b,g,m.end,m.uncertainEnd,o,p,u));for(var E=0;E<k;E++)(t((m=this.toSequenceData[E]).begin)&&t(m.end)||"protein"!==a.type)&&(_+=n(b,x,m.begin,m.end,a,d,s)),t(m.uncertainBegin)&&(S+=n(b,x,m.uncertainBegin,m.begin,a,d,s)),t(m.uncertainEnd)&&(S+=n(b,x,m.end,m.uncertainEnd,a,d,s));this.glyph||this.initSVG(),this.glyph.setAttribute("d",_),this.uncertainGlyph.setAttribute("d",S)}}])&&Zt(n.prototype,e),r&&Zt(n,r),o}(qt);function tn(t){return(tn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function nn(t,n){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=function(t,n){if(!t)return;if("string"==typeof t)return en(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return en(t,n)}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==e.return||e.return()}finally{if(s)throw o}}}}function en(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function rn(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function on(t,n){return(on=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t})(t,n)}function an(t){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var e,r=un(t);if(n){var i=un(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return sn(this,e)}}function sn(t,n){return!n||"object"!==tn(n)&&"function"!=typeof n?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):n}function un(t){return(un=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var cn=function(t){!function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),n&&on(t,n)}(o,t);var n,e,r,i=an(o);function o(t,n,e,r){var a;return function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,o),(a=i.call(this)).id=t,a.participants=[e,r],a.sequenceLinks=new Map,a.app=n,a.line=document.createElementNS(y,"line"),a.highlightLine=document.createElementNS(y,"line"),a.initSVG(),a}return n=o,(e=[{key:"check",value:function(){return this.participants[0].expanded||this.participants[1].expanded?(this.hide(),!1):(this.show(),!0)}},{key:"show",value:function(){this.line.setAttribute("stroke-width",1*this.app.z),this.highlightLine.setAttribute("stroke-width",10*this.app.z),this.setLinkCoordinates(this.participants[0]),this.setLinkCoordinates(this.participants[1]),this.app.highlights.appendChild(this.highlightLine),this.app.p_pLinks.appendChild(this.line)}},{key:"setLinkCoordinates",value:function(){void 0===this.line&&this.initSVG();var t,n,e,r,i,o=this.participants[0].getPosition(),a=this.participants[1].getPosition(),s=function(s){t=s.naryLink.hull,n=[];var u,c=nn(t);try{for(c.s();!(u=c.n()).done;){var l=u.value;n.push(new ft(l[0],l[1]))}}catch(t){c.e(t)}finally{c.f()}if(e=new ft(o[0],o[1]),r=new ft(a[0],a[1]),(i=ht.intersectLinePolygon(e,r,n)).points[0])return[i.points[0].x,i.points[0].y]};if("complex"===this.participants[0].type){var u=s(this.participants[0]);u&&(o=u)}if("complex"===this.participants[1].type){var c=s(this.participants[1]);c&&(a=c)}this.line.setAttribute("x1",o[0]),this.line.setAttribute("y1",o[1]),this.highlightLine.setAttribute("x1",o[0]),this.highlightLine.setAttribute("y1",o[1]),this.line.setAttribute("x2",a[0]),this.line.setAttribute("y2",a[1]),this.highlightLine.setAttribute("x2",a[0]),this.highlightLine.setAttribute("y2",a[1])}}])&&rn(n.prototype,e),r&&rn(n,r),o}(qt);function ln(t){return(ln="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function fn(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function hn(t,n){return(hn=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t})(t,n)}function pn(t){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var e,r=dn(t);if(n){var i=dn(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return yn(this,e)}}function yn(t,n){return!n||"object"!==ln(n)&&"function"!=typeof n?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):n}function dn(t){return(dn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var vn=function(t){!function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),n&&hn(t,n)}(o,t);var n,e,r,i=pn(o);function o(t,n,e){var r;return function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,o),(r=i.call(this)).id=t,r.participants=[e],r.sequenceLinks=new Map,r.app=n,r.line=document.createElementNS(y,"path"),r.highlightLine=document.createElementNS(y,"path"),r.initSVG(),r}return n=o,(e=[{key:"initSelfLinkSVG",value:function(){var t=this.participants[0].getAggregateSelfLinkPath();this.line.setAttribute("d",t),this.highlightLine.setAttribute("d",t)}},{key:"check",value:function(){return this.participants[0].expanded?(this.hide(),!1):(this.show(),!0)}},{key:"show",value:function(){this.line.setAttribute("transform","translate("+this.participants[0].ix+" "+this.participants[0].iy+") scale("+this.app.z+")"),this.highlightLine.setAttribute("transform","translate("+this.participants[0].ix+" "+this.participants[0].iy+") scale("+this.app.z+")"),this.app.highlights.appendChild(this.highlightLine),this.app.p_pLinks.appendChild(this.line)}},{key:"setLinkCoordinates",value:function(){var t=this.participants[0];this.line.setAttribute("transform","translate("+t.ix+" "+t.iy+") scale("+this.app.z+")"),this.highlightLine.setAttribute("transform","translate("+t.ix+" "+t.iy+") scale("+this.app.z+")")}}])&&fn(n.prototype,e),r&&fn(n,r),o}(qt);function gn(t){var n=t.data.filter((function(t){return"interaction"===t.object})),e=t.data.filter((function(t){return"interactor"===t.object}));return n.forEach((function(t){t.participants.filter((function(t){if(t.stoichiometry>1)return t})).forEach((function(n){if(xn(e,"id",n.interactorRef))for(var r=function(e){var r=JSON.parse(JSON.stringify(n));r.id=r.id+"_"+e,r.cloneParentID=n.id,r.cloneIteration=e,n.cloned=!0,r.features&&r.features.forEach((function(t){t.clonedfrom=t.id,t.id=t.id+"_"+e,t.sequenceData.forEach((function(t){t.participantRef=r.id}))})),t.participants.push(r)},i=0;i<n.stoichiometry-1;i++)r(i)}));var n=new Map;t.participants.forEach((function(t){t.features&&t.features.forEach((function(e){e.parentParticipant=t.id,n.set(e.id,e)}))}));var r=Array.from(n.values());r.forEach((function(n){n.clonedfrom&&r.forEach((function(e){var r=e.linkedFeatures;if(r&&r.indexOf(n.clonedfrom)>-1){var i=JSON.parse(JSON.stringify(e));i.id=e.id+"_"+n.id,i.linkedFeatures=[],i.linkedFeatures.push(n.id),xn(t.participants,"id",i.parentParticipant).features.push(i)}}))}))})),n.forEach((function(t){t.participants.forEach((function(t){t.stoichiometry=null}))})),t}function xn(t,n,e){for(var r=0;r<t.length;r+=1)if(t[r][n]===e)return t[r]}function mn(t,n){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=function(t,n){if(!t)return;if("string"==typeof t)return bn(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return bn(t,n)}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==e.return||e.return()}finally{if(s)throw o}}}}function bn(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function wn(t){var n=t.data.filter((function(t){return"interaction"===t.object})),e=(t.data.filter((function(t){return"interactor"===t.object})),new Map);return n.forEach((function(r){r.participants.filter((function(t){if(-1!==t.interactorRef.indexOf("complex"))return t})).forEach((function(r){var i=function(t,n,e){for(var r=0;r<t.length;r+=1)if(t[r][n]===e)return t[r]}(n,"id",r.interactorRef);i&&function(){var n=e.get(r.interactorRef);n?n+=1:n=1,e.set(r.interactorRef,n);var o=n;if(o>1){r.interactorRef=r.interactorRef+"_"+o,r.features&&r.features.forEach((function(t){t.copiedfrom=t.id,t.sequenceData.forEach((function(t){t.participantRef=t.participantRef+"_"+o}))}));var a=JSON.parse(JSON.stringify(i));a.id=a.id+"_"+o,t.data.push(a);var s,u=mn(a.participants);try{var c=function(){var t=s.value;t.id=t.id+"_"+o,t.features&&t.features.forEach((function(n){n.id=n.id+"_"+o,n.sequenceData.forEach((function(n){n.participantRef=t.id}));for(var e=n.linkedFeatures.length,r=0;r<e;r++)n.linkedFeatures[r]=n.linkedFeatures[r]+"_"+o}))};for(u.s();!(s=u.n()).done;)c()}catch(t){u.e(t)}finally{u.f()}}}()}))})),t}function kn(t,n){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=function(t,n){if(!t)return;if("string"==typeof t)return _n(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return _n(t,n)}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==e.return||e.return()}finally{if(s)throw o}}}}function _n(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function Sn(t){return(Sn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Mn(t,n){var e=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];(t="object"===Sn(t)?t:JSON.parse(t)).data=t.data.reverse(),n.features=new Map;var r=new Map;t=wn(t),n.proteinCount=0,n.interactors=new Map;var i,o=kn(t.data);try{for(o.s();!(i=o.n()).done;){var a=i.value;"interactor"===a.object&&(n.interactors.set(a.id,a),0===a.id.indexOf("uniprotkb_")&&n.proteinCount++)}}catch(t){o.e(t)}finally{o.f()}e?st():ft();var s,u=kn(t.data);try{for(u.s();!(s=u.n()).done;){var c=s.value;if("interaction"===c.object){var l,f=kn(c.participants);try{for(f.s();!(l=f.n()).done;){var p=l.value,y=new Array(0);p.features&&(y=p.features);var d,v=kn(y);try{for(v.s();!(d=v.n()).done;){var g=d.value,x=g.sequenceData;if(g.linkedFeatures)for(var m=g.linkedFeatures,b=m.length,w=0;w<b;w++){var k,_=new Map,S=n.features.get(m[w]),M=kn(S.sequenceData);try{for(M.s();!(k=M.n()).done;){var E=k.value,A=E.interactorRef;e&&(A=A+"("+E.participantRef+")");var L=_.get(A);void 0===L&&(L=[],_.set(A,L)),L=L.push(E)}}catch(t){M.e(t)}finally{M.f()}var P,N=kn(_.values());try{for(N.s();!(P=N.n()).done;){var C=P.value,T=pt(x[0]),I=pt(C[0]),D=void 0;D=T===I?dt(T,c):vt(T,I,c);var z=yt(x,C,c);T.sequenceLinks.set(z.id,z),I.sequenceLinks.set(z.id,z),D.sequenceLinks.set(z.id,z)}}catch(t){N.e(t)}finally{N.f()}}}}catch(t){v.e(t)}finally{v.f()}}}catch(t){f.e(t)}finally{f.f()}}}}catch(t){u.e(t)}finally{u.f()}n.complexes=Array.from(r.values());for(var R=0;R<n.complexes.length;R++){var j=n.complexes[R],G=void 0;G=e?j.id.substring(0,j.id.indexOf("(")):j.id;var B,V=kn(t.data);try{for(V.s();!(B=V.n()).done;){var F=B.value;if("interaction"===F.object&&F.id===G){var U=ht(F),X=n.allNaryLinks.get(U);j.initLink(X),X.complex=j}}}catch(t){V.e(t)}finally{V.f()}}var Y,Z=kn(n.features.values());try{for(Z.s();!(Y=Z.n()).done;){var W=Y.value,K="";if(void 0!==W.name&&(K+=W.name+" "),void 0!==W.detmethod&&(K+=", "+W.detmethod.name),W.sequenceData){var $,Q=kn(W.sequenceData);try{for(Q.s();!($=Q.n()).done;){var tt=$.value,nt=tt.interactorRef;e&&(nt=nt+"("+tt.participantRef+")");var et=n.participants.get(nt);if(et){var rt=new O(et,tt.pos),ot=new h(K,rt),at=et.annotationSets.get("MI Features");at||(at=[],et.annotationSets.set("MI Features",at)),at.push(ot)}else console.log("participant "+nt+" not found!")}}catch(t){Q.e(t)}finally{Q.f()}}}}catch(t){Z.e(t)}finally{Z.f()}function st(){var e,r=0,i=kn(t.data);try{for(i.s();!(e=i.n()).done;){var o=e.value;if("interaction"===o.object){var a,s=kn(o.participants);try{for(s.s();!(a=s.n()).done;){var u=a.value;u.stoichiometry&&u.stoichiometry-0>r&&(r=u.stoichiometry-0)}}catch(t){s.e(t)}finally{s.f()}}}}catch(t){i.e(t)}finally{i.f()}r<20&&(t=gn(t)),ct();var c,l=kn(t.data);try{for(l.s();!(c=l.n()).done;){var f=c.value;if("interaction"===f.object){var h=f.id||ht(f),p=n.allNaryLinks.get(h);void 0===p&&(p=new Xt(h,n),n.allNaryLinks.set(h,p),f.naryId=h);var y,d=kn(f.participants);try{for(d.s();!(y=d.n()).done;){var v=y.value,g=v.interactorRef,x=g+"("+v.id+")",m=n.participants.get(x);if(void 0===m)m=ut(n.interactors.get(g),x,g),n.participants.set(x,m);if(m.naryLinks.set(h,p),-1===p.participants.indexOf(m)&&p.participants.push(m),v.stoichiometry)n.participants.get(x).addStoichiometryLabel(v.stoichiometry)}}catch(t){d.e(t)}finally{d.f()}}}}catch(t){l.e(t)}finally{l.f()}}function ut(e,i,o){var a;if(void 0===e||"MI:1302"===e.type.id){var s,u=!1,c=kn(t.data);try{for(c.s();!(s=c.n()).done;){var l=s.value;if("interaction"===l.object&&l.id===o){u=!0;break}}}catch(t){c.e(t)}finally{c.f()}u?(a=new wt(i,n,o),r.set(i,a)):a=new Lt(i,n,o,e)}else"MI:1304"===e.type.id||"MI:1305"===e.type.id||"MI:1307"===e.type.id||"MI:1306"===e.type.id?a=new Dt(i,n,e,e.label):"MI:1100"===e.type.id||"MI:0904"===e.type.id||"MI:0328"===e.type.id||"MI:2258"===e.type.id?a=new H(i,n,e,e.label):"MI:0326"===e.type.id||"MI:0327"===e.type.id?a=new q(i,n,e,e.label,e.sequence):"MI:0250"===e.type.id?a=new J(i,n,e,e.label):"MI:0320"===e.type.id||"MI:0321"===e.type.id||"MI:0322"===e.type.id||"MI:0323"===e.type.id||"MI:2190"===e.type.id||"MI:0324"===e.type.id||"MI:0679"===e.type.id||"MI:0608"===e.type.id||"MI:0611"===e.type.id||"MI:0610"===e.type.id||"MI:0607"===e.type.id||"MI:0609"===e.type.id||"MI:0325"===e.type.id||"IA:2966"===e.type.id||"MI:2359"===e.type.id||"MI:0318"===e.type.id||"MI:2204"===e.type.id?a=new lt(i,n,e,e.label):"MI:0319"===e.type.id||"MI:0681"===e.type.id||"MI:0680"===e.type.id?a=new it(i,n,e,e.label):alert("Unrecognised type:"+e.type.name);return a}function ct(){var e,r=kn(t.data);try{for(r.s();!(e=r.n()).done;){var i=e.value;if("interaction"===i.object){var o,a=kn(i.participants);try{for(a.s();!(o=a.n()).done;){var s=o.value,u=new Array(0);s.features&&(u=s.features);for(var c=u.length,l=0;l<c;l++){var f,h=u[l],p=kn(h.sequenceData);try{for(p.s();!(f=p.n()).done;){var y=f.value;y.interactorRef||(y.interactorRef=s.interactorRef),y.participantRef||(y.participantRef=h.parentParticipant)}}catch(t){p.e(t)}finally{p.f()}n.features.set(h.id,h)}}}catch(t){a.e(t)}finally{a.f()}}}}catch(t){r.e(t)}finally{r.f()}}function ft(){var e,i=kn(n.interactors.values());try{for(i.s();!(e=i.n()).done;){var o=e.value,a=o.id,s=ut(o,a);n.participants.set(a,s)}}catch(t){i.e(t)}finally{i.f()}ct();var u,c=kn(t.data);try{for(c.s();!(u=c.n()).done;){var l=u.value;if("interaction"===l.object){var f=l.participants,h=f.length,p=ht(l),y=n.allNaryLinks.get(p);void 0===y&&(y=new Xt(p,n),n.allNaryLinks.set(p,y));for(var d=0;d<h;d++){var v=f[d],g=v.interactorRef,x=n.participants.get(g);void 0===x&&(x=new wt(g,n),r.set(g,x),n.participants.set(g,x)),x.naryLinks.set(p,y),-1===y.participants.indexOf(x)&&y.participants.push(x);var m=n.participants.get(g);m.stoich=m.stoich?m.stoich:0,v.stoichiometry?m.stoich+=+v.stoichiometry:m.stoich+=1}for(var b=n.participants.values(),w=b.length,k=0;k<w;k++){var _=b[k];_.addStoichiometryLabel(_.stoich)}}}}catch(t){c.e(t)}finally{c.f()}}function ht(t){if(t.naryId)return t.naryId;for(var n=t.participants,r=n.length,i=new Set,o=0;o<r;o++){var a=n[o].interactorRef;e&&(a=a+"("+n[o].id+")"),i.add(a)}return Array.from(i.values()).sort().join("-")}function pt(t){var r=t.interactorRef;return e&&(r=r+"("+t.participantRef+")"),n.participants.get(r)}function yt(t,r,i){function o(t){for(var n=new Set,r=0;r<t.length;r++){var i=t[r],o=i.interactorRef;e&&(o=o+"("+i.participantRef+")"),o=o+":"+i.pos,n.add(o)}return Array.from(n.values()).sort().join(";")}var a,s=o(t),u=o(r);a=s<u?s+"><"+u:u+"><"+s;var c=n.allSequenceLinks.get(a);if(void 0===c){var l,f=[],h=kn(t);try{for(h.s();!(l=h.n()).done;){var p=l.value;f.push(new O(pt(p),p.pos))}}catch(t){h.e(t)}finally{h.f()}var y,d=[],v=kn(r);try{for(v.s();!(y=v.n()).done;){var g=y.value;d.push(new O(pt(g),g.pos))}}catch(t){v.e(t)}finally{v.f()}c=new Qt(a,f,d,n,i),n.allSequenceLinks.set(a,c)}var x=ht(i);return n.allNaryLinks.get(x).sequenceLinks.set(a,c),c}function dt(t,e){var r="-"+t.id+"-"+t.id,i=n.allUnaryLinks.get(r);void 0===i&&(i=new vn(r,n,t),n.allUnaryLinks.set(r,i),t.appLink=i);var o=ht(e);return n.allNaryLinks.get(o).unaryLinks.set(r,i),i}function vt(t,e,r){var i,o,a;t.id<e.id?(i="-"+t.id+"-"+e.id,o=t,a=e):(i="-"+e.id+"-"+t.id,o=e,a=t);var s=n.allBinaryLinks.get(i);void 0===s&&(s=new cn(i,n,o,a),o.binaryLinks.set(i,s),a.binaryLinks.set(i,s),n.allBinaryLinks.set(i,s));var u=ht(r);return n.allNaryLinks.get(u).binaryLinks.set(i,s),s}}function En(t,n){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=function(t,n){if(!t)return;if("string"==typeof t)return An(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return An(t,n)}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==e.return||e.return()}finally{if(s)throw o}}}}function An(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function Ln(t,n){var e="https://www.ebi.ac.uk/proteins/api/proteins/"+t.json.identifier.id.trim();i.json(e,(function(e){var r=t.annotationSets.get("UniprotKB");if(void 0===r&&(r=[],t.annotationSets.set("UniprotKB",r)),e){var i,o=En(e.features.filter((function(t){return"DOMAIN"===t.type})));try{for(o.s();!(i=o.n()).done;){var a=i.value,s=new h(a.description,new O(null,a.begin+"-"+a.end));r.push(s)}}catch(t){o.e(t)}finally{o.f()}}n()}))}function Pn(t,n){var e="https://supfam.mrc-lmb.cam.ac.uk/SUPERFAMILY/cgi-bin/das/up/features?segment="+t.json.identifier.id.trim();i.xml(e,(function(e){var r=t.annotationSets.get("Superfamily");if(void 0===r&&(r=[],t.annotationSets.set("Superfamily",r)),e){var i,o=En((new DOMParser).parseFromString((new XMLSerializer).serializeToString(e),"text/xml").getElementsByTagName("FEATURE"));try{for(o.s();!(i=o.n()).done;){var a=i.value,s=a.getElementsByTagName("TYPE")[0];if("miscellaneous"===s.getAttribute("category")){var u=s.getAttribute("id"),c=a.getElementsByTagName("START")[0].textContent,l=a.getElementsByTagName("END")[0].textContent;r.push(new h(u,new O(null,c+"-"+l)))}}}catch(t){o.e(t)}finally{o.f()}}n()}))}function Nn(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,n){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==e)return;var r,i,o=[],a=!0,s=!1;try{for(e=e.call(t);!(a=(r=e.next()).done)&&(o.push(r.value),!n||o.length!==n);a=!0);}catch(t){s=!0,i=t}finally{try{a||null==e.return||e.return()}finally{if(s)throw i}}return o}(t,n)||On(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Cn(t,n){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=On(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==e.return||e.return()}finally{if(s)throw o}}}}function On(t,n){if(t){if("string"==typeof t)return Tn(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?Tn(t,n):void 0}}function Tn(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function In(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function Dn(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var zn=function(){function t(n){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4;In(this,t),this.el=n,this.el.textContent="",this.maxCountInitiallyExpanded=e,this.d3cola=u.d3adaptor().groupCompactness(Number.MIN_VALUE).avoidOverlaps(!0);var o=i.select(this.el).append("div").classed("custom-menu-margin",!0).append("div").classed("custom-menu",!0).append("ul"),a=this,s=o.append("li").classed("collapse",!0);s.text("Collapse"),s[0][0].onclick=function(t){a.collapseProtein(t)};var c=o.append("li").text("Scale: "),l=c.selectAll("ul.custom-menu").data(t.barScales).enter().append("div").attr("class","bar-scale").append("label");l.append("span").text((function(t){return 8===t?"AA":t})),l.append("input").attr("class",(function(t){return"scaleButton scaleButton_"+100*t})).attr("name","scaleButtons").attr("type","radio").on("change",(function(t){a.preventDefaultsAndStopPropagation(t),a.contextMenuProt.setStickScale(t,a.contextMenuPoint)}));var f=i.select(".custom-menu-margin").node();f.onmouseout=function(t){var n=t.relatedTarget;do{if(n===this)return;n=n.parentNode}while(n);a.contextMenuProt=null,i.select(this).style("display","none")},this.svgElement=document.createElementNS(y,"svg"),this.svgElement.classList.add("complexViewerSVG"),this.svgElement.onmousedown=function(t){a.mouseDown(t)},this.svgElement.onmousemove=function(t){a.move(t)},this.svgElement.onmouseup=function(t){a.mouseUp(t)},this.svgElement.onmouseout=function(t){a.mouseOut(t)},this.svgElement.ontouchstart=function(t){a.touchStart(t)},this.svgElement.ontouchmove=function(t){a.move(t)},this.svgElement.ontouchend=function(t){a.mouseUp(t)},this.lastMouseUp=(new Date).getTime(),this.el.oncontextmenu=function(t){return t.preventDefault&&t.preventDefault(),t.returnValue=!1,!1};var h=/Firefox/i.test(navigator.userAgent)?"DOMMouseScroll":"mousewheel";document.attachEvent?this.svgElement.attachEvent("on"+h,(function(t){a.mouseWheel(t)})):document.addEventListener&&this.svgElement.addEventListener(h,(function(t){a.mouseWheel(t)}),!1),this.hoverListeners=new Set,this.expandListeners=new Set,this.el.appendChild(this.svgElement),this.container=document.createElementNS(y,"g"),this.container.setAttribute("id","container");var p=i.select(this.svgElement);this.defs=p.append("defs"),this.acknowledgement=document.createElementNS(y,"g");var d=document.createElementNS(y,"text");d.innerHTML="<a href='https://academic.oup.com/bioinformatics/article/33/22/3673/4061280' target='_blank'><tspan x='0' dy='1.2em' style='text-decoration: underline'>ComplexViewer "+r.a+"</tspan></a><tspan x='0' dy='1.2em'>by <a href='http://rappsilberlab.org/' target='_blank'>Rappsilber Laboratory</a></tspan>",this.acknowledgement.appendChild(d),d.setAttribute("font-size","8pt"),this.svgElement.appendChild(this.acknowledgement),this.naryLinks=document.createElementNS(y,"g"),this.naryLinks.setAttribute("id","naryLinks"),this.container.appendChild(this.naryLinks),this.p_pLinksWide=document.createElementNS(y,"g"),this.p_pLinksWide.setAttribute("id","p_pLinksWide"),this.container.appendChild(this.p_pLinksWide),this.highlights=document.createElementNS(y,"g"),this.highlights.setAttribute("class","highlights"),this.container.appendChild(this.highlights),this.res_resLinks=document.createElementNS(y,"g"),this.res_resLinks.setAttribute("id","res_resLinks"),this.container.appendChild(this.res_resLinks),this.p_pLinks=document.createElementNS(y,"g"),this.p_pLinks.setAttribute("id","p_pLinks"),this.container.appendChild(this.p_pLinks),this.proteinUpper=document.createElementNS(y,"g"),this.proteinUpper.setAttribute("id","proteinUpper"),this.container.appendChild(this.proteinUpper),this.selfRes_resLinks=document.createElementNS(y,"g"),this.selfRes_resLinks.setAttribute("id","res_resLinks"),this.container.appendChild(this.selfRes_resLinks),this.svgElement.appendChild(this.container),this.tooltip=document.createElementNS(y,"text"),this.tooltip.setAttribute("x","0"),this.tooltip.setAttribute("y","0");var v=document.createTextNode("tooltip");this.tooltip.classList.add("label","tooltip"),this.tooltip.appendChild(v),this.tooltip_bg=document.createElementNS(y,"rect"),this.tooltip_bg.classList.add("tooltip-background"),this.tooltip_subBg=document.createElementNS(y,"rect"),this.tooltip_subBg.classList.add("tooltip-sub-background"),this.svgElement.appendChild(this.tooltip_subBg),this.svgElement.appendChild(this.tooltip_bg),this.svgElement.appendChild(this.tooltip),this.annotationSetsShown=new Map,this.annotationSetsShown.set("Interactor",!1),this.annotationSetsShown.set("UniprotKB",!1),this.annotationSetsShown.set("Superfamily",!1),this.annotationSetsShown.set("MI Features",!0),this.clear()}var n,e,o;return n=t,(e=[{key:"clear",value:function(){this.d3cola.stop(),this.naryLinks.textContent="",this.p_pLinksWide.textContent="",this.highlights.textContent="",this.p_pLinks.textContent="",this.res_resLinks.textContent="",this.proteinUpper.textContent="",this.selfRes_resLinks.textContent="",this.dragElement=null,this.dragStart={},this.participants=new Map,this.allNaryLinks=new Map,this.allBinaryLinks=new Map,this.allUnaryLinks=new Map,this.allSequenceLinks=new Map,this.complexes=[];var n,e=[],r=Cn(a);try{for(r.s();!(n=r.n()).done;){var o=n.value,s=i.hsl(o);s.l=.9,e.push(s+"")}}catch(t){r.e(t)}finally{r.f()}Xt.naryColors=i.scale.ordinal().range(e),this.proteinCount=0,this.z=1,this.hideTooltip(),this.state=t.STATES.MOUSE_UP}},{key:"collapseProtein",value:function(){i.select(".custom-menu-margin").style("display","none"),this.contextMenuProt.setExpanded(!1,this.contextMenuPoint),this.contextMenuProt=null,this.notifyExpandListeners()}},{key:"init",value:function(){this.d3cola.stop();var n,e=0,r=Cn(this.participants.values());try{for(r.s();!(n=r.n()).done;){var o=n.value;o.size>e&&(e=o.size)}}catch(t){r.e(t)}finally{r.f()}var a,s,u,c=.8*this.svgElement.parentNode.clientWidth/e;this.defaultBarScale=(a=t.barScales,s=c,0===(u=(0,i.bisector((function(t){return t})).left)(a,s))||1===u?a[1]:u===a.length?a[a.length-1]:a[u-1]);var l,f=Cn(this.participants.values());try{for(f.s();!(l=f.n()).done;){var h=l.value;"complex"!==h.type&&(h.setPosition(-500,-500),this.proteinUpper.appendChild(h.upperGroup))}}catch(t){f.e(t)}finally{f.f()}var p,y=Cn(this.participants.values());try{for(y.s();!(p=y.n()).done;){var d=p.value;"protein"===d.type&&(d.stickZoom=this.defaultBarScale,this.participants.size<this.maxCountInitiallyExpanded&&d.toStickNoTransition())}}catch(t){y.e(t)}finally{y.f()}this.updateAnnotations();var v=this;!function(t,n){var e,r=Array.from(t.participants.values()).filter((function(t){return"protein"===t.type})),i=0,o=r.length,a=En(r);try{for(a.s();!(e=a.n()).done;){var s=e.value,u=new RegExp("[OPQ][0-9][A-Z0-9]{3}[0-9]|[A-NR-Z][0-9]([A-Z][A-Z0-9]{2}[0-9]){1,2}![-]","i").exec(s.json.identifier.id);u&&u[0]===s.json.identifier.id.trim()&&(Pn(s,(function(){++i===o&&n()})),Ln(s,(function(){++i===o&&n()})))}}catch(t){a.e(t)}finally{a.f()}}(this,(function(){v.updateAnnotations()})),this.checkLinks(),this.autoLayout()}},{key:"zoomToExtent",value:function(){var t=this.svgElement.parentNode.clientWidth,n=this.svgElement.parentNode.clientHeight,e=this.container.getBBox(),r=(t/e.width).toFixed(4),i=(n/e.height).toFixed(4);if((i<r?i:r)<1){var o;r=(t-40)/e.width,(o=(i=(n-40)/e.height)<r?i:r)>this.z&&(o=this.z);var a=-e.x+20/o,s=-e.y+20/o;this.container.setAttribute("transform","scale("+o+") translate("+a+" "+s+") "),this.z=this.container.getCTM().inverse().a}else{var u=t-e.width,c=n-e.height,l=u/2-e.x,f=c/2-e.y;this.container.setAttribute("transform","scale(1) translate("+l+" "+f+")"),this.z=1}this.acknowledgement.setAttribute("transform","translate("+(t-150)+", "+(n-30)+")")}},{key:"autoLayout",value:function(){this.d3cola.stop();var t,n=[],e=[],r=this,i=Cn(this.participants.values());try{for(i.s();!(t=i.n()).done;){var o=t.value;"complex"!=o.type&&(e.push(o),o.binaryLinks.size>2&&n.push(o)),delete o.x,delete o.y,delete o.px,delete o.py,delete o.bounds,o.fixed=0}}catch(t){i.e(t)}finally{i.f()}var a=e.length<30?30:20,s=this.svgElement.parentNode.clientWidth,u=this.svgElement.parentNode.clientHeight;function c(t){var n,e=[],i={},o=0,a=Cn(t);try{for(a.s();!(n=a.n()).done;)i[n.value.id]=o,o++}catch(t){a.e(t)}finally{a.f()}var s,u=Cn(r.allBinaryLinks.values());try{for(u.s();!(s=u.n()).done;){var c=s.value,l=c.participants[0],f=c.participants[1];if(l!==f&&-1!==t.indexOf(l)&&-1!==t.indexOf(f)){var h={};h.source=i[l.id],h.target=i[f.id],h.id=c.id,e.push(h)}}}catch(t){u.e(t)}finally{u.f()}return e}this.d3cola.size([u-40,s-40]).symmetricDiffLinkLengths(a),f(n,c(n),!0);var l=c(e);function f(t,n,e){if(delete r.d3cola._lastStress,delete r.d3cola._alpha,delete r.d3cola._descent,delete r.d3cola._rootGroup,r.d3cola.nodes(t).links(n),e)r.d3cola.groups([]).start(23,10,0,0,!1);else{var i=[];if(r.complexes){var o,a=Cn(r.complexes);try{for(a.s();!(o=a.n()).done;){var s=o.value;s.leaves=[],s.groups=[];var u,c=Cn(s.naryLink.participants);try{for(c.s();!(u=c.n()).done;){var l=u.value;"complex"!==l.type&&s.leaves.push(t.indexOf(l))}}catch(t){c.e(t)}finally{c.f()}i.push(s)}}catch(t){a.e(t)}finally{a.f()}var f,h=Cn(r.complexes);try{for(h.s();!(f=h.n()).done;){var p,y=f.value,d=Cn(y.naryLink.participants);try{for(d.s();!(p=d.n()).done;){var v=p.value;"complex"===v.type&&y.groups.push(i.indexOf(v))}}catch(t){d.e(t)}finally{d.f()}}}catch(t){h.e(t)}finally{h.f()}}r.d3cola.groups(i).start(0,10,1,0,!0).on("tick",(function(){var t,n=Cn(r.d3cola.nodes());try{for(n.s();!(t=n.n()).done;){var e=t.value;e.setPosition(e.x,e.y)}}catch(t){n.e(t)}finally{n.f()}r.setAllLinkCoordinates(),r.zoomToExtent()}))}}f(e,l,!0),f(e,l,!1)}},{key:"getSVG",value:function(){var t=[i.select(this.el).selectAll("svg").node()],n=l.capture(t);return l.makeXMLStr(new XMLSerializer,n[0])}},{key:"readMIJSON",value:function(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];Mn(t,this,n),this.init()}},{key:"checkLinks",value:function(){var t,n=Cn(this.allNaryLinks.values());try{for(n.s();!(t=n.n()).done;)t.value.check()}catch(t){n.e(t)}finally{n.f()}var e,r=Cn(this.allBinaryLinks.values());try{for(r.s();!(e=r.n()).done;)e.value.check()}catch(t){r.e(t)}finally{r.f()}var i,o=Cn(this.allUnaryLinks.values());try{for(o.s();!(i=o.n()).done;)i.value.check()}catch(t){o.e(t)}finally{o.f()}var a,s=Cn(this.allSequenceLinks.values());try{for(s.s();!(a=s.n()).done;)a.value.check()}catch(t){s.e(t)}finally{s.f()}}},{key:"setAllLinkCoordinates",value:function(){var t,n=Cn(this.allNaryLinks.values());try{for(n.s();!(t=n.n()).done;)t.value.setLinkCoordinates()}catch(t){n.e(t)}finally{n.f()}var e,r=Cn(this.allBinaryLinks.values());try{for(r.s();!(e=r.n()).done;)e.value.setLinkCoordinates()}catch(t){r.e(t)}finally{r.f()}var i,o=Cn(this.allUnaryLinks.values());try{for(o.s();!(i=o.n()).done;)i.value.setLinkCoordinates()}catch(t){o.e(t)}finally{o.f()}var a,s=Cn(this.allSequenceLinks.values());try{for(s.s();!(a=s.n()).done;)a.value.setLinkCoordinates()}catch(t){s.e(t)}finally{s.f()}}},{key:"showTooltip",value:function(t){var n,e,r=this.tooltip.getComputedTextLength()+16,i=this.svgElement.parentNode.clientWidth,o=this.svgElement.parentNode.clientHeight;n=t.x+20+r<i?t.x:i-r-20,e=t.y+60<o?t.y:o-60,this.tooltip.setAttribute("x",n+22),this.tooltip.setAttribute("y",e+47),this.tooltip_bg.setAttribute("x",n+16),this.tooltip_bg.setAttribute("y",e+28),this.tooltip_subBg.setAttribute("x",n+16),this.tooltip_subBg.setAttribute("y",e+28)}},{key:"setTooltip",value:function(t,n){if(t){this.tooltip.firstChild.data=t.toString().replace(/&(quot);/g,'"'),this.tooltip.setAttribute("display","block");var e=this.tooltip.getComputedTextLength();this.tooltip_bg.setAttribute("width",e+16),this.tooltip_subBg.setAttribute("width",e+16),void 0!==n&&null!=n?(this.tooltip_bg.setAttribute("fill",n),this.tooltip_bg.setAttribute("stroke",n),this.tooltip_bg.setAttribute("fill-opacity","0.0")):(this.tooltip_bg.setAttribute("fill","white"),this.tooltip_bg.setAttribute("stroke","grey")),this.tooltip_bg.setAttribute("height","28"),this.tooltip_subBg.setAttribute("height","28"),this.tooltip_bg.setAttribute("display","block"),this.tooltip_subBg.setAttribute("display","block")}else this.hideTooltip()}},{key:"hideTooltip",value:function(){this.tooltip.setAttribute("display","none"),this.tooltip_bg.setAttribute("display","none"),this.tooltip_subBg.setAttribute("display","none")}},{key:"setAnnotations",value:function(t){t=t.toUpperCase();var n,e=Cn(this.annotationSetsShown.keys());try{for(e.s();!(n=e.n()).done;){var r=n.value;this.annotationSetsShown.set(r,t===r)}}catch(t){e.e(t)}finally{e.f()}return this.updateAnnotations(),this.getColorKeyJson()}},{key:"showAnnotations",value:function(t,n){return this.annotationSetsShown.set(t,n),this.updateAnnotations(),this.getColorKeyJson()}},{key:"updateAnnotations",value:function(){this.defs.textContent="",this.uncertainCategories=new Set,this.certainCategories=new Set,delete this.featureColors;var t,n,e=new Set,r=Cn(this.participants.values());try{for(r.s();!(t=r.n()).done;){var o,a=Cn(t.value.annotationSets);try{for(a.s();!(o=a.n()).done;){var u=Nn(o.value,2),l=u[0],f=u[1];if(!0===this.annotationSetsShown.get(l)){var h,p=Cn(f.values());try{for(p.s();!(h=p.n()).done;){var y=h.value;e.add(y.description)}}catch(t){p.e(t)}finally{p.f()}}}}catch(t){a.e(t)}finally{a.f()}}}catch(t){r.e(t)}finally{r.f()}n=e.size<11?i.scale.ordinal().range(s):i.scale.category20();var d=this;function v(t,n){var e=d.defs.append("pattern").attr("id",t).attr("patternUnits","userSpaceOnUse").attr("x",0).attr("y",0).attr("width",12).attr("height",12).attr("patternTransform","rotate(45)");e.append("rect").attr("x",0).attr("y",2).attr("width",12).attr("height",4).attr("fill",n),e.append("rect").attr("x",0).attr("y",8).attr("width",12).attr("height",4).attr("fill",n)}var g,x=Cn(this.participants.values());try{for(x.s();!(g=x.n()).done;){var m=g.value;if("protein"===m.type){m.clearPositionalFeatures(),m.updatePositionalFeatures();var b,w=Cn(m.annotationSets);try{for(w.s();!(b=w.n()).done;){var k=Nn(b.value,2),_=k[0],S=k[1];if(!0===this.annotationSetsShown.get(_)){var M,E=Cn(S);try{for(E.s();!(M=E.n()).done;){var A=M.value,L=void 0;if(L="No annotations"===A.description?"#eeeeee":n(A.description),A.certain&&(A.certain.setAttribute("fill",L),A.certain.setAttribute("stroke",L),this.certainCategories.add(A.description)),A.fuzzyStart||A.fuzzyEnd){if(!this.uncertainCategories.has(name)){var P=new c(L),N="rgba("+P.r+","+P.g+","+P.b+", 0.6)";v("hatched_"+A.description+"_"+L.toString(),N),this.uncertainCategories.add(A.description)}var C="url('#hatched_"+A.description+"_"+L.toString()+"')";A.fuzzyStart&&(A.fuzzyStart.setAttribute("fill",C),A.fuzzyStart.setAttribute("stroke",L)),A.fuzzyEnd&&(A.fuzzyEnd.setAttribute("fill",C),A.fuzzyEnd.setAttribute("stroke",L))}}}catch(t){E.e(t)}finally{E.f()}}}}catch(t){w.e(t)}finally{w.f()}}}}catch(t){x.e(t)}finally{x.f()}this.featureColors=n}},{key:"getColorKeyJson",value:function(){var t,n={Complex:[]},e=Cn(Xt.naryColors.domain());try{for(e.s();!(t=e.n()).done;){var r=t.value;n.Complex.push({name:r,certain:{color:Xt.naryColors(r)}})}}catch(t){e.e(t)}finally{e.f()}if(this.featureColors){var i,o=Cn(this.annotationSetsShown);try{for(o.s();!(i=o.n()).done;){var a=Nn(i.value,2),s=a[0];if(a[1]){var u,l=[],f=new Set,h=Cn(this.participants.values());try{for(h.s();!(u=h.n()).done;){var p=u.value;if("protein"===p.type){var y=p.annotationSets.get(s);if(y){var d,v=Cn(y);try{for(v.s();!(d=v.n()).done;){var g=d.value.description;if(!f.has(g)){f.add(g);var x={name:g};if(this.certainCategories.has(g)&&(x.certain={color:this.featureColors(g)}),this.uncertainCategories.has(g)){var m=new c(this.featureColors(g)),b="rgba("+m.r+","+m.g+","+m.b+", 0.6)";x.uncertain={color:b}}l.push(x)}}}catch(t){v.e(t)}finally{v.f()}}}}}catch(t){h.e(t)}finally{h.f()}n[s]=l}}}catch(t){o.e(t)}finally{o.f()}}return n}},{key:"collapseAll",value:function(){var t,n=Cn(this.participants.values());try{for(n.s();!(t=n.n()).done;){var e=t.value;e.expanded&&e.toCircleNoTransition()}}catch(t){n.e(t)}finally{n.f()}this.autoLayout(),this.notifyExpandListeners()}},{key:"expandAll",value:function(){var t,n=Cn(this.participants.values());try{for(n.s();!(t=n.n()).done;){var e=t.value;"protein"!==e.type||e.expanded||e.toStickNoTransition()}}catch(t){n.e(t)}finally{n.f()}this.autoLayout(),this.notifyExpandListeners()}},{key:"expandAndCollapseSelection",value:function(t){var n,e=Cn(this.participants.values());try{for(e.s();!(n=e.n()).done;){var r=n.value,i=r.json.identifier.id;t.includes(i)?r.expanded||r.setExpanded(!0):r.expanded&&r.setExpanded(!1)}}catch(t){e.e(t)}finally{e.f()}this.notifyExpandListeners()}},{key:"addHoverListener",value:function(t){this.hoverListeners.add(t)}},{key:"removeHoverListener",value:function(t){this.hoverListeners.remove(t)}},{key:"notifyHoverListeners",value:function(t){var n,e=Cn(this.hoverListeners);try{for(e.s();!(n=e.n()).done;)(0,n.value)(t)}catch(t){e.e(t)}finally{e.f()}}},{key:"addExpandListener",value:function(t){this.expandListeners.add(t)}},{key:"removeExpandListener",value:function(t){this.expandListeners.remove(t)}},{key:"notifyExpandListeners",value:function(){var t,n=this.getExpandedParticipants(),e=Cn(this.expandListeners);try{for(e.s();!(t=e.n()).done;)(0,t.value)(n)}catch(t){e.e(t)}finally{e.f()}}},{key:"getExpandedParticipants",value:function(){var t,n=[],e=Cn(this.participants.values());try{for(e.s();!(t=e.n()).done;){var r=t.value;r.postAnimExpanded&&n.push(r.json)}}catch(t){e.e(t)}finally{e.f()}return n}},{key:"setCTM",value:function(t,n){var e="matrix("+n.a+","+n.b+","+n.c+","+n.d+","+n.e+","+n.f+")";t.setAttribute("transform",e)}},{key:"mouseDown",value:function(n){n.preventDefault(),this.d3cola.stop(),this.dragStart=n,this.state=t.STATES.SELECT_PAN,i.select(".custom-menu-margin").style("display","none")}},{key:"touchStart",value:function(n){n.preventDefault(),this.d3cola.stop(),this.dragStart=n,this.state=t.STATES.SELECT_PAN,i.select(".custom-menu-margin").style("display","none")}},{key:"move",value:function(n){if(this.dragStart){var e=this.getEventPoint(n),r=e.matrixTransform(this.container.getCTM().inverse());if(r.x){var i=this.getEventPoint(this.dragStart).matrixTransform(this.container.getCTM().inverse()),o=i.x-r.x,a=i.y-r.y;if(null!=this.dragElement)if(this.hideTooltip(),this.state===t.STATES.DRAGGING){if(this.dragElement.ix)this.dragElement.changePosition(o,a),this.dragElement.setAllLinkCoordinates();else{var s,u=Cn(this.dragElement.participants);try{for(u.s();!(s=u.n()).done;)s.value.changePosition(o,a)}catch(t){u.e(t)}finally{u.f()}this.setAllLinkCoordinates()}this.dragStart=n}else Math.sqrt(o*o+a*a)>5*this.z&&(this.state=t.STATES.DRAGGING);else this.state===t.STATES.SELECT_PAN?(this.setCTM(this.container,this.container.getCTM().translate(r.x-i.x,r.y-i.y)),this.dragStart=n):this.showTooltip(e)}}}},{key:"mouseUp",value:function(n){this.preventDefaultsAndStopPropagation(n);var e=(new Date).getTime();if(e-this.lastMouseUp>150&&this.dragElement&&"protein"===this.dragElement.type&&this.state!==t.STATES.DRAGGING)if(this.dragElement.expanded){this.contextMenuProt=this.dragElement;var r=this.getEventPoint(n);isNaN(r.x)&&(r=this.getEventPoint(this.dragStart));var o=r.matrixTransform(this.container.getCTM().inverse());this.contextMenuPoint=o;var a,s,u=i.select(".custom-menu-margin");n.pageX?(a=n.pageX,s=n.pageY):(a=this.dragStart.touches[0].pageX,s=this.dragStart.touches[0].pageY),u.style("top",s-20+"px").style("left",a-20+"px").style("display","block"),i.select(".scaleButton_"+100*this.dragElement.stickZoom).property("checked",!0)}else this.dragElement.setExpanded(!0),this.notifyExpandListeners();return this.dragElement=null,this.dragStart={},this.state=t.STATES.MOUSE_UP,this.lastMouseUp=e,!1}},{key:"mouseWheel",value:function(t){this.preventDefaultsAndStopPropagation(t),this.d3cola.stop();var n=1+(t.wheelDelta?t.wheelDelta/3600:t.detail/-90),e=this.container,r=this.getEventPoint(t).matrixTransform(e.getCTM().inverse()),i=this.svgElement.createSVGMatrix().translate(r.x,r.y).scale(n).translate(-r.x,-r.y);return this.setCTM(e,e.getCTM().multiply(i)),!1}},{key:"mouseOut",value:function(t){this.hideTooltip()}},{key:"getEventPoint",value:function(t){var n,e,r=this.svgElement.createSVGPoint(),i=this.svgElement.parentNode,o=0,a=0;do{o+=i.offsetTop||0,a+=i.offsetLeft||0,i=i.offsetParent}while(i);return t.touches&&t.touches.length>0?(n=t.touches[0].pageX,e=t.touches[0].pageY):t.pageX&&(n=t.pageX,e=t.pageY),r.x=n-a,r.y=e-o,r}},{key:"preventDefaultsAndStopPropagation",value:function(t){t.stopPropagation&&t.stopPropagation(),null!=t.cancelBubble&&(t.cancelBubble=!0),t.preventDefault&&t.preventDefault()}},{key:"downloadSVG",value:function(t){t||(t="complexViewer");var n=this.getSVG(),e=function(t){var n,e=[];try{n=new TextEncoder("utf-8")}catch(t){n=void 0}if(n)e=n.encode(t);else for(var r=0;r<t.length;r++){var i=t.charCodeAt(r);i<128?e.push(i):i<2048?e.push(192|i>>6,128|63&i):i<55296||i>=57344?e.push(224|i>>12,128|i>>6&63,128|63&i):(r++,i=65536+((1023&i)<<10|1023&t.charCodeAt(r)),e.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|63&i))}return new Blob([new Uint8Array(e)],{type:"image/svg+xml;charset=utf-8"})}(n);if(navigator.msSaveOrOpenBlob)navigator.msSaveOrOpenBlob(e,t);else{var r=document.createElement("a");r.href=window.URL.createObjectURL(e),r.download=t,r.style.display="none",document.body.appendChild(r),r.click(),document.body.removeChild(r),window.URL.revokeObjectURL(r.href)}e=null}}])&&Dn(n.prototype,e),o&&Dn(n,o),t}();zn.STATES={MOUSE_UP:0,SELECT_PAN:1,DRAGGING:2},zn.barScales=[.01,.015,.2,1,2,4,8]}])}));